1707492793278:jd_long_Engin_NA |>
1707492793300:group_by(Type,Year,Reitur) %>%
1707492793316:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop')
1707493362056:unique(jd_long_Engin_NA $Reitur[jd_long_Engin_NA $Type=="Blað- og runnfléttur"])
1707493397307:df[df$Type=="Blað- og runnfléttur",]
1707493439105:jd_long_Engin_NA$[jd_long_Engin_NA $Type=="Blað- og runnfléttur",]
1707493443854:jd_long_Engin_NA[jd_long_Engin_NA $Type=="Blað- og runnfléttur",]
1707494051476:jd_long_Engin_NA |>
1707494051499:group_by(Type,Year,Reitur) %>%
1707494051518:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop')
1707494143826:jd_long_Engin_NA |>
1707494143845:group_by(Type,Year,Reitur) %>%
1707494143859:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop')
1707494381301:jd_long_Engin_NA |>
1707494381326:group_by(Type,Year,Reitur) %>%
1707494381347:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707494381362:group_by(Type,Year) %>%
1707494381375:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(Summa, na.rm=TRUE), .groups = 'drop')
1707494436684:for (i in unique(joined_data$Stadur)[7]) {
1707494436720:filtered_data <- joined_data %>%
1707494436735:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707494436751:select(where(~ !all(is.na(.))))
1707494436778:# Dynamically identify year columns that exist after filtering
1707494436795:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707494436810:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707494436835:# Pivot longer only with existing year columns
1707494436849:jd_long <- filtered_data %>%
1707494436864:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707494436894:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707494436922:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707494436938:# Fjöldi tegunda í reit á ári
1707494436953:species_counts <- jd_long_Engin_NA %>%
1707494436969:group_by(Reitur, Year) %>%
1707494436985:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707494437003:# Meðalfjöldi tegunda í reit á ári
1707494437016:group_by(Year) %>%
1707494437028:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707494437039:mutate(Type = "Tegundafjöldi")|>
1707494437051:select(Type, Year, Mean, SE)
1707494437078:# Meðalþekja reita eftir Type
1707494437095:df <- jd_long_Engin_NA |>
1707494437111:group_by(Type,Year,Reitur) %>%
1707494437126:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707494437142:group_by(Type,Year) %>%
1707494437158:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(Summa, na.rm=TRUE), .groups = 'drop')
1707494437185:# heildarþekja (öll Type) allra reita innan ára
1707494437202:df_summary <- jd_long_Engin_NA |>
1707494437218:group_by(Year,Reitur) %>%
1707494437235:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707494437253:group_by(Year) %>%
1707494437270:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707494437284:mutate(Type = "Heildarþekja") |>
1707494437299:select(Type, Year, Mean, SE)
1707494437342:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707494437358:# Ensure Type is ordered as desired
1707494437372:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707494437399:# Plot
1707494437413:p1 <-
1707494437429:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707494437443:geom_bar(
1707494437460:stat = "identity",
1707494437480:color = "black",
1707494437496:size = .6,
1707494437510:position = position_dodge(width = 0.75)
1707494437525:) +
1707494437540:geom_errorbar(
1707494437556:aes(ymin = Mean - SE, ymax = Mean + SE),
1707494437571:width = .2,
1707494437589:position = position_dodge(width = 0.75)
1707494437608:) +
1707494437627:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707494437643:scale_y_continuous(
1707494437661:labels = label_dollar(prefix = "", suffix = " \n%"),
1707494437679:# Example secondary axis (e.g., double the Mean for illustration)
1707494437697:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707494437714:) +
1707494437730:labs(title = "",
1707494437744:y = "Meðalþekja", x = "") +
1707494437759:scale_x_discrete(
1707494437773:"",
1707494437788:labels = c(
1707494437805:"Mosar" = "Mosar",
1707494437825:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707494437843:"Hrúðurfléttur" = "Hrúðurfléttur",
1707494437858:"Heildarþekja" = "Heildarþekja",
1707494437872:"Tegundafjöldi" = "Tegundafjöldi"
1707494437885:)
1707494437900:) +
1707494437915:theme_minimal() +
1707494437931:theme(legend.title = element_blank(),
1707494437947:plot.background = element_rect(fill = "white", color = NA)) +
1707494437962:annotate(
1707494437976:"text",
1707494437994:x = 2,
1707494438010:y = Inf,
1707494438025:label = i,
1707494438040:hjust = 1,
1707494438055:vjust = 1,
1707494438072:size = 8,
1707494438088:angle = 0
1707494438103:)
1707494438130:p1 <-
1707494438145:p1 + theme(
1707494438160:axis.title = element_text(size = 16),
1707494438176:# Increase axis titles
1707494438193:axis.text = element_text(size = 16),
1707494438212:# Increase axis text
1707494438227:legend.text = element_text(size = 16)
1707494438242:) # Increase legend text
1707494438274:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707494438290:#ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707494438328:}
1707494443774:p1
1707494457670:Filename
1707494468345:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707494501406:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707494657869:for (i in unique(joined_data$Stadur)[7]) {
1707494657905:filtered_data <- joined_data %>%
1707494657920:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707494657934:select(where(~ !all(is.na(.))))
1707494657961:# Dynamically identify year columns that exist after filtering
1707494657978:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707494657992:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707494658021:# Pivot longer only with existing year columns
1707494658037:jd_long <- filtered_data %>%
1707494658051:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707494658077:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707494658102:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707494658117:# Fjöldi tegunda í reit á ári
1707494658132:species_counts <- jd_long_Engin_NA %>%
1707494658147:group_by(Reitur, Year) %>%
1707494658164:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707494658179:# Meðalfjöldi tegunda í reit á ári
1707494658194:group_by(Year) %>%
1707494658211:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707494658228:mutate(Type = "Tegundafjöldi")|>
1707494658244:select(Type, Year, Mean, SE)
1707494658268:# Meðalþekja reita eftir Type
1707494658283:df <- jd_long_Engin_NA |>
1707494658299:group_by(Type,Year,Reitur) %>%
1707494658313:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707494658328:group_by(Type,Year) %>%
1707494658344:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707494658373:# heildarþekja (öll Type) allra reita innan ára
1707494658390:df_summary <- jd_long_Engin_NA |>
1707494658405:group_by(Year,Reitur) %>%
1707494658422:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707494658440:group_by(Year) %>%
1707494658455:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707494658469:mutate(Type = "Heildarþekja") |>
1707494658486:select(Type, Year, Mean, SE)
1707494658522:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707494658534:# Ensure Type is ordered as desired
1707494658547:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707494658572:# Plot
1707494658585:p1 <-
1707494658601:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707494658616:geom_bar(
1707494658632:stat = "identity",
1707494658649:color = "black",
1707494658664:size = .6,
1707494658681:position = position_dodge(width = 0.75)
1707494658698:) +
1707494658712:geom_errorbar(
1707494658725:aes(ymin = Mean - SE, ymax = Mean + SE),
1707494658736:width = .2,
1707494658748:position = position_dodge(width = 0.75)
1707494658760:) +
1707494658772:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707494658785:scale_y_continuous(
1707494658799:labels = label_dollar(prefix = "", suffix = " \n%"),
1707494658814:# Example secondary axis (e.g., double the Mean for illustration)
1707494658832:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707494658849:) +
1707494658865:labs(title = "",
1707494658883:y = "Meðalþekja", x = "") +
1707494658899:scale_x_discrete(
1707494658914:"",
1707494658926:labels = c(
1707494658938:"Mosar" = "Mosar",
1707494658949:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707494658961:"Hrúðurfléttur" = "Hrúðurfléttur",
1707494658972:"Heildarþekja" = "Heildarþekja",
1707494658985:"Tegundafjöldi" = "Tegundafjöldi"
1707494658997:)
1707494659008:) +
1707494659020:theme_minimal() +
1707494659032:theme(legend.title = element_blank(),
1707494659043:plot.background = element_rect(fill = "white", color = NA)) +
1707494659059:annotate(
1707494659074:"text",
1707494659087:x = 2,
1707494659104:y = Inf,
1707494659118:label = i,
1707494659135:hjust = 1,
1707494659151:vjust = 1,
1707494659164:size = 8,
1707494659180:angle = 0
1707494659198:)
1707494659230:p1 <-
1707494659250:p1 + theme(
1707494659265:axis.title = element_text(size = 16),
1707494659282:# Increase axis titles
1707494659298:axis.text = element_text(size = 16),
1707494659315:# Increase axis text
1707494659332:legend.text = element_text(size = 16)
1707494659349:) # Increase legend text
1707494659374:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707494659387:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707494659431:}
1707494682886:for (i in unique(joined_data$Stadur)) {
1707494682929:filtered_data <- joined_data %>%
1707494682945:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707494682959:select(where(~ !all(is.na(.))))
1707494682980:# Dynamically identify year columns that exist after filtering
1707494682992:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707494683003:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707494683024:# Pivot longer only with existing year columns
1707494683036:jd_long <- filtered_data %>%
1707494683048:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707494683073:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707494683098:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707494683112:# Fjöldi tegunda í reit á ári
1707494683126:species_counts <- jd_long_Engin_NA %>%
1707494683140:group_by(Reitur, Year) %>%
1707494683156:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707494683172:# Meðalfjöldi tegunda í reit á ári
1707494683186:group_by(Year) %>%
1707494683202:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707494683218:mutate(Type = "Tegundafjöldi")|>
1707494683232:select(Type, Year, Mean, SE)
1707494683257:# Meðalþekja reita eftir Type
1707494683275:df <- jd_long_Engin_NA |>
1707494683294:group_by(Type,Year,Reitur) %>%
1707494683310:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707494683327:group_by(Type,Year) %>%
1707494683342:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707494683370:# heildarþekja (öll Type) allra reita innan ára
1707494683386:df_summary <- jd_long_Engin_NA |>
1707494683400:group_by(Year,Reitur) %>%
1707494683415:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707494683429:group_by(Year) %>%
1707494683445:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707494683459:mutate(Type = "Heildarþekja") |>
1707494683472:select(Type, Year, Mean, SE)
1707494683512:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707494683527:# Ensure Type is ordered as desired
1707494683542:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707494683568:# Plot
1707494683582:p1 <-
1707494683597:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707494683614:geom_bar(
1707494683633:stat = "identity",
1707494683650:color = "black",
1707494683666:size = .6,
1707494683680:position = position_dodge(width = 0.75)
1707494683693:) +
1707494683708:geom_errorbar(
1707494683722:aes(ymin = Mean - SE, ymax = Mean + SE),
1707494683738:width = .2,
1707494683752:position = position_dodge(width = 0.75)
1707494683768:) +
1707494683783:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707494683798:scale_y_continuous(
1707494683815:labels = label_dollar(prefix = "", suffix = " \n%"),
1707494683830:# Example secondary axis (e.g., double the Mean for illustration)
1707494683844:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707494683859:) +
1707494683874:labs(title = "",
1707494683891:y = "Meðalþekja", x = "") +
1707494683909:scale_x_discrete(
1707494683926:"",
1707494683940:labels = c(
1707494683954:"Mosar" = "Mosar",
1707494683969:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707494683985:"Hrúðurfléttur" = "Hrúðurfléttur",
1707494683999:"Heildarþekja" = "Heildarþekja",
1707494684013:"Tegundafjöldi" = "Tegundafjöldi"
1707494684030:)
1707494684046:) +
1707494684061:theme_minimal() +
1707494684076:theme(legend.title = element_blank(),
1707494684092:plot.background = element_rect(fill = "white", color = NA)) +
1707494684107:annotate(
1707494684124:"text",
1707494684139:x = 2,
1707494684160:y = Inf,
1707494684176:label = i,
1707494684193:hjust = 1,
1707494684207:vjust = 1,
1707494684226:size = 8,
1707494684244:angle = 0
1707494684261:)
1707494684287:p1 <-
1707494684302:p1 + theme(
1707494684317:axis.title = element_text(size = 16),
1707494684331:# Increase axis titles
1707494684347:axis.text = element_text(size = 16),
1707494684362:# Increase axis text
1707494684376:legend.text = element_text(size = 16)
1707494684392:) # Increase legend text
1707494684419:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707494684434:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707494684473:}
1707494814144:for (i in unique(joined_data$Stadur)) {
1707494814183:filtered_data <- joined_data %>%
1707494814199:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707494814216:select(where(~ !all(is.na(.))))
1707494814244:# Dynamically identify year columns that exist after filtering
1707494814261:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707494814276:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707494814303:# Pivot longer only with existing year columns
1707494814319:jd_long <- filtered_data %>%
1707494814337:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707494814365:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707494814393:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707494814407:# Fjöldi tegunda í reit á ári
1707494814424:species_counts <- jd_long_Engin_NA %>%
1707494814444:group_by(Reitur, Year) %>%
1707494814460:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707494814479:# Meðalfjöldi tegunda í reit á ári
1707494814496:group_by(Year) %>%
1707494814512:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707494814527:mutate(Type = "Tegundafjöldi")|>
1707494814543:select(Type, Year, Mean, SE)
1707494814578:# Meðalþekja reita eftir Type
1707494814599:df <- jd_long_Engin_NA |>
1707494814620:group_by(Type,Year,Reitur) %>%
1707494814637:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707494814654:group_by(Type,Year) %>%
1707494814675:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707494814711:# heildarþekja (öll Type) allra reita innan ára
1707494814731:df_summary <- jd_long_Engin_NA |>
1707494814750:group_by(Year,Reitur) %>%
1707494814771:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707494814788:group_by(Year) %>%
1707494814801:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707494814817:mutate(Type = "Heildarþekja") |>
1707494814832:select(Type, Year, Mean, SE)
1707494814873:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707494814887:# Ensure Type is ordered as desired
1707494814900:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707494814926:# Plot
1707494814942:p1 <-
1707494814956:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707494814972:geom_bar(
1707494814987:stat = "identity",
1707494815002:color = "black",
1707494815018:size = .6,
1707494815033:position = position_dodge(width = 0.75)
1707494815050:) +
1707494815064:geom_errorbar(
1707494815080:aes(ymin = Mean - SE, ymax = Mean + SE),
1707494815095:width = .2,
1707494815111:position = position_dodge(width = 0.75)
1707494815126:) +
1707494815141:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707494815159:scale_y_continuous(
1707494815174:labels = label_dollar(prefix = "", suffix = " \n%"),
1707494815190:# Example secondary axis (e.g., double the Mean for illustration)
1707494815204:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707494815220:) +
1707494815235:labs(title = "",
1707494815252:y = "Meðalþekja", x = "") +
1707494815268:scale_x_discrete(
1707494815282:"",
1707494815297:labels = c(
1707494815311:"Mosar" = "Mosar",
1707494815330:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707494815346:"Hrúðurfléttur" = "Hrúðurfléttur",
1707494815362:"Heildarþekja" = "Heildarþekja",
1707494815377:"Tegundafjöldi" = "Tegundafjöldi"
1707494815395:)
1707494815411:) +
1707494815426:theme_minimal() +
1707494815443:theme(legend.title = element_blank(),
1707494815460:plot.background = element_rect(fill = "white", color = NA)) +
1707494815480:annotate(
1707494815498:"text",
1707494815514:x = 2,
1707494815528:y = Inf,
1707494815544:label = i,
1707494815559:hjust = 1,
1707494815574:vjust = 1,
1707494815590:size = 8,
1707494815606:angle = 0
1707494815623:)
1707494815650:p1 <-
1707494815666:p1 + theme(
1707494815681:axis.title = element_text(size = 16),
1707494815696:# Increase axis titles
1707494815711:axis.text = element_text(size = 16),
1707494815726:# Increase axis text
1707494815744:legend.text = element_text(size = 16)
1707494815762:) # Increase legend text
1707494815790:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707494815805:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707494815842:}
1707494895230:unique(joined_data$Stadur)
1707494934938:for (i in unique(joined_data$Stadur)[8]) {
1707494934975:filtered_data <- joined_data %>%
1707494934991:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707494935007:select(where(~ !all(is.na(.))))
1707494935032:# Dynamically identify year columns that exist after filtering
1707494935048:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707494935064:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707494935092:# Pivot longer only with existing year columns
1707494935107:jd_long <- filtered_data %>%
1707494935124:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707494935150:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707494935181:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707494935198:# Fjöldi tegunda í reit á ári
1707494935214:species_counts <- jd_long_Engin_NA %>%
1707494935230:group_by(Reitur, Year) %>%
1707494935247:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707494935265:# Meðalfjöldi tegunda í reit á ári
1707494935285:group_by(Year) %>%
1707494935301:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707494935320:mutate(Type = "Tegundafjöldi")|>
1707494935338:select(Type, Year, Mean, SE)
1707494935366:# Meðalþekja reita eftir Type
1707494935382:df <- jd_long_Engin_NA |>
1707494935397:group_by(Type,Year,Reitur) %>%
1707494935417:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707494935435:group_by(Type,Year) %>%
1707494935456:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707494935487:# heildarþekja (öll Type) allra reita innan ára
1707494935503:df_summary <- jd_long_Engin_NA |>
1707494935519:group_by(Year,Reitur) %>%
1707494935534:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707494935549:group_by(Year) %>%
1707494935566:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707494935585:mutate(Type = "Heildarþekja") |>
1707494935601:select(Type, Year, Mean, SE)
1707494935641:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707494935659:# Ensure Type is ordered as desired
1707494935677:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707494935707:# Plot
1707494935721:p1 <-
1707494935736:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707494935753:geom_bar(
1707494935771:stat = "identity",
1707494935787:color = "black",
1707494935804:size = .6,
1707494935820:position = position_dodge(width = 0.75)
1707494935836:) +
1707494935851:geom_errorbar(
1707494935867:aes(ymin = Mean - SE, ymax = Mean + SE),
1707494935885:width = .2,
1707494935900:position = position_dodge(width = 0.75)
1707494935915:) +
1707494935929:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707494935945:scale_y_continuous(
1707494935960:labels = label_dollar(prefix = "", suffix = " \n%"),
1707494935976:# Example secondary axis (e.g., double the Mean for illustration)
1707494935991:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707494936006:) +
1707494936023:labs(title = "",
1707494936039:y = "Meðalþekja", x = "") +
1707494936054:scale_x_discrete(
1707494936069:"",
1707494936084:labels = c(
1707494936098:"Mosar" = "Mosar",
1707494936115:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707494936131:"Hrúðurfléttur" = "Hrúðurfléttur",
1707494936146:"Heildarþekja" = "Heildarþekja",
1707494936161:"Tegundafjöldi" = "Tegundafjöldi"
1707494936175:)
1707494936189:) +
1707494936202:theme_minimal() +
1707494936217:theme(legend.title = element_blank(),
1707494936234:plot.background = element_rect(fill = "white", color = NA)) +
1707494936250:annotate(
1707494936265:"text",
1707494936281:x = 2,
1707494936297:y = Inf,
1707494936311:label = i,
1707494936326:hjust = 1,
1707494936342:vjust = 1,
1707494936355:size = 8,
1707494936371:angle = 0
1707494936387:)
1707494936412:p1 <-
1707494936427:p1 + theme(
1707494936443:axis.title = element_text(size = 16),
1707494936460:# Increase axis titles
1707494936479:axis.text = element_text(size = 16),
1707494936495:# Increase axis text
1707494936511:legend.text = element_text(size = 16)
1707494936527:) # Increase legend text
1707494936553:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707494936569:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707494936606:}
1707494988505:filtered_data <- joined_data %>%
1707494988519:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria"))
1707494993625:filtered_data <- joined_data %>%
1707494993648:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707494993666:select(where(~ !all(is.na(.))))
1707495007640:# Pivot longer only with existing year columns
1707495007658:jd_long <- filtered_data %>%
1707495007677:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707495013158:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707495038314:jd_long_Engin_NA %>%
1707495038331:group_by(Reitur, Year) %>%
1707495038346:summarise(SpeciesCount = n_distinct(species), .groups = 'drop')
1707495095252:jd_long_Engin_NA %>%
1707495095272:group_by(Reitur, Year) %>%
1707495095289:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707495095302:# Meðalfjöldi tegunda í reit á ári
1707495095318:group_by(Year) %>%
1707495095334:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707495095350:mutate(Type = "Tegundafjöldi")|>
1707495095364:select(Type, Year, Mean, SE)
1707496050429:jd_long_Engin_NA
1707496622624:jd_long_Engin_NA %>%
1707496622647:group_by(Type, Reitur, Year) %>%
1707496622663:summarise(
1707496622676:MeanCoverage = mean(Coverage, na.rm = TRUE),  # Calculate mean Coverage
1707496622690:SDCoverage = sd(Coverage, na.rm = TRUE),      # Calculate SD of Coverage
1707496622703:N = n(),  # Count of observations to determine if SD calculation is applicable
1707496622717:.groups = 'drop'
1707496622729:) %>%
1707496622741:# Optional: Filter out groups where N <= 1 if you want to exclude SD calculations for single observations
1707496622753:filter(N > 1) %>%
1707496622766:ungroup()
1707496661812:jd_long_Engin_NA |>
1707496661835:group_by(Type,Year,Reitur) %>%
1707496661853:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707496661870:group_by(Type,Year) %>%
1707496661885:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707496845867:jd_long_Engin_NA |>
1707496845890:group_by(Type,Year,Reitur) %>%
1707496845909:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707496845923:group_by(Type,Year) %>%
1707496845938:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707496865554:df <- jd_long_Engin_NA |>
1707496865574:group_by(Type,Year,Reitur) %>%
1707496865591:summarise( Summa = sum(Coverage, na.rm = TRUE),SE = sd(Coverage, na.rm = TRUE) / sqrt(length(Coverage)), .groups = 'drop') |>
1707496865607:group_by(Type,Year) %>%
1707496865623:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707496865692:print(df,n=100)
1707496922635:df <- jd_long_Engin_NA |>
1707496922657:group_by(Type,Year,Reitur) %>%
1707496922675:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707496922691:group_by(Type,Year) %>%
1707496922708:summarise(Mean=mean(Summa, na.rm=TRUE),SE = mean(SE, na.rm=TRUE), .groups = 'drop')
1707496957049:df <- jd_long_Engin_NA |>
1707496957065:group_by(Type,Year,Reitur) %>%
1707496957083:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707496957098:group_by(Type,Year) %>%
1707496957113:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707496957167:print(df,n=100)
1707497013239:library(tidyverse)
1707497013259:library(glue)
1707497013275:library(scales)
1707497013302:colors_dark2 <- brewer.pal(8, "Accent")
1707497013317:KM <- read.csv("gogn/coverkm.csv", check.names = F)
1707497013359:KM <-  KM[,-c(7:9)]
1707497013379:data <- read.csv("gogn/hreinsad.csv", check.names = F)
1707497013441:joined_data <- data %>%
1707497013459:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707497013475:select(species, Type, Reitur, km, everything()) |>
1707497013490:select(-c(`1999`)) |>
1707497013505:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707497013521:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707497013539:filter(!species %in% "Ber klöpp")
1707497013637:#########
1707497013655:### lúppa fyrir myndir allra staða - stöplarit: "Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"
1707497013671:#########
1707497013707:for (i in unique(joined_data$Stadur)[8]) {
1707497013737:filtered_data <- joined_data %>%
1707497013750:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707497013765:select(where(~ !all(is.na(.))))
1707497013794:# Dynamically identify year columns that exist after filtering
1707497013810:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707497013824:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707497013853:# Pivot longer only with existing year columns
1707497013868:jd_long <- filtered_data %>%
1707497013882:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707497013909:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707497013939:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707497013956:# Fjöldi tegunda í reit á ári
1707497013970:species_counts <- jd_long_Engin_NA %>%
1707497013986:group_by(Reitur, Year) %>%
1707497014001:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707497014017:# Meðalfjöldi tegunda í reit á ári
1707497014030:group_by(Year) %>%
1707497014046:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707497014062:mutate(Type = "Tegundafjöldi")|>
1707497014077:select(Type, Year, Mean, SE)
1707497014103:# Meðalþekja reita eftir Type
1707497014117:df <- jd_long_Engin_NA |>
1707497014160:group_by(Type,Year,Reitur) %>%
1707497014187:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707497014206:group_by(Type,Year) %>%
1707497014221:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707497014246:# heildarþekja (öll Type) allra reita innan ára
1707497014264:df_summary <- jd_long_Engin_NA |>
1707497014284:group_by(Year,Reitur) %>%
1707497014301:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707497014316:group_by(Year) %>%
1707497014333:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707497014354:mutate(Type = "Heildarþekja") |>
1707497014371:select(Type, Year, Mean, SE)
1707497014411:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707497014428:# Ensure Type is ordered as desired
1707497014445:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707497014479:# Plot
1707497014498:p1 <-
1707497014517:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707497014535:geom_bar(
1707497014553:stat = "identity",
1707497014568:color = "black",
1707497014587:size = .6,
1707497014602:position = position_dodge(width = 0.75)
1707497014618:) +
1707497014635:geom_errorbar(
1707497014650:aes(ymin = Mean - SE, ymax = Mean + SE),
1707497014669:width = .2,
1707497014689:position = position_dodge(width = 0.75)
1707497014705:) +
1707497014722:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707497014740:scale_y_continuous(
1707497014756:labels = label_dollar(prefix = "", suffix = " \n%"),
1707497014771:# Example secondary axis (e.g., double the Mean for illustration)
1707497014787:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707497014803:) +
1707497014818:labs(title = "",
1707497014833:y = "Meðalþekja", x = "") +
1707497014848:scale_x_discrete(
1707497014863:"",
1707497014878:labels = c(
1707497014894:"Mosar" = "Mosar",
1707497014910:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707497014927:"Hrúðurfléttur" = "Hrúðurfléttur",
1707497014941:"Heildarþekja" = "Heildarþekja",
1707497014958:"Tegundafjöldi" = "Tegundafjöldi"
1707497014974:)
1707497014989:) +
1707497015004:theme_minimal() +
1707497015020:theme(legend.title = element_blank(),
1707497015037:plot.background = element_rect(fill = "white", color = NA)) +
1707497015052:annotate(
1707497015065:"text",
1707497015079:x = 2,
1707497015095:y = Inf,
1707497015112:label = i,
1707497015126:hjust = 1,
1707497015140:vjust = 1,
1707497015156:size = 8,
1707497015174:angle = 0
1707497015190:)
1707497015218:p1 <-
1707497015233:p1 + theme(
1707497015249:axis.title = element_text(size = 16),
1707497015265:# Increase axis titles
1707497015280:axis.text = element_text(size = 16),
1707497015295:# Increase axis text
1707497015310:legend.text = element_text(size = 16)
1707497015327:) # Increase legend text
1707497015355:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707497015373:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707497015414:}
1707497016704:p1
1707497037844:for (i in unique(joined_data$Stadur)) {
1707497037887:filtered_data <- joined_data %>%
1707497037903:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707497037919:select(where(~ !all(is.na(.))))
1707497037943:# Dynamically identify year columns that exist after filtering
1707497037957:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707497037972:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707497037999:# Pivot longer only with existing year columns
1707497038014:jd_long <- filtered_data %>%
1707497038030:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707497038057:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707497038083:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707497038098:# Fjöldi tegunda í reit á ári
1707497038114:species_counts <- jd_long_Engin_NA %>%
1707497038131:group_by(Reitur, Year) %>%
1707497038150:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707497038165:# Meðalfjöldi tegunda í reit á ári
1707497038180:group_by(Year) %>%
1707497038194:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707497038211:mutate(Type = "Tegundafjöldi")|>
1707497038230:select(Type, Year, Mean, SE)
1707497038259:# Meðalþekja reita eftir Type
1707497038273:df <- jd_long_Engin_NA |>
1707497038288:group_by(Type,Year,Reitur) %>%
1707497038304:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707497038317:group_by(Type,Year) %>%
1707497038333:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707497038361:# heildarþekja (öll Type) allra reita innan ára
1707497038377:df_summary <- jd_long_Engin_NA |>
1707497038393:group_by(Year,Reitur) %>%
1707497038410:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707497038425:group_by(Year) %>%
1707497038441:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707497038456:mutate(Type = "Heildarþekja") |>
1707497038472:select(Type, Year, Mean, SE)
1707497038514:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707497038529:# Ensure Type is ordered as desired
1707497038547:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707497038579:# Plot
1707497038598:p1 <-
1707497038615:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707497038631:geom_bar(
1707497038646:stat = "identity",
1707497038663:color = "black",
1707497038679:size = .6,
1707497038695:position = position_dodge(width = 0.75)
1707497038710:) +
1707497038725:geom_errorbar(
1707497038741:aes(ymin = Mean - SE, ymax = Mean + SE),
1707497038755:width = .2,
1707497038771:position = position_dodge(width = 0.75)
1707497038787:) +
1707497038803:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707497038818:scale_y_continuous(
1707497038833:labels = label_dollar(prefix = "", suffix = " \n%"),
1707497038853:# Example secondary axis (e.g., double the Mean for illustration)
1707497038869:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707497038886:) +
1707497038902:labs(title = "",
1707497038917:y = "Meðalþekja", x = "") +
1707497038936:scale_x_discrete(
1707497038954:"",
1707497038975:labels = c(
1707497038991:"Mosar" = "Mosar",
1707497039005:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707497039022:"Hrúðurfléttur" = "Hrúðurfléttur",
1707497039036:"Heildarþekja" = "Heildarþekja",
1707497039053:"Tegundafjöldi" = "Tegundafjöldi"
1707497039068:)
1707497039084:) +
1707497039101:theme_minimal() +
1707497039118:theme(legend.title = element_blank(),
1707497039134:plot.background = element_rect(fill = "white", color = NA)) +
1707497039150:annotate(
1707497039166:"text",
1707497039183:x = 2,
1707497039199:y = Inf,
1707497039213:label = i,
1707497039230:hjust = 1,
1707497039249:vjust = 1,
1707497039271:size = 8,
1707497039288:angle = 0
1707497039304:)
1707497039335:p1 <-
1707497039350:p1 + theme(
1707497039366:axis.title = element_text(size = 16),
1707497039382:# Increase axis titles
1707497039397:axis.text = element_text(size = 16),
1707497039412:# Increase axis text
1707497039429:legend.text = element_text(size = 16)
1707497039442:) # Increase legend text
1707497039464:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707497039477:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707497039518:}
1707745328867:unique(joined_data$Stadur)
1707745372129:library(tidyverse)
1707745372227:library(glue)
1707745372251:library(scales)
1707745372287:colors_dark2 <- brewer.pal(8, "Accent")
1707745372331:KM <- read.csv("gogn/coverkm.csv", check.names = F)
1707745372527:KM <-  KM[,-c(7:9)]
1707745372559:data <- read.csv("gogn/hreinsad.csv", check.names = F)
1707745372689:joined_data <- data %>%
1707745372730:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707745372760:select(species, Type, Reitur, km, everything()) |>
1707745372787:#select(-c(`1999`)) |>
1707745372814:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707745372838:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707745372859:filter(!species %in% "Ber klöpp")
1707745386332:for (i in unique(joined_data$Stadur)[15]) {
1707745386386:filtered_data <- joined_data %>%
1707745386412:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707745386437:select(where(~ !all(is.na(.))))
1707745386468:# Dynamically identify year columns that exist after filtering
1707745386483:year_columns <- c('1976', '1997', '2006', '2011', '2014', '2017', '2020', '2023')
1707745386501:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707745386563:# Pivot longer only with existing year columns
1707745386586:jd_long <- filtered_data %>%
1707745386609:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707745386652:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707745386693:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707745386717:# Fjöldi tegunda í reit á ári
1707745386739:species_counts <- jd_long_Engin_NA %>%
1707745386762:group_by(Reitur, Year) %>%
1707745386786:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707745386809:# Meðalfjöldi tegunda í reit á ári
1707745386830:group_by(Year) %>%
1707745386847:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707745386866:mutate(Type = "Tegundafjöldi")|>
1707745386885:select(Type, Year, Mean, SE)
1707745386920:# Meðalþekja reita eftir Type
1707745386940:df <- jd_long_Engin_NA |>
1707745386962:group_by(Type,Year,Reitur) %>%
1707745386981:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707745386999:group_by(Type,Year) %>%
1707745387022:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707745387059:# heildarþekja (öll Type) allra reita innan ára
1707745387078:df_summary <- jd_long_Engin_NA |>
1707745387098:group_by(Year,Reitur) %>%
1707745387116:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707745387142:group_by(Year) %>%
1707745387169:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707745387188:mutate(Type = "Heildarþekja") |>
1707745387209:select(Type, Year, Mean, SE)
1707745387265:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707745387301:# Ensure Type is ordered as desired
1707745387333:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707745387370:# Plot
1707745387392:p1 <-
1707745387412:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707745387435:geom_bar(
1707745387472:stat = "identity",
1707745387520:color = "black",
1707745387558:size = .6,
1707745387582:position = position_dodge(width = 0.75)
1707745387605:) +
1707745387623:geom_errorbar(
1707745387642:aes(ymin = Mean - SE, ymax = Mean + SE),
1707745387664:width = .2,
1707745387683:position = position_dodge(width = 0.75)
1707745387701:) +
1707745387721:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707745387744:scale_y_continuous(
1707745387765:labels = label_dollar(prefix = "", suffix = " \n%"),
1707745387787:# Example secondary axis (e.g., double the Mean for illustration)
1707745387811:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707745387833:) +
1707745387854:labs(title = "",
1707745387873:y = "Meðalþekja", x = "") +
1707745387896:scale_x_discrete(
1707745387918:"",
1707745387958:labels = c(
1707745387983:"Mosar" = "Mosar",
1707745388004:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707745388024:"Hrúðurfléttur" = "Hrúðurfléttur",
1707745388046:"Heildarþekja" = "Heildarþekja",
1707745388068:"Tegundafjöldi" = "Tegundafjöldi"
1707745388093:)
1707745388117:) +
1707745388141:theme_minimal() +
1707745388170:theme(legend.title = element_blank(),
1707745388196:plot.background = element_rect(fill = "white", color = NA)) +
1707745388217:annotate(
1707745388235:"text",
1707745388257:x = 2,
1707745388284:y = Inf,
1707745388313:label = i,
1707745388342:hjust = 1,
1707745388364:vjust = 1,
1707745388385:size = 8,
1707745388410:angle = 0
1707745388432:)
1707745388477:p1 <-
1707745388498:p1 + theme(
1707745388518:axis.title = element_text(size = 16),
1707745388540:# Increase axis titles
1707745388565:axis.text = element_text(size = 16),
1707745388585:# Increase axis text
1707745388605:legend.text = element_text(size = 16)
1707745388624:) # Increase legend text
1707745388657:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707745388680:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707745388736:}
1707745448955:for (i in unique(joined_data$Stadur)[15]) {
1707745449011:filtered_data <- joined_data %>%
1707745449034:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707745449054:select(where(~ !all(is.na(.))))
1707745449085:# Dynamically identify year columns that exist after filtering
1707745449104:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707745449123:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707745449157:# Pivot longer only with existing year columns
1707745449178:jd_long <- filtered_data %>%
1707745449198:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707745449241:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707745449282:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707745449304:# Fjöldi tegunda í reit á ári
1707745449324:species_counts <- jd_long_Engin_NA %>%
1707745449341:group_by(Reitur, Year) %>%
1707745449359:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707745449379:# Meðalfjöldi tegunda í reit á ári
1707745449398:group_by(Year) %>%
1707745449417:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707745449451:mutate(Type = "Tegundafjöldi")|>
1707745449477:select(Type, Year, Mean, SE)
1707745449510:# Meðalþekja reita eftir Type
1707745449528:df <- jd_long_Engin_NA |>
1707745449549:group_by(Type,Year,Reitur) %>%
1707745449567:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707745449587:group_by(Type,Year) %>%
1707745449605:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707745449635:# heildarþekja (öll Type) allra reita innan ára
1707745449652:df_summary <- jd_long_Engin_NA |>
1707745449668:group_by(Year,Reitur) %>%
1707745449687:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707745449706:group_by(Year) %>%
1707745449727:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707745449746:mutate(Type = "Heildarþekja") |>
1707745449765:select(Type, Year, Mean, SE)
1707745449822:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707745449843:# Ensure Type is ordered as desired
1707745449864:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707745449900:# Plot
1707745449942:p1 <-
1707745449972:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707745449995:geom_bar(
1707745450020:stat = "identity",
1707745450044:color = "black",
1707745450068:size = .6,
1707745450088:position = position_dodge(width = 0.75)
1707745450106:) +
1707745450123:geom_errorbar(
1707745450142:aes(ymin = Mean - SE, ymax = Mean + SE),
1707745450161:width = .2,
1707745450181:position = position_dodge(width = 0.75)
1707745450200:) +
1707745450219:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707745450241:scale_y_continuous(
1707745450263:labels = label_dollar(prefix = "", suffix = " \n%"),
1707745450290:# Example secondary axis (e.g., double the Mean for illustration)
1707745450314:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707745450337:) +
1707745450357:labs(title = "",
1707745450380:y = "Meðalþekja", x = "") +
1707745450403:scale_x_discrete(
1707745450437:"",
1707745450458:labels = c(
1707745450485:"Mosar" = "Mosar",
1707745450509:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707745450528:"Hrúðurfléttur" = "Hrúðurfléttur",
1707745450548:"Heildarþekja" = "Heildarþekja",
1707745450567:"Tegundafjöldi" = "Tegundafjöldi"
1707745450583:)
1707745450598:) +
1707745450615:theme_minimal() +
1707745450630:theme(legend.title = element_blank(),
1707745450646:plot.background = element_rect(fill = "white", color = NA)) +
1707745450667:annotate(
1707745450685:"text",
1707745450700:x = 2,
1707745450716:y = Inf,
1707745450734:label = i,
1707745450751:hjust = 1,
1707745450766:vjust = 1,
1707745450782:size = 8,
1707745450798:angle = 0
1707745450815:)
1707745450853:p1 <-
1707745450876:p1 + theme(
1707745450894:axis.title = element_text(size = 16),
1707745450995:# Increase axis titles
1707745451012:axis.text = element_text(size = 16),
1707745451083:# Increase axis text
1707745451114:legend.text = element_text(size = 16)
1707745451130:) # Increase legend text
1707745451162:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707745451180:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707745451226:}
1707745551085:for (i in unique(joined_data$Stadur)[15]) {
1707745551169:filtered_data <- joined_data %>%
1707745551195:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707745551248:select(where(~ !all(is.na(.))))
1707745551281:# Dynamically identify year columns that exist after filtering
1707745551302:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707745551320:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707745551503:# Pivot longer only with existing year columns
1707745551527:jd_long <- filtered_data %>%
1707745551546:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707745551574:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707745551605:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707745551631:# Fjöldi tegunda í reit á ári
1707745551647:species_counts <- jd_long_Engin_NA %>%
1707745551666:group_by(Reitur, Year) %>%
1707745551686:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707745551733:# Meðalfjöldi tegunda í reit á ári
1707745551756:group_by(Year) %>%
1707745551773:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707745551794:mutate(Type = "Tegundafjöldi")|>
1707745551810:select(Type, Year, Mean, SE)
1707745551849:# Meðalþekja reita eftir Type
1707745551869:df <- jd_long_Engin_NA |>
1707745551888:group_by(Type,Year,Reitur) %>%
1707745551905:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707745551959:group_by(Type,Year) %>%
1707745551999:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707745552042:# heildarþekja (öll Type) allra reita innan ára
1707745552061:df_summary <- jd_long_Engin_NA |>
1707745552106:group_by(Year,Reitur) %>%
1707745552127:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707745552153:group_by(Year) %>%
1707745552170:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707745552188:mutate(Type = "Heildarþekja") |>
1707745552206:select(Type, Year, Mean, SE)
1707745552249:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707745552268:# Ensure Type is ordered as desired
1707745552307:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707745552339:# Plot
1707745552358:p1 <-
1707745552376:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707745552396:geom_bar(
1707745552434:stat = "identity",
1707745552469:color = "black",
1707745552494:size = .6,
1707745552517:position = position_dodge(width = 0.75)
1707745552536:) +
1707745552554:# geom_errorbar(
1707745552571:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707745552587:#   width = .2,
1707745552635:#   position = position_dodge(width = 0.75)
1707745552656:# ) +
1707745552672:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707745552688:scale_y_continuous(
1707745552704:labels = label_dollar(prefix = "", suffix = " \n%"),
1707745552727:# Example secondary axis (e.g., double the Mean for illustration)
1707745552746:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707745552767:) +
1707745552784:labs(title = "",
1707745552799:y = "Meðalþekja", x = "") +
1707745552816:scale_x_discrete(
1707745552833:"",
1707745552851:labels = c(
1707745552871:"Mosar" = "Mosar",
1707745552889:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707745552924:"Hrúðurfléttur" = "Hrúðurfléttur",
1707745552949:"Heildarþekja" = "Heildarþekja",
1707745552966:"Tegundafjöldi" = "Tegundafjöldi"
1707745552987:)
1707745553005:) +
1707745553022:theme_minimal() +
1707745553039:theme(legend.title = element_blank(),
1707745553055:plot.background = element_rect(fill = "white", color = NA)) +
1707745553074:annotate(
1707745553100:"text",
1707745553120:x = 2,
1707745553136:y = Inf,
1707745553152:label = i,
1707745553171:hjust = 1,
1707745553186:vjust = 1,
1707745553206:size = 8,
1707745553222:angle = 0
1707745553237:)
1707745553273:p1 <-
1707745553290:p1 + theme(
1707745553307:axis.title = element_text(size = 16),
1707745553323:# Increase axis titles
1707745553342:axis.text = element_text(size = 16),
1707745553362:# Increase axis text
1707745553387:legend.text = element_text(size = 16)
1707745553412:) # Increase legend text
1707745553449:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707745553470:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707745553516:}
1707745623798:for (i in unique(joined_data$Stadur)) {
1707745623847:filtered_data <- joined_data %>%
1707745623866:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707745623889:select(where(~ !all(is.na(.))))
1707745623926:# Dynamically identify year columns that exist after filtering
1707745623950:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707745623981:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707745624034:# Pivot longer only with existing year columns
1707745624061:jd_long <- filtered_data %>%
1707745624085:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707745624124:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707745624166:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707745624187:# Fjöldi tegunda í reit á ári
1707745624205:species_counts <- jd_long_Engin_NA %>%
1707745624226:group_by(Reitur, Year) %>%
1707745624243:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707745624291:# Meðalfjöldi tegunda í reit á ári
1707745624319:group_by(Year) %>%
1707745624346:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707745624376:mutate(Type = "Tegundafjöldi")|>
1707745624401:select(Type, Year, Mean, SE)
1707745624444:# Meðalþekja reita eftir Type
1707745624465:df <- jd_long_Engin_NA |>
1707745624488:group_by(Type,Year,Reitur) %>%
1707745624507:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707745624535:group_by(Type,Year) %>%
1707745624552:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707745624589:# heildarþekja (öll Type) allra reita innan ára
1707745624610:df_summary <- jd_long_Engin_NA |>
1707745624634:group_by(Year,Reitur) %>%
1707745624654:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707745624680:group_by(Year) %>%
1707745624709:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707745624736:mutate(Type = "Heildarþekja") |>
1707745624774:select(Type, Year, Mean, SE)
1707745624839:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707745624856:# Ensure Type is ordered as desired
1707745624873:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707745624906:# Plot
1707745624926:p1 <-
1707745624945:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707745624963:geom_bar(
1707745624981:stat = "identity",
1707745624997:color = "black",
1707745625021:size = .6,
1707745625046:position = position_dodge(width = 0.75)
1707745625068:) +
1707745625092:# geom_errorbar(
1707745625117:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707745625141:#   width = .2,
1707745625164:#   position = position_dodge(width = 0.75)
1707745625186:# ) +
1707745625208:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707745625229:scale_y_continuous(
1707745625251:labels = label_dollar(prefix = "", suffix = " \n%"),
1707745625289:# Example secondary axis (e.g., double the Mean for illustration)
1707745625309:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707745625335:) +
1707745625355:labs(title = "",
1707745625376:y = "Meðalþekja", x = "") +
1707745625397:scale_x_discrete(
1707745625414:"",
1707745625470:labels = c(
1707745625488:"Mosar" = "Mosar",
1707745625505:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707745625523:"Hrúðurfléttur" = "Hrúðurfléttur",
1707745625581:"Heildarþekja" = "Heildarþekja",
1707745625605:"Tegundafjöldi" = "Tegundafjöldi"
1707745625629:)
1707745625651:) +
1707745625671:theme_minimal() +
1707745625690:theme(legend.title = element_blank(),
1707745625712:plot.background = element_rect(fill = "white", color = NA)) +
1707745625737:annotate(
1707745625773:"text",
1707745625796:x = 2,
1707745625821:y = Inf,
1707745625850:label = i,
1707745625870:hjust = 1,
1707745625889:vjust = 1,
1707745625910:size = 8,
1707745625934:angle = 0
1707745625955:)
1707745625992:p1 <-
1707745626010:p1 + theme(
1707745626032:axis.title = element_text(size = 16),
1707745626055:# Increase axis titles
1707745626073:axis.text = element_text(size = 16),
1707745626093:# Increase axis text
1707745626112:legend.text = element_text(size = 16)
1707745626133:) # Increase legend text
1707745626164:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707745626183:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707745626232:}
1707746096653:joined_data[joined_data$Reitur==65,]
1707746110131:joined_data[joined_data$Reitur=="R65",]
1707746515183:gc()
1707746780933:5+5
1707749208327:5+5
1707751473415:joined_data[joined_data$Reitur=="R65",]
1707751477058:joined_data[joined_data$Reitur=="R66",]
1707751519135:joined_data <- data %>%
1707751519153:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707751519170:select(species, Type, Reitur, km, everything()) |>
1707751519183:#select(-c(`1999`)) |>
1707751519198:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707751519215:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707751519232:filter(!species %in% "Ber klöpp")
1707751521927:joined_data[joined_data$Reitur=="R66",]
1707751583341:joined_data[joined_data$Reitur=="R65",]
1707751603343:joined_data[joined_data$Reitur==c("R65", "R66" ,]
1707751605956:joined_data[joined_data$Reitur==c("R65", "R66") ,]
1707751975164:unique(joined_data$Stadur)
1707752101635:for (i in unique(joined_data$Stadur)[16]) {
1707752101670:filtered_data <- joined_data %>%
1707752101687:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707752101702:select(where(~ !all(is.na(.))))
1707752101725:# Dynamically identify year columns that exist after filtering
1707752101739:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707752101753:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707752101779:# Pivot longer only with existing year columns
1707752101792:jd_long <- filtered_data %>%
1707752101808:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707752101833:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707752101858:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707752101872:# Fjöldi tegunda í reit á ári
1707752101886:species_counts <- jd_long_Engin_NA %>%
1707752101899:group_by(Reitur, Year) %>%
1707752101913:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707752101927:# Meðalfjöldi tegunda í reit á ári
1707752101940:group_by(Year) %>%
1707752101955:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707752101970:mutate(Type = "Tegundafjöldi")|>
1707752101983:select(Type, Year, Mean, SE)
1707752102005:# Meðalþekja reita eftir Type
1707752102021:df <- jd_long_Engin_NA |>
1707752102034:group_by(Type,Year,Reitur) %>%
1707752102048:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707752102061:group_by(Type,Year) %>%
1707752102075:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707752102101:# heildarþekja (öll Type) allra reita innan ára
1707752102119:df_summary <- jd_long_Engin_NA |>
1707752102135:group_by(Year,Reitur) %>%
1707752102149:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707752102163:group_by(Year) %>%
1707752102177:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707752102190:mutate(Type = "Heildarþekja") |>
1707752102205:select(Type, Year, Mean, SE)
1707752102239:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707752102254:# Ensure Type is ordered as desired
1707752102267:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707752102295:# Plot
1707752102307:p1 <-
1707752102321:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707752102337:geom_bar(
1707752102352:stat = "identity",
1707752102366:color = "black",
1707752102379:size = .6,
1707752102392:position = position_dodge(width = 0.75)
1707752102404:) +
1707752102417:# geom_errorbar(
1707752102432:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707752102447:#   width = .2,
1707752102461:#   position = position_dodge(width = 0.75)
1707752102477:# ) +
1707752102492:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707752102506:scale_y_continuous(
1707752102523:labels = label_dollar(prefix = "", suffix = " \n%"),
1707752102535:# Example secondary axis (e.g., double the Mean for illustration)
1707752102549:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707752102564:) +
1707752102578:labs(title = "",
1707752102590:y = "Meðalþekja", x = "") +
1707752102605:scale_x_discrete(
1707752102620:"",
1707752102634:labels = c(
1707752102650:"Mosar" = "Mosar",
1707752102665:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707752102682:"Hrúðurfléttur" = "Hrúðurfléttur",
1707752102695:"Heildarþekja" = "Heildarþekja",
1707752102710:"Tegundafjöldi" = "Tegundafjöldi"
1707752102725:)
1707752102739:) +
1707752102753:theme_minimal() +
1707752102766:theme(legend.title = element_blank(),
1707752102780:plot.background = element_rect(fill = "white", color = NA)) +
1707752102794:annotate(
1707752102809:"text",
1707752102823:x = 2,
1707752102837:y = Inf,
1707752102853:label = i,
1707752102867:hjust = 1,
1707752102883:vjust = 1,
1707752102898:size = 8,
1707752102912:angle = 0
1707752102927:)
1707752102950:p1 <-
1707752102964:p1 + theme(
1707752102976:axis.title = element_text(size = 16),
1707752102988:# Increase axis titles
1707752103003:axis.text = element_text(size = 16),
1707752103019:# Increase axis text
1707752103033:legend.text = element_text(size = 16)
1707752103048:) # Increase legend text
1707752103075:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707752103089:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707752103131:}
1707752111357:library(glue)
1707752111530:library(scales)
1707752116820:for (i in unique(joined_data$Stadur)[16]) {
1707752116850:filtered_data <- joined_data %>%
1707752116862:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707752116877:select(where(~ !all(is.na(.))))
1707752116903:# Dynamically identify year columns that exist after filtering
1707752116917:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707752116931:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707752116956:# Pivot longer only with existing year columns
1707752116970:jd_long <- filtered_data %>%
1707752116984:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707752117009:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707752117034:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707752117049:# Fjöldi tegunda í reit á ári
1707752117064:species_counts <- jd_long_Engin_NA %>%
1707752117078:group_by(Reitur, Year) %>%
1707752117092:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707752117108:# Meðalfjöldi tegunda í reit á ári
1707752117124:group_by(Year) %>%
1707752117144:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707752117159:mutate(Type = "Tegundafjöldi")|>
1707752117174:select(Type, Year, Mean, SE)
1707752117200:# Meðalþekja reita eftir Type
1707752117213:df <- jd_long_Engin_NA |>
1707752117227:group_by(Type,Year,Reitur) %>%
1707752117241:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707752117256:group_by(Type,Year) %>%
1707752117270:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707752117296:# heildarþekja (öll Type) allra reita innan ára
1707752117311:df_summary <- jd_long_Engin_NA |>
1707752117324:group_by(Year,Reitur) %>%
1707752117339:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707752117353:group_by(Year) %>%
1707752117367:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707752117382:mutate(Type = "Heildarþekja") |>
1707752117396:select(Type, Year, Mean, SE)
1707752117433:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707752117448:# Ensure Type is ordered as desired
1707752117462:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707752117487:# Plot
1707752117500:p1 <-
1707752117514:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707752117529:geom_bar(
1707752117544:stat = "identity",
1707752117559:color = "black",
1707752117574:size = .6,
1707752117588:position = position_dodge(width = 0.75)
1707752117601:) +
1707752117614:# geom_errorbar(
1707752117628:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707752117643:#   width = .2,
1707752117656:#   position = position_dodge(width = 0.75)
1707752117670:# ) +
1707752117685:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707752117698:scale_y_continuous(
1707752117713:labels = label_dollar(prefix = "", suffix = " \n%"),
1707752117727:# Example secondary axis (e.g., double the Mean for illustration)
1707752117740:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707752117752:) +
1707752117765:labs(title = "",
1707752117782:y = "Meðalþekja", x = "") +
1707752117798:scale_x_discrete(
1707752117812:"",
1707752117826:labels = c(
1707752117841:"Mosar" = "Mosar",
1707752117856:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707752117870:"Hrúðurfléttur" = "Hrúðurfléttur",
1707752117885:"Heildarþekja" = "Heildarþekja",
1707752117900:"Tegundafjöldi" = "Tegundafjöldi"
1707752117914:)
1707752117930:) +
1707752117947:theme_minimal() +
1707752117963:theme(legend.title = element_blank(),
1707752117978:plot.background = element_rect(fill = "white", color = NA)) +
1707752117992:annotate(
1707752118007:"text",
1707752118023:x = 2,
1707752118039:y = Inf,
1707752118052:label = i,
1707752118067:hjust = 1,
1707752118082:vjust = 1,
1707752118096:size = 8,
1707752118112:angle = 0
1707752118128:)
1707752118162:p1 <-
1707752118179:p1 + theme(
1707752118193:axis.title = element_text(size = 16),
1707752118207:# Increase axis titles
1707752118222:axis.text = element_text(size = 16),
1707752118237:# Increase axis text
1707752118252:legend.text = element_text(size = 16)
1707752118269:) # Increase legend text
1707752118299:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707752118313:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707752118351:}
1707752189973:jd_long
1707752197986:filtered_data
1707752452693:####
1707752452711:###týndar tölur
1707752452725:joined_data$2020[joined_data$Reitur=="R65"]
1707752470397:####
1707752470412:###týndar tölur
1707752470428:joined_data$´2020´[joined_data$Reitur=="R65"]
1707752489259:####
1707752489275:###týndar tölur
1707752489292:joined_data$`2020`[joined_data$Reitur=="R65"]
1707752701794:filtered_data <- joined_data %>%
1707752701816:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707752701839:select(where(~ !all(is.na(.))))
1707753117998:####
1707753118020:###týndar tölur
1707753118039:joined_data$`2020`[joined_data$Reitur=="R65"]
1707753133238:year_columns
1707753136548:existing_year_columns
1707753180966:joined_data[,existing_year_columns]
1707753208156:rowSums(joined_data[,existing_year_columns])
1707753223662:rowSums(joined_data[,existing_year_columns],na.rm = T)
1707753310630:joined_data$`2020` <- rowSums(joined_data[,existing_year_columns],na.rm = T)
1707753330519:for (i in unique(joined_data$Stadur)[16]) {
1707753330555:filtered_data <- joined_data %>%
1707753330570:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707753330585:select(where(~ !all(is.na(.))))
1707753330609:# Dynamically identify year columns that exist after filtering
1707753330623:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707753330637:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707753330650:joined_data$`2020` <- rowSums(joined_data[,existing_year_columns],na.rm = T)
1707753330663:# Pivot longer only with existing year columns
1707753330677:jd_long <- filtered_data %>%
1707753330690:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707753330714:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707753330738:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707753330752:# Fjöldi tegunda í reit á ári
1707753330768:species_counts <- jd_long_Engin_NA %>%
1707753330785:group_by(Reitur, Year) %>%
1707753330800:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707753330817:# Meðalfjöldi tegunda í reit á ári
1707753330833:group_by(Year) %>%
1707753330848:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707753330865:mutate(Type = "Tegundafjöldi")|>
1707753330881:select(Type, Year, Mean, SE)
1707753330906:# Meðalþekja reita eftir Type
1707753330921:df <- jd_long_Engin_NA |>
1707753330935:group_by(Type,Year,Reitur) %>%
1707753330950:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707753330964:group_by(Type,Year) %>%
1707753330978:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707753331001:# heildarþekja (öll Type) allra reita innan ára
1707753331014:df_summary <- jd_long_Engin_NA |>
1707753331029:group_by(Year,Reitur) %>%
1707753331043:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707753331056:group_by(Year) %>%
1707753331070:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707753331085:mutate(Type = "Heildarþekja") |>
1707753331101:select(Type, Year, Mean, SE)
1707753331136:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707753331151:# Ensure Type is ordered as desired
1707753331166:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707753331190:# Plot
1707753331206:p1 <-
1707753331221:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707753331235:geom_bar(
1707753331249:stat = "identity",
1707753331263:color = "black",
1707753331277:size = .6,
1707753331292:position = position_dodge(width = 0.75)
1707753331308:) +
1707753331323:# geom_errorbar(
1707753331339:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707753331357:#   width = .2,
1707753331371:#   position = position_dodge(width = 0.75)
1707753331385:# ) +
1707753331400:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707753331413:scale_y_continuous(
1707753331426:labels = label_dollar(prefix = "", suffix = " \n%"),
1707753331440:# Example secondary axis (e.g., double the Mean for illustration)
1707753331455:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707753331469:) +
1707753331485:labs(title = "",
1707753331499:y = "Meðalþekja", x = "") +
1707753331513:scale_x_discrete(
1707753331527:"",
1707753331541:labels = c(
1707753331554:"Mosar" = "Mosar",
1707753331567:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707753331581:"Hrúðurfléttur" = "Hrúðurfléttur",
1707753331595:"Heildarþekja" = "Heildarþekja",
1707753331608:"Tegundafjöldi" = "Tegundafjöldi"
1707753331620:)
1707753331633:) +
1707753331647:theme_minimal() +
1707753331663:theme(legend.title = element_blank(),
1707753331677:plot.background = element_rect(fill = "white", color = NA)) +
1707753331691:annotate(
1707753331705:"text",
1707753331716:x = 2,
1707753331726:y = Inf,
1707753331737:label = i,
1707753331747:hjust = 1,
1707753331758:vjust = 1,
1707753331768:size = 8,
1707753331780:angle = 0
1707753331790:)
1707753331816:p1 <-
1707753331832:p1 + theme(
1707753331845:axis.title = element_text(size = 16),
1707753331856:# Increase axis titles
1707753331866:axis.text = element_text(size = 16),
1707753331877:# Increase axis text
1707753331888:legend.text = element_text(size = 16)
1707753331898:) # Increase legend text
1707753331917:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707753331928:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707753331960:}
1707753342899:df_with_heildarþekja
1707753370890:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707753370909:geom_bar(
1707753370927:stat = "identity",
1707753370942:color = "black",
1707753370957:size = .6,
1707753370971:position = position_dodge(width = 0.75)
1707753370984:)
1707753394501:rowMeans(joined_data[,existing_year_columns],na.rm = T)
1707753411526:for (i in unique(joined_data$Stadur)[16]) {
1707753411552:filtered_data <- joined_data %>%
1707753411564:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707753411575:select(where(~ !all(is.na(.))))
1707753411593:# Dynamically identify year columns that exist after filtering
1707753411605:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707753411615:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707753411626:joined_data$`2020` <- rowMeans(joined_data[,existing_year_columns],na.rm = T)
1707753411637:# Pivot longer only with existing year columns
1707753411648:jd_long <- filtered_data %>%
1707753411659:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707753411679:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707753411698:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707753411709:# Fjöldi tegunda í reit á ári
1707753411720:species_counts <- jd_long_Engin_NA %>%
1707753411731:group_by(Reitur, Year) %>%
1707753411743:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707753411753:# Meðalfjöldi tegunda í reit á ári
1707753411764:group_by(Year) %>%
1707753411775:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707753411786:mutate(Type = "Tegundafjöldi")|>
1707753411797:select(Type, Year, Mean, SE)
1707753411818:# Meðalþekja reita eftir Type
1707753411830:df <- jd_long_Engin_NA |>
1707753411841:group_by(Type,Year,Reitur) %>%
1707753411852:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707753411863:group_by(Type,Year) %>%
1707753411874:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707753411893:# heildarþekja (öll Type) allra reita innan ára
1707753411905:df_summary <- jd_long_Engin_NA |>
1707753411917:group_by(Year,Reitur) %>%
1707753411929:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707753411941:group_by(Year) %>%
1707753411952:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707753411964:mutate(Type = "Heildarþekja") |>
1707753411976:select(Type, Year, Mean, SE)
1707753412003:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707753412015:# Ensure Type is ordered as desired
1707753412027:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707753412047:# Plot
1707753412059:p1 <-
1707753412070:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707753412081:geom_bar(
1707753412093:stat = "identity",
1707753412104:color = "black",
1707753412115:size = .6,
1707753412127:position = position_dodge(width = 0.75)
1707753412138:) +
1707753412150:# geom_errorbar(
1707753412162:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707753412174:#   width = .2,
1707753412185:#   position = position_dodge(width = 0.75)
1707753412197:# ) +
1707753412207:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707753412219:scale_y_continuous(
1707753412231:labels = label_dollar(prefix = "", suffix = " \n%"),
1707753412243:# Example secondary axis (e.g., double the Mean for illustration)
1707753412254:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707753412266:) +
1707753412278:labs(title = "",
1707753412290:y = "Meðalþekja", x = "") +
1707753412301:scale_x_discrete(
1707753412312:"",
1707753412324:labels = c(
1707753412336:"Mosar" = "Mosar",
1707753412347:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707753412359:"Hrúðurfléttur" = "Hrúðurfléttur",
1707753412371:"Heildarþekja" = "Heildarþekja",
1707753412384:"Tegundafjöldi" = "Tegundafjöldi"
1707753412397:)
1707753412409:) +
1707753412420:theme_minimal() +
1707753412433:theme(legend.title = element_blank(),
1707753412444:plot.background = element_rect(fill = "white", color = NA)) +
1707753412455:annotate(
1707753412468:"text",
1707753412479:x = 2,
1707753412491:y = Inf,
1707753412502:label = i,
1707753412514:hjust = 1,
1707753412528:vjust = 1,
1707753412543:size = 8,
1707753412559:angle = 0
1707753412575:)
1707753412602:p1 <-
1707753412617:p1 + theme(
1707753412632:axis.title = element_text(size = 16),
1707753412647:# Increase axis titles
1707753412661:axis.text = element_text(size = 16),
1707753412677:# Increase axis text
1707753412693:legend.text = element_text(size = 16)
1707753412708:) # Increase legend text
1707753412736:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707753412751:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707753412784:}
1707753442830:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707753442850:geom_bar(
1707753442869:stat = "identity",
1707753442887:color = "black",
1707753442903:size = .6,
1707753442922:position = position_dodge(width = 0.75)
1707753442939:)
1707753457124:df_with_heildarþekja
1707753482386:filtered_data <- joined_data %>%
1707753482411:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707753482429:select(where(~ !all(is.na(.))))
1707753484574:# Dynamically identify year columns that exist after filtering
1707753484596:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707753485182:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707753486067:joined_data$`2020` <- rowMeans(joined_data[,existing_year_columns],na.rm = T)
1707753487083:# Pivot longer only with existing year columns
1707753487106:jd_long <- filtered_data %>%
1707753487125:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707753495075:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707753500513:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707753500538:# Fjöldi tegunda í reit á ári
1707753500559:species_counts <- jd_long_Engin_NA %>%
1707753500578:group_by(Reitur, Year) %>%
1707753500595:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707753500613:# Meðalfjöldi tegunda í reit á ári
1707753500631:group_by(Year) %>%
1707753500649:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707753500665:mutate(Type = "Tegundafjöldi")|>
1707753500682:select(Type, Year, Mean, SE)
1707753503436:# Meðalþekja reita eftir Type
1707753503461:df <- jd_long_Engin_NA |>
1707753503480:group_by(Type,Year,Reitur) %>%
1707753503497:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707753503514:group_by(Type,Year) %>%
1707753503532:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707753504788:# heildarþekja (öll Type) allra reita innan ára
1707753504818:df_summary <- jd_long_Engin_NA |>
1707753504840:group_by(Year,Reitur) %>%
1707753504855:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707753504869:group_by(Year) %>%
1707753504884:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707753504900:mutate(Type = "Heildarþekja") |>
1707753504915:select(Type, Year, Mean, SE)
1707753506534:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707753507690:# Ensure Type is ordered as desired
1707753507711:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707753512109:df_with_heildarþekja
1707753602977:t(df_with_heildarþekja)
1707753763012:t(df_with_heildarþekja)
1707753796220:df_with_heildarþekja
1707753833323:df_with_heildarþekja
1707754010976:for (i in unique(joined_data$Stadur)[16]) {
1707754011029:filtered_data <- joined_data %>%
1707754011049:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707754011066:select(where(~ !all(is.na(.))))
1707754011094:# Dynamically identify year columns that exist after filtering
1707754011116:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707754011133:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707754011151:joined_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707754011169:# Pivot longer only with existing year columns
1707754011187:jd_long <- filtered_data %>%
1707754011204:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707754011236:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707754011269:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707754011289:# Fjöldi tegunda í reit á ári
1707754011313:species_counts <- jd_long_Engin_NA %>%
1707754011341:group_by(Reitur, Year) %>%
1707754011374:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707754011400:# Meðalfjöldi tegunda í reit á ári
1707754011423:group_by(Year) %>%
1707754011445:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707754011461:mutate(Type = "Tegundafjöldi")|>
1707754011484:select(Type, Year, Mean, SE)
1707754011515:# Meðalþekja reita eftir Type
1707754011533:df <- jd_long_Engin_NA |>
1707754011549:group_by(Type,Year,Reitur) %>%
1707754011570:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707754011589:group_by(Type,Year) %>%
1707754011609:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707754011645:# heildarþekja (öll Type) allra reita innan ára
1707754011666:df_summary <- jd_long_Engin_NA |>
1707754011690:group_by(Year,Reitur) %>%
1707754011708:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707754011725:group_by(Year) %>%
1707754011745:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707754011763:mutate(Type = "Heildarþekja") |>
1707754011783:select(Type, Year, Mean, SE)
1707754011828:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707754011853:# Ensure Type is ordered as desired
1707754011874:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707754011907:# Plot
1707754011926:p1 <-
1707754011951:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707754011976:geom_bar(
1707754011997:stat = "identity",
1707754012020:color = "black",
1707754012037:size = .6,
1707754012057:position = position_dodge(width = 0.75)
1707754012077:) +
1707754012092:# geom_errorbar(
1707754012112:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707754012129:#   width = .2,
1707754012149:#   position = position_dodge(width = 0.75)
1707754012165:# ) +
1707754012186:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707754012203:scale_y_continuous(
1707754012222:labels = label_dollar(prefix = "", suffix = " \n%"),
1707754012240:# Example secondary axis (e.g., double the Mean for illustration)
1707754012262:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707754012289:) +
1707754012317:labs(title = "",
1707754012343:y = "Meðalþekja", x = "") +
1707754012366:scale_x_discrete(
1707754012395:"",
1707754012418:labels = c(
1707754012433:"Mosar" = "Mosar",
1707754012451:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707754012466:"Hrúðurfléttur" = "Hrúðurfléttur",
1707754012482:"Heildarþekja" = "Heildarþekja",
1707754012496:"Tegundafjöldi" = "Tegundafjöldi"
1707754012516:)
1707754012532:) +
1707754012551:theme_minimal() +
1707754012569:theme(legend.title = element_blank(),
1707754012598:plot.background = element_rect(fill = "white", color = NA)) +
1707754012617:annotate(
1707754012635:"text",
1707754012651:x = 2,
1707754012669:y = Inf,
1707754012683:label = i,
1707754012697:hjust = 1,
1707754012713:vjust = 1,
1707754012728:size = 8,
1707754012746:angle = 0
1707754012764:)
1707754012797:p1 <-
1707754012816:p1 + theme(
1707754012832:axis.title = element_text(size = 16),
1707754012855:# Increase axis titles
1707754012872:axis.text = element_text(size = 16),
1707754012893:# Increase axis text
1707754012921:legend.text = element_text(size = 16)
1707754012947:) # Increase legend text
1707754012984:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707754013008:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707754013057:}
1707754019880:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707754019897:geom_bar(
1707754019915:stat = "identity",
1707754019927:color = "black",
1707754019939:size = .6,
1707754019953:position = position_dodge(width = 0.75)
1707754019967:)
1707754034134:df_with_heildarþekja
1707754170039:####
1707754170069:###týndar tölur
1707754170089:joined_data$`2020`[joined_data$Reitur=="R65"]
1707754174644:joined_data <- data %>%
1707754174673:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707754174713:select(species, Type, Reitur, km, everything()) |>
1707754174738:#select(-c(`1999`)) |>
1707754174761:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707754174778:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707754174797:filter(!species %in% "Ber klöpp")
1707754177325:####
1707754177352:###týndar tölur
1707754177391:joined_data$`2020`[joined_data$Reitur=="R65"]
1707754186709:####
1707754186728:###týndar tölur
1707754186747:joined_data[joined_data$Reitur=="R65",]
1707754520530:df_with_heildarþekja
1707754537636:dput(df_with_heildarþekja)
1707754555834:df_with_heildarþekja[df_with_heildarþekja$Year]
1707754561891:df_with_heildarþekja[df_with_heildarþekja$Year==2020,]
1707754577148:df_with_heildarþekja[df_with_heildarþekja$Year==2020,3]
1707754589023:df_with_heildarþekja[df_with_heildarþekja$Year==2020,3] <- tyndar
1707754593422:tyndar <- c(2.87,
1707754593444:15.67,
1707754593461:30.70,
1707754593479:59.24,
1707754593491:8.67)
1707754596207:df_with_heildarþekja[df_with_heildarþekja$Year==2020,3] <- tyndar
1707754608415:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707754608443:geom_bar(
1707754608466:stat = "identity",
1707754608488:color = "black",
1707754608507:size = .6,
1707754608523:position = position_dodge(width = 0.75)
1707754608543:)
1707754668571:df_with_heildarþekja
1707754914402:tyndar
1707754967461:df_with_heildarþekja |>
1707754967487:mutate(Mean == case_when(
1707754967512:Year == 2020 & Type== "Mosar" ~ 2.87,.
1707754967536:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67
1707755042061:df_with_heildarþekja |>
1707755042094:mutate(Mean == case_when(
1707755042120:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755042195:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67
1707755042216:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70
1707755050215:df_with_heildarþekja |>
1707755050239:mutate(Mean == case_when(
1707755050259:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755050278:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707755050297:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707755050317:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707755050344:TRUE ~ 8.67
1707755050368:))
1707755114806:df_with_heildarþekja |>
1707755114838:mutate(Mean == case_when(
1707755114865:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755114885:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707755114901:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707755114920:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707755114939:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67
1707755114957:))
1707755186274:df_with_heildarþekja
1707755286881:df_with_heildarþekja |>
1707755286907:mutate(Mean == case_when(
1707755286930:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755286955:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707755286975:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707755286996:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707755287015:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67
1707755287046:))
1707755318397:df_with_heildarþekja |>
1707755318429:mutate(Mean = case_when(
1707755318456:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755318483:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707755318502:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707755318519:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707755318536:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67
1707755318553:))
1707755361907:df_with_heildarþekja |>
1707755361933:mutate(Mean = case_when(
1707755361955:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755361975:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707755362001:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707755362027:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707755362049:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707755362123:TRUE ~ Mean))
1707755369567:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755369593:geom_bar(
1707755369613:stat = "identity",
1707755369635:color = "black",
1707755369663:size = .6,
1707755369689:position = position_dodge(width = 0.75)
1707755369716:)
1707755385889:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707755389647:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755389684:geom_bar(
1707755389710:stat = "identity",
1707755389728:color = "black",
1707755389754:size = .6,
1707755389780:position = position_dodge(width = 0.75)
1707755389817:)
1707755450600:filtered_data <- joined_data %>%
1707755450624:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707755450648:select(where(~ !all(is.na(.))))
1707755450732:# Dynamically identify year columns that exist after filtering
1707755450757:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707755450775:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707755450799:joined_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755473952:filtered_data <- joined_data %>%
1707755473980:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707755474003:select(where(~ !all(is.na(.))))
1707755480552:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707755480577:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707755480598:joined_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755490387:joined_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755501552:filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755508948:filtered_data <- joined_data %>%
1707755508974:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707755508995:select(where(~ !all(is.na(.))))
1707755509071:# Dynamically identify year columns that exist after filtering
1707755509097:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707755509117:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707755509134:filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755509146:# Pivot longer only with existing year columns
1707755509160:jd_long <- filtered_data %>%
1707755509175:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707755509204:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707755509241:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707755509258:# Fjöldi tegunda í reit á ári
1707755509277:species_counts <- jd_long_Engin_NA %>%
1707755509294:group_by(Reitur, Year) %>%
1707755509314:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707755509331:# Meðalfjöldi tegunda í reit á ári
1707755509355:group_by(Year) %>%
1707755509377:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707755509399:mutate(Type = "Tegundafjöldi")|>
1707755509423:select(Type, Year, Mean, SE)
1707755509472:# Meðalþekja reita eftir Type
1707755509491:df <- jd_long_Engin_NA |>
1707755509512:group_by(Type,Year,Reitur) %>%
1707755509546:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707755509569:group_by(Type,Year) %>%
1707755509593:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707755509656:# heildarþekja (öll Type) allra reita innan ára
1707755509681:df_summary <- jd_long_Engin_NA |>
1707755509699:group_by(Year,Reitur) %>%
1707755509720:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707755509742:group_by(Year) %>%
1707755509761:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707755509784:mutate(Type = "Heildarþekja") |>
1707755509808:select(Type, Year, Mean, SE)
1707755509910:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707755515417:df_with_heildarþekja
1707755524155:# Ensure Type is ordered as desired
1707755524179:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707755528060:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755528083:geom_bar(
1707755528103:stat = "identity",
1707755528123:color = "black",
1707755528142:size = .6,
1707755528170:position = position_dodge(width = 0.75)
1707755528195:)
1707755543756:# tyndar
1707755543780:df_with_heildarþekja[df_with_heildarþekja$Year==2020,3] <- tyndar
1707755546482:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755546505:geom_bar(
1707755546535:stat = "identity",
1707755546569:color = "black",
1707755546587:size = .6,
1707755546608:position = position_dodge(width = 0.75)
1707755546627:)
1707755562780:tyndar <- c(2.87,
1707755562807:15.67,
1707755562825:30.70,
1707755562847:59.24,
1707755562862:8.67)
1707755572064:df_with_heildarþekja |>
1707755572089:mutate(Mean = case_when(
1707755572117:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755572146:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707755572169:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707755572192:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707755572212:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707755572232:TRUE ~ Mean))
1707755573959:# Ensure Type is ordered as desired
1707755573985:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707755575938:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755575967:geom_bar(
1707755575986:stat = "identity",
1707755576004:color = "black",
1707755576019:size = .6,
1707755576035:position = position_dodge(width = 0.75)
1707755576053:)
1707755590892:filtered_data <- joined_data %>%
1707755590918:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707755590950:select(where(~ !all(is.na(.))))
1707755591030:# Dynamically identify year columns that exist after filtering
1707755591048:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707755591064:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707755591083:filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755591102:# Pivot longer only with existing year columns
1707755591127:jd_long <- filtered_data %>%
1707755591146:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707755591187:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707755591227:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707755591247:# Fjöldi tegunda í reit á ári
1707755591266:species_counts <- jd_long_Engin_NA %>%
1707755591287:group_by(Reitur, Year) %>%
1707755591303:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707755591320:# Meðalfjöldi tegunda í reit á ári
1707755591335:group_by(Year) %>%
1707755591355:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707755591373:mutate(Type = "Tegundafjöldi")|>
1707755591395:select(Type, Year, Mean, SE)
1707755591449:# Meðalþekja reita eftir Type
1707755591476:df <- jd_long_Engin_NA |>
1707755591503:group_by(Type,Year,Reitur) %>%
1707755591520:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707755591538:group_by(Type,Year) %>%
1707755591552:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707755591593:# heildarþekja (öll Type) allra reita innan ára
1707755591613:df_summary <- jd_long_Engin_NA |>
1707755591627:group_by(Year,Reitur) %>%
1707755591644:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707755591658:group_by(Year) %>%
1707755591676:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707755591691:mutate(Type = "Heildarþekja") |>
1707755591706:select(Type, Year, Mean, SE)
1707755591781:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707755595236:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755595266:geom_bar(
1707755595292:stat = "identity",
1707755595313:color = "black",
1707755595330:size = .6,
1707755595347:position = position_dodge(width = 0.75)
1707755595362:)
1707755620624:joined_data <- data %>%
1707755620649:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707755620668:select(species, Type, Reitur, km, everything()) |>
1707755620685:#select(-c(`1999`)) |>
1707755620703:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707755620718:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707755620738:filter(!species %in% "Ber klöpp")
1707755630960:filtered_data <- joined_data %>%
1707755630981:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707755631002:select(where(~ !all(is.na(.))))
1707755631084:# Dynamically identify year columns that exist after filtering
1707755631099:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707755631127:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707755631149:filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755631169:# Pivot longer only with existing year columns
1707755631189:jd_long <- filtered_data %>%
1707755631206:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707755631245:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707755631286:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707755631311:# Fjöldi tegunda í reit á ári
1707755631341:species_counts <- jd_long_Engin_NA %>%
1707755631361:group_by(Reitur, Year) %>%
1707755631393:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707755631415:# Meðalfjöldi tegunda í reit á ári
1707755631432:group_by(Year) %>%
1707755631449:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707755631466:mutate(Type = "Tegundafjöldi")|>
1707755631483:select(Type, Year, Mean, SE)
1707755631528:# Meðalþekja reita eftir Type
1707755631545:df <- jd_long_Engin_NA |>
1707755631562:group_by(Type,Year,Reitur) %>%
1707755631580:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707755631602:group_by(Type,Year) %>%
1707755631624:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707755631674:# heildarþekja (öll Type) allra reita innan ára
1707755631695:df_summary <- jd_long_Engin_NA |>
1707755631709:group_by(Year,Reitur) %>%
1707755631725:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707755631742:group_by(Year) %>%
1707755631759:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707755631779:mutate(Type = "Heildarþekja") |>
1707755631797:select(Type, Year, Mean, SE)
1707755631858:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707755638582:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755638611:geom_bar(
1707755638639:stat = "identity",
1707755638666:color = "black",
1707755638687:size = .6,
1707755638706:position = position_dodge(width = 0.75)
1707755638723:)
1707755645597:# Ensure Type is ordered as desired
1707755645628:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707755647919:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755647941:geom_bar(
1707755647957:stat = "identity",
1707755647975:color = "black",
1707755647997:size = .6,
1707755648018:position = position_dodge(width = 0.75)
1707755648035:)
1707755673090:# tyndar
1707755673114:df_with_heildarþekja[df_with_heildarþekja$Year==2020,3] <- tyndar
1707755677962:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755677988:geom_bar(
1707755678014:stat = "identity",
1707755678035:color = "black",
1707755678058:size = .6,
1707755678084:position = position_dodge(width = 0.75)
1707755678108:)
1707755749511:filtered_data <- joined_data %>%
1707755749532:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707755749556:select(where(~ !all(is.na(.))))
1707755749633:# Dynamically identify year columns that exist after filtering
1707755749677:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707755749709:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707755749729:filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707755749755:# Pivot longer only with existing year columns
1707755749780:jd_long <- filtered_data %>%
1707755749813:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707755749871:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707755749908:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707755749925:# Fjöldi tegunda í reit á ári
1707755749943:species_counts <- jd_long_Engin_NA %>%
1707755749960:group_by(Reitur, Year) %>%
1707755749978:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707755749997:# Meðalfjöldi tegunda í reit á ári
1707755750015:group_by(Year) %>%
1707755750030:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707755750046:mutate(Type = "Tegundafjöldi")|>
1707755750063:select(Type, Year, Mean, SE)
1707755750115:# Meðalþekja reita eftir Type
1707755750133:df <- jd_long_Engin_NA |>
1707755750152:group_by(Type,Year,Reitur) %>%
1707755750173:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707755750190:group_by(Type,Year) %>%
1707755750211:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707755750254:# heildarþekja (öll Type) allra reita innan ára
1707755750273:df_summary <- jd_long_Engin_NA |>
1707755750292:group_by(Year,Reitur) %>%
1707755750311:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707755750332:group_by(Year) %>%
1707755750355:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707755750376:mutate(Type = "Heildarþekja") |>
1707755750398:select(Type, Year, Mean, SE)
1707755750476:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707755755775:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755755802:geom_bar(
1707755755824:stat = "identity",
1707755755851:color = "black",
1707755755883:size = .6,
1707755755901:position = position_dodge(width = 0.75)
1707755755918:)
1707755767347:# Ensure Type is ordered as desired
1707755767370:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707755770945:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755770963:geom_bar(
1707755770982:stat = "identity",
1707755770996:color = "black",
1707755771012:size = .6,
1707755771025:position = position_dodge(width = 0.75)
1707755771041:)
1707755840756:df_with_heildarþekja  <- df_with_heildarþekja |>
1707755840789:mutate(Mean = case_when(
1707755840815:Year == 2020 & Type== "Mosar" ~ 2.87,
1707755840840:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707755840863:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707755840887:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707755840905:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707755840924:TRUE ~ Mean))
1707755845624:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707755845649:geom_bar(
1707755845669:stat = "identity",
1707755845687:color = "black",
1707755845704:size = .6,
1707755845720:position = position_dodge(width = 0.75)
1707755845744:)
1707756010240:df_with_heildarþekja
1707756127728:joined_data[joined_data$Stadur=="Kalastaðakot",]
1707756151063:joined_data[joined_data$Stadur=="Kalastaðakot",  joined_data$`2017`]
1707756167501:joined_data[joined_data$Stadur=="Kalastaðakot",10]
1707756182579:joined_data[joined_data$Stadur=="Kalastaðakot",]
1707756246111:joined_data[joined_data$Stadur=="Kalastaðakot" & joined_data=="Blað- og runnfléttur",]
1707756255766:joined_data[joined_data$Stadur=="Kalastaðakot" & joined_data$Type=="Blað- og runnfléttur",]
1707756333530:colMeans(joined_data[joined_data$Stadur=="Kalastaðakot" & joined_data$Type=="Blað- og runnfléttur",])
1707756356849:colMeans(joined_data[joined_data$Stadur=="Kalastaðakot" & joined_data$Type=="Blað- og runnfléttur",year_columns])
1707756363561:colMeans(joined_data[joined_data$Stadur=="Kalastaðakot" & joined_data$Type=="Blað- og runnfléttur",year_columns],na.rm = T)
1707756525795:filtered_data <- joined_data %>%
1707756525828:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707756525868:select(where(~ !all(is.na(.))))
1707756544631:# Dynamically identify year columns that exist after filtering
1707756544664:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707756545765:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707756567370:filtered_data
1707756593442:#filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707756593468:# Pivot longer only with existing year columns
1707756593490:jd_long <- filtered_data %>%
1707756593507:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707756598281:jd_long
1707756673273:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707756675697:jd_long_Engin_NA
1707756716233:table(jd_long_Engin_NA$Type)
1707756741148:table(jd_long_Engin_NA$species)
1707756783850:jd_long_Engin_NA %>%
1707756783872:group_by(Reitur, Year) %>%
1707756783889:summarise(SpeciesCount = n_distinct(species), .groups = 'drop')
1707756838119:jd_long_Engin_NA %>%
1707756838142:group_by(Reitur, Year) %>%
1707756838165:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707756838186:# Meðalfjöldi tegunda í reit á ári
1707756838207:group_by(Year) %>%
1707756838225:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707756838253:mutate(Type = "Tegundafjöldi")|>
1707756838277:select(Type, Year, Mean, SE)
1707756852941:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707756852970:# Fjöldi tegunda í reit á ári
1707756853005:species_counts <- jd_long_Engin_NA %>%
1707756853032:group_by(Reitur, Year) %>%
1707756853053:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707756853072:# Meðalfjöldi tegunda í reit á ári
1707756853088:group_by(Year) %>%
1707756853102:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707756853116:mutate(Type = "Tegundafjöldi")|>
1707756853133:select(Type, Year, Mean, SE)
1707756859857:species_counts
1707756880163:jd_long_Engin_NA
1707756897653:jd_long_Engin_NA |>
1707756897675:group_by(Type,Year,Reitur) %>%
1707756897699:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop')
1707757015093:jd_long_Engin_NA |>
1707757015115:group_by(Type,Year,Reitur) %>%
1707757015137:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757015155:group_by(Type,Year) %>%
1707757015172:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757157152:jd_long_Engin_NA |>
1707757157175:group_by(Type,Year,Reitur) %>%
1707757157195:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757157212:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757157228:summarise(Mean=Summa/unique(Reitur) ,SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757198759:length(unique(Reitur))
1707757209560:jd_long_Engin_NA |>
1707757209583:group_by(Type,Year,Reitur) %>%
1707757209604:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757209633:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757209654:summarise(Mean=Summa/length(unique(Reitur)) ,SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757228952:# Meðalþekja reita eftir Type
1707757228979:df <- jd_long_Engin_NA |>
1707757228998:group_by(Type,Year,Reitur) %>%
1707757229016:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757229035:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757229057:summarise(Mean=Summa/length(unique(Reitur)) ,SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757230704:# heildarþekja (öll Type) allra reita innan ára
1707757230733:df_summary <- jd_long_Engin_NA |>
1707757230758:group_by(Year,Reitur) %>%
1707757230779:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707757230804:group_by(Year) %>%
1707757230841:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707757230866:mutate(Type = "Heildarþekja") |>
1707757230891:select(Type, Year, Mean, SE)
1707757231846:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707757243763:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707757243791:geom_bar(
1707757243817:stat = "identity",
1707757243837:color = "black",
1707757243860:size = .6,
1707757243881:position = position_dodge(width = 0.75)
1707757243900:)
1707757300348:length(unique(Reitur)
1707757304902:length(unique(Reitur))
1707757314019:length(unique(joined_data$Reitur))
1707757322004:length(unique(jd_long_Engin_NA$Reitur))
1707757340457:# Meðalþekja reita eftir Type
1707757340483:df <- jd_long_Engin_NA |>
1707757340504:group_by(Type,Year,Reitur) %>%
1707757340523:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757340539:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757340558:summarise(Mean=Summa/3 ,SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757340957:# heildarþekja (öll Type) allra reita innan ára
1707757340977:df_summary <- jd_long_Engin_NA |>
1707757340991:group_by(Year,Reitur) %>%
1707757341004:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707757341015:group_by(Year) %>%
1707757341029:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707757341043:mutate(Type = "Heildarþekja") |>
1707757341055:select(Type, Year, Mean, SE)
1707757344148:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707757348096:# Ensure Type is ordered as desired
1707757348126:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707757352910:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707757352935:geom_bar(
1707757352958:stat = "identity",
1707757352983:color = "black",
1707757353004:size = .6,
1707757353022:position = position_dodge(width = 0.75)
1707757353040:) +
1707757353061:#
1707757361823:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707757361843:geom_bar(
1707757361862:stat = "identity",
1707757361882:color = "black",
1707757361898:size = .6,
1707757361917:position = position_dodge(width = 0.75)
1707757361933:)
1707757414388:df_with_heildarþekja  <- df_with_heildarþekja |>
1707757414417:mutate(Mean = case_when(
1707757414450:Year == 2020 & Type== "Mosar" ~ 2.87,
1707757414471:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707757414491:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707757414509:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707757414527:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707757414547:TRUE ~ Mean))
1707757418353:# Ensure Type is ordered as desired
1707757418378:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707757422179:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707757422202:geom_bar(
1707757422223:stat = "identity",
1707757422246:color = "black",
1707757422263:size = .6,
1707757422292:position = position_dodge(width = 0.75)
1707757422321:)
1707757468285:df_with_heildarþekja
1707757476492:df_with_heildarþekja
1707757518575:i
1707757526762:joined_data <- data %>%
1707757526792:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707757526813:select(species, Type, Reitur, km, everything()) |>
1707757526835:#select(-c(`1999`)) |>
1707757526858:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707757526877:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707757526894:filter(!species %in% "Ber klöpp")
1707757544083:filtered_data <- joined_data %>%
1707757544118:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707757544143:select(where(~ !all(is.na(.))))
1707757545616:# Dynamically identify year columns that exist after filtering
1707757545646:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707757546114:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707757547427:#filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707757547457:# Pivot longer only with existing year columns
1707757547482:jd_long <- filtered_data %>%
1707757547506:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707757551105:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707757552623:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707757552651:# Fjöldi tegunda í reit á ári
1707757552675:species_counts <- jd_long_Engin_NA %>%
1707757552697:group_by(Reitur, Year) %>%
1707757552718:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707757552742:# Meðalfjöldi tegunda í reit á ári
1707757552764:group_by(Year) %>%
1707757552786:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707757552804:mutate(Type = "Tegundafjöldi")|>
1707757552821:select(Type, Year, Mean, SE)
1707757553757:# Meðalþekja reita eftir Type
1707757553786:df <- jd_long_Engin_NA |>
1707757553817:group_by(Type,Year,Reitur) %>%
1707757553844:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757553873:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757553891:summarise(Mean=Summa/3 ,SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757555487:# heildarþekja (öll Type) allra reita innan ára
1707757555519:df_summary <- jd_long_Engin_NA |>
1707757555546:group_by(Year,Reitur) %>%
1707757555566:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707757555582:group_by(Year) %>%
1707757555594:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707757555617:mutate(Type = "Heildarþekja") |>
1707757555635:select(Type, Year, Mean, SE)
1707757556092:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707757562553:df_with_heildarþekja  <- df_with_heildarþekja |>
1707757562573:mutate(Mean = case_when(
1707757562592:Year == 2020 & Type== "Mosar" ~ 2.87,
1707757562608:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707757562623:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707757562638:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707757562651:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707757562671:TRUE ~ Mean))
1707757564498:# Ensure Type is ordered as desired
1707757564531:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707757569069:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707757569094:geom_bar(
1707757569112:stat = "identity",
1707757569133:color = "black",
1707757569151:size = .6,
1707757569169:position = position_dodge(width = 0.75)
1707757569183:)
1707757580621:df_with_heildarþekja
1707757639265:print(df_with_heildarþekja, n=100)
1707757732344:existing_year_columns
1707757751966:jd_long_Engin_NA |>
1707757751999:group_by(Type,Year,Reitur) %>%
1707757752024:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757752047:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757752067:summarise(Mean=Summa/3 ,SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757794939:jd_long_Engin_NA |>
1707757794963:group_by(Type,Year,Reitur) %>%
1707757794987:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757795006:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757795022:summarise(Mean=Summa/3 ,SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707757829023:jd_long_Engin_NA |>
1707757829048:group_by(Type,Year,Reitur) %>%
1707757829069:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707757829087:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707757829108:summarise(Mean=Summa/3 , .groups = 'drop')
1707757903255:search()
1707758014977:jd_long |>
1707758015002:group_by(Type,Year,Reitur) %>%
1707758015028:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707758015047:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707758015064:summarise(Mean=mean(Summa, na.rm=TRUE), .groups = 'drop')
1707758091803:# heildarþekja (öll Type) allra reita innan ára
1707758091828:df_summary <- jd_long_Engin_NA |>
1707758091849:group_by(Year,Reitur) %>%
1707758091867:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707758091883:group_by(Year) %>%
1707758091901:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707758091922:mutate(Type = "Heildarþekja") |>
1707758091954:select(Type, Year, Mean, SE)
1707758092026:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707758098420:df_with_heildarþekja  <- df_with_heildarþekja |>
1707758098447:mutate(Mean = case_when(
1707758098477:Year == 2020 & Type== "Mosar" ~ 2.87,
1707758098495:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707758098516:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707758098532:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707758098556:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707758098583:TRUE ~ Mean))
1707758101104:# Ensure Type is ordered as desired
1707758101135:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707758105425:# Plot
1707758105458:p1 <-
1707758105484:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707758105509:geom_bar(
1707758105532:stat = "identity",
1707758105549:color = "black",
1707758105564:size = .6,
1707758105579:position = position_dodge(width = 0.75)
1707758105595:) +
1707758105608:# geom_errorbar(
1707758105625:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707758105638:#   width = .2,
1707758105653:#   position = position_dodge(width = 0.75)
1707758105667:# ) +
1707758105680:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707758105695:scale_y_continuous(
1707758105710:labels = label_dollar(prefix = "", suffix = " \n%"),
1707758105728:# Example secondary axis (e.g., double the Mean for illustration)
1707758105747:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707758105766:) +
1707758105784:labs(title = "",
1707758105804:y = "Meðalþekja", x = "") +
1707758105822:scale_x_discrete(
1707758105851:"",
1707758105876:labels = c(
1707758105903:"Mosar" = "Mosar",
1707758105929:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707758105957:"Hrúðurfléttur" = "Hrúðurfléttur",
1707758105982:"Heildarþekja" = "Heildarþekja",
1707758106000:"Tegundafjöldi" = "Tegundafjöldi"
1707758106017:)
1707758106034:) +
1707758106052:theme_minimal() +
1707758106066:theme(legend.title = element_blank(),
1707758106083:plot.background = element_rect(fill = "white", color = NA)) +
1707758106106:annotate(
1707758106122:"text",
1707758106137:x = 2,
1707758106158:y = Inf,
1707758106179:label = i,
1707758106195:hjust = 1,
1707758106209:vjust = 1,
1707758106224:size = 8,
1707758106240:angle = 0
1707758106257:)
1707758125887:# Plot
1707758125915:p1 <-
1707758125938:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707758125955:geom_bar(
1707758125971:stat = "identity",
1707758125988:color = "black",
1707758126006:size = .6,
1707758126020:position = position_dodge(width = 0.75)
1707758126038:) +
1707758126055:# geom_errorbar(
1707758126075:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707758126098:#   width = .2,
1707758126123:#   position = position_dodge(width = 0.75)
1707758126143:# ) +
1707758126159:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707758126179:scale_y_continuous(
1707758126196:labels = label_dollar(prefix = "", suffix = " \n%"),
1707758126216:# Example secondary axis (e.g., double the Mean for illustration)
1707758126233:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707758126252:) +
1707758126270:labs(title = "",
1707758126293:y = "Meðalþekja", x = "") +
1707758126312:scale_x_discrete(
1707758126331:"",
1707758126350:labels = c(
1707758126370:"Mosar" = "Mosar",
1707758126396:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707758126428:"Hrúðurfléttur" = "Hrúðurfléttur",
1707758126455:"Heildarþekja" = "Heildarþekja",
1707758126477:"Tegundafjöldi" = "Tegundafjöldi"
1707758126500:)
1707758126522:) +
1707758126541:theme_minimal() +
1707758126560:theme(legend.title = element_blank(),
1707758126577:plot.background = element_rect(fill = "white", color = NA)) +
1707758126594:annotate(
1707758126610:"text",
1707758126630:x = 2,
1707758126647:y = Inf,
1707758126668:label = i,
1707758126682:hjust = 1,
1707758126701:vjust = 1,
1707758126720:size = 8,
1707758126740:angle = 0
1707758126756:)
1707758169230:df
1707758184159:jd_long |>
1707758184181:group_by(Type,Year,Reitur) %>%
1707758184203:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707758184232:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707758184253:summarise(Mean=mean(Summa, na.rm=TRUE), .groups = 'drop')
1707758191313:df <- jd_long |>
1707758191340:group_by(Type,Year,Reitur) %>%
1707758191362:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707758191388:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707758191413:summarise(Mean=mean(Summa, na.rm=TRUE), .groups = 'drop')
1707758196138:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707758200444:df_with_heildarþekja  <- df_with_heildarþekja |>
1707758200468:mutate(Mean = case_when(
1707758200486:Year == 2020 & Type== "Mosar" ~ 2.87,
1707758200501:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707758200526:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707758200546:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707758200564:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707758200587:TRUE ~ Mean))
1707758201942:# Ensure Type is ordered as desired
1707758201970:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707758205722:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707758205745:geom_bar(
1707758205763:stat = "identity",
1707758205782:color = "black",
1707758205801:size = .6,
1707758205819:position = position_dodge(width = 0.75)
1707758205845:)
1707758264301:# heildarþekja (öll Type) allra reita innan ára
1707758264334:df_summary <- jd_long |>
1707758264366:group_by(Year,Reitur) %>%
1707758264397:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707758264421:group_by(Year) %>%
1707758264440:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707758264454:mutate(Type = "Heildarþekja") |>
1707758264471:select(Type, Year, Mean, SE)
1707758269710:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707758274691:df_with_heildarþekja  <- df_with_heildarþekja |>
1707758274725:mutate(Mean = case_when(
1707758274748:Year == 2020 & Type== "Mosar" ~ 2.87,
1707758274781:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707758274818:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707758274835:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707758274852:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707758274869:TRUE ~ Mean))
1707758276484:# Ensure Type is ordered as desired
1707758276512:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707758280243:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707758280264:geom_bar(
1707758280284:stat = "identity",
1707758280307:color = "black",
1707758280331:size = .6,
1707758280356:position = position_dodge(width = 0.75)
1707758280381:)
1707758290334:df_with_heildarþekja
1707758500538:filtered_data <- joined_data %>%
1707758500561:#filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707758500583:select(where(~ !all(is.na(.))))
1707758500619:# Dynamically identify year columns that exist after filtering
1707758500637:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707758500657:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707758500677:#filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707758500704:# Pivot longer only with existing year columns
1707758500732:jd_long <- filtered_data %>%
1707758500755:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707758500799:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707758500855:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707758500881:# Fjöldi tegunda í reit á ári
1707758500908:species_counts <- jd_long_Engin_NA %>%
1707758500930:group_by(Reitur, Year) %>%
1707758500953:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707758500970:# Meðalfjöldi tegunda í reit á ári
1707758500986:group_by(Year) %>%
1707758501003:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707758501018:mutate(Type = "Tegundafjöldi")|>
1707758501037:select(Type, Year, Mean, SE)
1707758501097:# Meðalþekja reita eftir Type
1707758501117:df <- jd_long |>
1707758501132:group_by(Type,Year,Reitur) %>%
1707758501153:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707758501167:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707758501186:summarise(Mean=mean(Summa, na.rm=TRUE), .groups = 'drop')
1707758501258:# heildarþekja (öll Type) allra reita innan ára
1707758501272:df_summary <- jd_long |>
1707758501293:group_by(Year,Reitur) %>%
1707758501309:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707758501330:group_by(Year) %>%
1707758501366:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707758501394:mutate(Type = "Heildarþekja") |>
1707758501418:select(Type, Year, Mean, SE)
1707758501491:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707758504780:df_with_heildarþekja  <- df_with_heildarþekja |>
1707758504813:mutate(Mean = case_when(
1707758504839:Year == 2020 & Type== "Mosar" ~ 2.87,
1707758504858:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707758504877:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707758504893:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707758504906:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707758504922:TRUE ~ Mean))
1707758510007:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707758510029:geom_bar(
1707758510048:stat = "identity",
1707758510066:color = "black",
1707758510084:size = .6,
1707758510106:position = position_dodge(width = 0.75)
1707758510119:)
1707758571567:# Ensure Type is ordered as desired
1707758571591:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707758575172:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707758575204:geom_bar(
1707758575233:stat = "identity",
1707758575273:color = "black",
1707758575319:size = .6,
1707758575334:position = position_dodge(width = 0.75)
1707758575355:)
1707758656396:filtered_data <- joined_data %>%
1707758656426:filter(Stadur %in% i ) |>  #& !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707758656455:select(where(~ !all(is.na(.))))
1707758665089:# Dynamically identify year columns that exist after filtering
1707758665117:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707758665142:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707758665175:#filtered_data$`2020` <- rowMeans(filtered_data[,existing_year_columns],na.rm = T)
1707758665203:# Pivot longer only with existing year columns
1707758665218:jd_long <- filtered_data %>%
1707758665236:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707758665271:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707758665300:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707758665318:# Fjöldi tegunda í reit á ári
1707758665338:species_counts <- jd_long_Engin_NA %>%
1707758665358:group_by(Reitur, Year) %>%
1707758665383:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707758665405:# Meðalfjöldi tegunda í reit á ári
1707758665428:group_by(Year) %>%
1707758665448:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707758665472:mutate(Type = "Tegundafjöldi")|>
1707758665503:select(Type, Year, Mean, SE)
1707758665562:# Meðalþekja reita eftir Type
1707758665581:df <- jd_long |>
1707758665602:group_by(Type,Year,Reitur) %>%
1707758665619:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707758665637:group_by(Type,Year) %>% #Passa ef það dettu út ár
1707758665654:summarise(Mean=mean(Summa, na.rm=TRUE), .groups = 'drop')
1707758665695:# heildarþekja (öll Type) allra reita innan ára
1707758665716:df_summary <- jd_long |>
1707758665731:group_by(Year,Reitur) %>%
1707758665751:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707758665770:group_by(Year) %>%
1707758665794:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707758665820:mutate(Type = "Heildarþekja") |>
1707758665843:select(Type, Year, Mean, SE)
1707758665926:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707758669175:df_with_heildarþekja  <- df_with_heildarþekja |>
1707758669198:mutate(Mean = case_when(
1707758669221:Year == 2020 & Type== "Mosar" ~ 2.87,
1707758669237:Year == 2020 & Type== "Blað- og runnfléttur" ~ 15.67,
1707758669262:Year == 2020 & Type== "Hrúðurfléttur"~ 30.70,
1707758669287:Year == 2020 & Type== "Heildarþekja" ~ 59.24,
1707758669304:Year == 2020 & Type== "Tegundafjöldi" ~ 8.67,
1707758669326:TRUE ~ Mean))
1707758671060:# Ensure Type is ordered as desired
1707758671086:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707758675655:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707758675680:geom_bar(
1707758675696:stat = "identity",
1707758675718:color = "black",
1707758675735:size = .6,
1707758675762:position = position_dodge(width = 0.75)
1707758675786:)
1707816443228:unique(joined_data$Stadur)[1:4]
1707816450337:unique(joined_data$Stadur)[1:5]
1707816474312:Filename
1707816516737:glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816544399:glue("/myndir" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816550696:glue("/myndir/" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816559513:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707816597520:p1 <-
1707816597538:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707816597554:geom_bar(
1707816597568:stat = "identity",
1707816597582:color = "black",
1707816597596:size = .6,
1707816597612:position = position_dodge(width = 0.75)
1707816597627:)
1707816602608:Filename <-  glue(i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816603365:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707816628760:list.dirs()
1707816665146:Filename <-  glue("/myndir/" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816665817:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707816690585:Filename <-  glue("./myndir/" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816691081:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707816712449:library(tidyverse)
1707816712467:library(glue)
1707816712486:library(scales)
1707816712510:colors_dark2 <- brewer.pal(8, "Accent")
1707816712525:KM <- read.csv("gogn/coverkm.csv", check.names = F)
1707816712563:KM <-  KM[,-c(7:9)]
1707816712582:data <- read.csv("gogn/hreinsad.csv", check.names = F)
1707816712629:joined_data <- data %>%
1707816712640:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707816712651:select(species, Type, Reitur, km, everything()) |>
1707816712662:#select(-c(`1999`)) |>
1707816712673:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707816712684:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707816712695:filter(!species %in% "Ber klöpp")
1707816719017:for (i in unique(joined_data$Stadur)[1:5]) {
1707816719053:filtered_data <- joined_data %>%
1707816719067:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707816719082:select(where(~ !all(is.na(.))))
1707816719107:# Dynamically identify year columns that exist after filtering
1707816719121:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707816719134:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707816719159:# Pivot longer only with existing year columns
1707816719173:jd_long <- filtered_data %>%
1707816719188:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707816719212:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707816719236:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707816719250:# Fjöldi tegunda í reit á ári
1707816719264:species_counts <- jd_long_Engin_NA %>%
1707816719277:group_by(Reitur, Year) %>%
1707816719291:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707816719306:# Meðalfjöldi tegunda í reit á ári
1707816719319:group_by(Year) %>%
1707816719334:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707816719349:mutate(Type = "Tegundafjöldi")|>
1707816719363:select(Type, Year, Mean, SE)
1707816719387:# Meðalþekja reita eftir Type
1707816719403:df <- jd_long_Engin_NA |>
1707816719419:group_by(Type,Year,Reitur) %>%
1707816719435:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707816719451:group_by(Type,Year) %>%
1707816719463:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707816719487:# heildarþekja (öll Type) allra reita innan ára
1707816719501:df_summary <- jd_long_Engin_NA |>
1707816719517:group_by(Year,Reitur) %>%
1707816719530:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707816719544:group_by(Year) %>%
1707816719560:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707816719574:mutate(Type = "Heildarþekja") |>
1707816719587:select(Type, Year, Mean, SE)
1707816719626:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707816719642:# Ensure Type is ordered as desired
1707816719655:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707816719680:# Plot
1707816719693:p1 <-
1707816719708:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707816719722:geom_bar(
1707816719738:stat = "identity",
1707816719757:color = "black",
1707816719774:size = .6,
1707816719789:position = position_dodge(width = 0.75)
1707816719805:) +
1707816719822:# geom_errorbar(
1707816719837:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707816719853:#   width = .2,
1707816719868:#   position = position_dodge(width = 0.75)
1707816719882:# ) +
1707816719897:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707816719913:scale_y_continuous(
1707816719926:labels = label_dollar(prefix = "", suffix = " \n%"),
1707816719942:# Example secondary axis (e.g., double the Mean for illustration)
1707816719957:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707816719973:) +
1707816719987:labs(title = "",
1707816720001:y = "Meðalþekja", x = "") +
1707816720018:scale_x_discrete(
1707816720042:"",
1707816720060:labels = c(
1707816720075:"Mosar" = "Mosar",
1707816720091:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707816720108:"Hrúðurfléttur" = "Hrúðurfléttur",
1707816720122:"Heildarþekja" = "Heildarþekja",
1707816720136:"Tegundafjöldi" = "Tegundafjöldi"
1707816720150:)
1707816720164:) +
1707816720178:theme_minimal() +
1707816720194:theme(legend.title = element_blank(),
1707816720208:plot.background = element_rect(fill = "white", color = NA)) +
1707816720223:annotate(
1707816720237:"text",
1707816720251:x = 2,
1707816720265:y = Inf,
1707816720279:label = i,
1707816720295:hjust = 1,
1707816720310:vjust = 1,
1707816720324:size = 8,
1707816720338:angle = 0
1707816720353:)
1707816720379:p1 <-
1707816720394:p1 + theme(
1707816720408:axis.title = element_text(size = 16),
1707816720423:# Increase axis titles
1707816720443:axis.text = element_text(size = 16),
1707816720459:# Increase axis text
1707816720475:legend.text = element_text(size = 16)
1707816720488:) # Increase legend text
1707816720515:Filename <-  glue("./myndir/" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816720534:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707816720581:}
1707816783948:for (i in unique(joined_data$Stadur)[1:5]) {
1707816783979:filtered_data <- joined_data %>%
1707816783992:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707816784007:select(where(~ !all(is.na(.))))
1707816784032:# Dynamically identify year columns that exist after filtering
1707816784047:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707816784062:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707816784086:# Pivot longer only with existing year columns
1707816784100:jd_long <- filtered_data %>%
1707816784116:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707816784138:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707816784162:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707816784177:# Fjöldi tegunda í reit á ári
1707816784191:species_counts <- jd_long_Engin_NA %>%
1707816784205:group_by(Reitur, Year) %>%
1707816784220:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707816784233:# Meðalfjöldi tegunda í reit á ári
1707816784244:group_by(Year) %>%
1707816784258:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707816784272:mutate(Type = "Tegundafjöldi")|>
1707816784287:select(Type, Year, Mean, SE)
1707816784313:# Meðalþekja reita eftir Type
1707816784328:df <- jd_long_Engin_NA |>
1707816784341:group_by(Type,Year,Reitur) %>%
1707816784358:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707816784372:group_by(Type,Year) %>%
1707816784387:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707816784411:# heildarþekja (öll Type) allra reita innan ára
1707816784425:df_summary <- jd_long_Engin_NA |>
1707816784438:group_by(Year,Reitur) %>%
1707816784452:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707816784467:group_by(Year) %>%
1707816784482:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707816784497:mutate(Type = "Heildarþekja") |>
1707816784512:select(Type, Year, Mean, SE)
1707816784550:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707816784566:# Ensure Type is ordered as desired
1707816784581:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707816784604:# Plot
1707816784618:p1 <-
1707816784631:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707816784646:geom_bar(
1707816784661:stat = "identity",
1707816784674:color = "black",
1707816784687:size = .6,
1707816784700:position = position_dodge(width = 0.75)
1707816784713:) +
1707816784725:# geom_errorbar(
1707816784740:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707816784753:#   width = .2,
1707816784766:#   position = position_dodge(width = 0.75)
1707816784781:# ) +
1707816784797:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707816784810:scale_y_continuous(
1707816784823:labels = label_dollar(prefix = "", suffix = " \n%"),
1707816784836:# Example secondary axis (e.g., double the Mean for illustration)
1707816784851:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707816784866:) +
1707816784882:labs(title = "",
1707816784896:y = "Meðalþekja", x = "") +
1707816784909:scale_x_discrete(
1707816784924:"",
1707816784939:labels = c(
1707816784954:"Mosar" = "Mosar",
1707816784968:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707816784982:"Hrúðurfléttur" = "Hrúðurfléttur",
1707816784999:"Heildarþekja" = "Heildarþekja",
1707816785014:"Tegundafjöldi" = "Tegundafjöldi"
1707816785029:)
1707816785045:) +
1707816785061:theme_minimal() +
1707816785075:theme(legend.title = element_blank(),
1707816785091:plot.background = element_rect(fill = "white", color = NA)) +
1707816785105:annotate(
1707816785121:"text",
1707816785135:x = 2,
1707816785149:y = Inf,
1707816785165:label = i,
1707816785180:hjust = 1,
1707816785195:vjust = 1,
1707816785209:size = 8,
1707816785228:angle = 0
1707816785243:)
1707816785268:p1 <-
1707816785282:p1 + theme(
1707816785297:axis.title = element_text(size = 16),
1707816785313:# Increase axis titles
1707816785327:axis.text = element_text(size = 16),
1707816785343:# Increase axis text
1707816785358:legend.text = element_text(size = 16)
1707816785373:) # Increase legend text
1707816785399:Filename <-  glue("./myndir/", "A" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816785413:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707816785453:}
1707816821194:for (i in unique(joined_data$Stadur)[1:5]) {
1707816821227:filtered_data <- joined_data %>%
1707816821239:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707816821253:select(where(~ !all(is.na(.))))
1707816821274:# Dynamically identify year columns that exist after filtering
1707816821285:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707816821296:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707816821315:# Pivot longer only with existing year columns
1707816821327:jd_long <- filtered_data %>%
1707816821341:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707816821366:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707816821390:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707816821404:# Fjöldi tegunda í reit á ári
1707816821418:species_counts <- jd_long_Engin_NA %>%
1707816821432:group_by(Reitur, Year) %>%
1707816821447:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707816821461:# Meðalfjöldi tegunda í reit á ári
1707816821478:group_by(Year) %>%
1707816821491:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707816821507:mutate(Type = "Tegundafjöldi")|>
1707816821521:select(Type, Year, Mean, SE)
1707816821546:# Meðalþekja reita eftir Type
1707816821559:df <- jd_long |>
1707816821573:group_by(Type,Year,Reitur) %>%
1707816821589:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707816821605:group_by(Type,Year) %>%
1707816821620:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707816821649:# heildarþekja (öll Type) allra reita innan ára
1707816821665:df_summary <- jd_long |>
1707816821680:group_by(Year,Reitur) %>%
1707816821693:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707816821706:group_by(Year) %>%
1707816821720:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707816821734:mutate(Type = "Heildarþekja") |>
1707816821747:select(Type, Year, Mean, SE)
1707816821782:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707816821796:# Ensure Type is ordered as desired
1707816821811:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707816821838:# Plot
1707816821852:p1 <-
1707816821868:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707816821881:geom_bar(
1707816821895:stat = "identity",
1707816821909:color = "black",
1707816821923:size = .6,
1707816821938:position = position_dodge(width = 0.75)
1707816821953:) +
1707816821968:# geom_errorbar(
1707816821984:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707816821999:#   width = .2,
1707816822019:#   position = position_dodge(width = 0.75)
1707816822036:# ) +
1707816822051:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707816822069:scale_y_continuous(
1707816822084:labels = label_dollar(prefix = "", suffix = " \n%"),
1707816822099:# Example secondary axis (e.g., double the Mean for illustration)
1707816822114:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707816822129:) +
1707816822143:labs(title = "",
1707816822156:y = "Meðalþekja", x = "") +
1707816822170:scale_x_discrete(
1707816822184:"",
1707816822200:labels = c(
1707816822214:"Mosar" = "Mosar",
1707816822228:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707816822242:"Hrúðurfléttur" = "Hrúðurfléttur",
1707816822256:"Heildarþekja" = "Heildarþekja",
1707816822273:"Tegundafjöldi" = "Tegundafjöldi"
1707816822288:)
1707816822304:) +
1707816822317:theme_minimal() +
1707816822331:theme(legend.title = element_blank(),
1707816822345:plot.background = element_rect(fill = "white", color = NA)) +
1707816822358:annotate(
1707816822370:"text",
1707816822385:x = 2,
1707816822405:y = Inf,
1707816822421:label = i,
1707816822436:hjust = 1,
1707816822450:vjust = 1,
1707816822464:size = 8,
1707816822477:angle = 0
1707816822489:)
1707816822509:p1 <-
1707816822520:p1 + theme(
1707816822531:axis.title = element_text(size = 16),
1707816822542:# Increase axis titles
1707816822553:axis.text = element_text(size = 16),
1707816822564:# Increase axis text
1707816822574:legend.text = element_text(size = 16)
1707816822587:) # Increase legend text
1707816822606:Filename <-  glue("./myndir/", "B" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707816822618:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707816822646:}
1707817025909:for (i in unique(joined_data$Stadur)[1:5]) {
1707817025947:filtered_data <- joined_data %>%
1707817025964:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817025979:select(where(~ !all(is.na(.))))
1707817026003:# Dynamically identify year columns that exist after filtering
1707817026020:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817026034:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817026060:# Pivot longer only with existing year columns
1707817026076:jd_long <- filtered_data %>%
1707817026091:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817026117:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817026143:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817026157:# Fjöldi tegunda í reit á ári
1707817026172:species_counts <- jd_long_Engin_NA %>%
1707817026187:group_by(Reitur, Year) %>%
1707817026201:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817026215:# Meðalfjöldi tegunda í reit á ári
1707817026229:group_by(Year) %>%
1707817026244:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817026259:mutate(Type = "Tegundafjöldi")|>
1707817026274:select(Type, Year, Mean, SE)
1707817026300:# Meðalþekja reita eftir Type
1707817026315:df <- jd_long_Engin_NA |>
1707817026331:group_by(Type,Year,Reitur) %>%
1707817026347:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817026362:group_by(Type,Year) %>%
1707817026377:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817026403:# heildarþekja (öll Type) allra reita innan ára
1707817026418:df_summary <- jd_long_Engin_NA |>
1707817026434:group_by(Year,Reitur) %>%
1707817026449:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817026463:group_by(Year) %>%
1707817026478:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817026491:mutate(Type = "Heildarþekja") |>
1707817026504:select(Type, Year, Mean, SE)
1707817026543:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817026556:# Ensure Type is ordered as desired
1707817026571:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817026595:# Plot
1707817026609:p1 <-
1707817026623:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707817026637:geom_bar(
1707817026652:stat = "identity",
1707817026665:color = "black",
1707817026679:size = .6,
1707817026693:position = position_dodge(width = 0.75)
1707817026710:) +
1707817026727:geom_errorbar(
1707817026744:aes(ymin = Mean - SE, ymax = Mean + SE),
1707817026758:width = .2,
1707817026774:position = position_dodge(width = 0.75)
1707817026788:) +
1707817026802:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817026818:scale_y_continuous(
1707817026833:labels = label_dollar(prefix = "", suffix = " \n%"),
1707817026847:# Example secondary axis (e.g., double the Mean for illustration)
1707817026863:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707817026876:) +
1707817026890:labs(title = "",
1707817026904:y = "Meðalþekja", x = "") +
1707817026920:scale_x_discrete(
1707817026934:"",
1707817026949:labels = c(
1707817026963:"Mosar" = "Mosar",
1707817026978:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817026997:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817027014:"Heildarþekja" = "Heildarþekja",
1707817027032:"Tegundafjöldi" = "Tegundafjöldi"
1707817027048:)
1707817027064:) +
1707817027082:theme_minimal() +
1707817027097:theme(legend.title = element_blank(),
1707817027112:plot.background = element_rect(fill = "white", color = NA)) +
1707817027126:annotate(
1707817027139:"text",
1707817027154:x = 2,
1707817027167:y = Inf,
1707817027183:label = i,
1707817027198:hjust = 1,
1707817027212:vjust = 1,
1707817027227:size = 8,
1707817027243:angle = 0
1707817027256:)
1707817027283:p1 <-
1707817027296:p1 + theme(
1707817027309:axis.title = element_text(size = 16),
1707817027326:# Increase axis titles
1707817027342:axis.text = element_text(size = 16),
1707817027354:# Increase axis text
1707817027368:legend.text = element_text(size = 16)
1707817027382:) # Increase legend text
1707817027406:Filename <-  glue("./myndir/", "A" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817027420:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817027457:}
1707817054762:for (i in unique(joined_data$Stadur)[1:5]) {
1707817054792:filtered_data <- joined_data %>%
1707817054808:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817054822:select(where(~ !all(is.na(.))))
1707817054849:# Dynamically identify year columns that exist after filtering
1707817054863:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817054878:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817054907:# Pivot longer only with existing year columns
1707817054922:jd_long <- filtered_data %>%
1707817054937:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817054964:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817054989:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817055006:# Fjöldi tegunda í reit á ári
1707817055022:species_counts <- jd_long_Engin_NA %>%
1707817055036:group_by(Reitur, Year) %>%
1707817055050:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817055064:# Meðalfjöldi tegunda í reit á ári
1707817055078:group_by(Year) %>%
1707817055094:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817055109:mutate(Type = "Tegundafjöldi")|>
1707817055124:select(Type, Year, Mean, SE)
1707817055150:# Meðalþekja reita eftir Type
1707817055165:df <- jd_long |>
1707817055180:group_by(Type,Year,Reitur) %>%
1707817055194:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817055210:group_by(Type,Year) %>%
1707817055224:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817055252:# heildarþekja (öll Type) allra reita innan ára
1707817055265:df_summary <- jd_long |>
1707817055278:group_by(Year,Reitur) %>%
1707817055295:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817055310:group_by(Year) %>%
1707817055323:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817055336:mutate(Type = "Heildarþekja") |>
1707817055350:select(Type, Year, Mean, SE)
1707817055387:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817055400:# Ensure Type is ordered as desired
1707817055413:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817055438:# Plot
1707817055451:p1 <-
1707817055465:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707817055478:geom_bar(
1707817055493:stat = "identity",
1707817055508:color = "black",
1707817055523:size = .6,
1707817055538:position = position_dodge(width = 0.75)
1707817055552:) +
1707817055565:geom_errorbar(
1707817055578:aes(ymin = Mean - SE, ymax = Mean + SE),
1707817055593:width = .2,
1707817055607:position = position_dodge(width = 0.75)
1707817055622:) +
1707817055639:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817055653:scale_y_continuous(
1707817055670:labels = label_dollar(prefix = "", suffix = " \n%"),
1707817055683:# Example secondary axis (e.g., double the Mean for illustration)
1707817055699:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707817055712:) +
1707817055726:labs(title = "",
1707817055740:y = "Meðalþekja", x = "") +
1707817055754:scale_x_discrete(
1707817055769:"",
1707817055783:labels = c(
1707817055798:"Mosar" = "Mosar",
1707817055815:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817055832:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817055849:"Heildarþekja" = "Heildarþekja",
1707817055864:"Tegundafjöldi" = "Tegundafjöldi"
1707817055879:)
1707817055897:) +
1707817055915:theme_minimal() +
1707817055933:theme(legend.title = element_blank(),
1707817055949:plot.background = element_rect(fill = "white", color = NA)) +
1707817055965:annotate(
1707817055981:"text",
1707817055996:x = 2,
1707817056010:y = Inf,
1707817056024:label = i,
1707817056037:hjust = 1,
1707817056051:vjust = 1,
1707817056066:size = 8,
1707817056080:angle = 0
1707817056094:)
1707817056120:p1 <-
1707817056134:p1 + theme(
1707817056148:axis.title = element_text(size = 16),
1707817056162:# Increase axis titles
1707817056176:axis.text = element_text(size = 16),
1707817056191:# Increase axis text
1707817056205:legend.text = element_text(size = 16)
1707817056220:) # Increase legend text
1707817056245:Filename <-  glue("./myndir/", "B" ,i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817056259:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817056293:}
1707817217370:for (i in unique(joined_data$Stadur)) {
1707817217415:filtered_data <- joined_data %>%
1707817217431:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817217448:select(where(~ !all(is.na(.))))
1707817217474:# Dynamically identify year columns that exist after filtering
1707817217488:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817217502:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817217522:# Pivot longer only with existing year columns
1707817217533:jd_long <- filtered_data %>%
1707817217544:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817217564:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817217584:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817217594:# Fjöldi tegunda í reit á ári
1707817217605:species_counts <- jd_long_Engin_NA %>%
1707817217616:group_by(Reitur, Year) %>%
1707817217627:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817217640:# Meðalfjöldi tegunda í reit á ári
1707817217655:group_by(Year) %>%
1707817217669:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817217683:mutate(Type = "Tegundafjöldi")|>
1707817217698:select(Type, Year, Mean, SE)
1707817217722:# Meðalþekja reita eftir Type
1707817217739:df <- jd_long |>
1707817217755:group_by(Type,Year,Reitur) %>%
1707817217768:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817217780:group_by(Type,Year) %>%
1707817217794:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817217817:# heildarþekja (öll Type) allra reita innan ára
1707817217831:df_summary <- jd_long |>
1707817217843:group_by(Year,Reitur) %>%
1707817217858:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817217873:group_by(Year) %>%
1707817217888:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817217902:mutate(Type = "Heildarþekja") |>
1707817217919:select(Type, Year, Mean, SE)
1707817217956:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817217971:# Ensure Type is ordered as desired
1707817217985:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817218011:# Plot
1707817218026:p1 <-
1707817218041:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707817218056:geom_bar(
1707817218070:stat = "identity",
1707817218085:color = "black",
1707817218098:size = .6,
1707817218111:position = position_dodge(width = 0.75)
1707817218125:) +
1707817218138:geom_errorbar(
1707817218154:aes(ymin = Mean - SE, ymax = Mean + SE),
1707817218169:width = .2,
1707817218183:position = position_dodge(width = 0.75)
1707817218198:) +
1707817218212:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817218226:scale_y_continuous(
1707817218240:labels = label_dollar(prefix = "", suffix = " \n%"),
1707817218255:# Example secondary axis (e.g., double the Mean for illustration)
1707817218269:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707817218284:) +
1707817218299:labs(title = "",
1707817218316:y = "Meðalþekja", x = "") +
1707817218330:scale_x_discrete(
1707817218345:"",
1707817218363:labels = c(
1707817218379:"Mosar" = "Mosar",
1707817218397:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817218412:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817218427:"Heildarþekja" = "Heildarþekja",
1707817218442:"Tegundafjöldi" = "Tegundafjöldi"
1707817218459:)
1707817218475:) +
1707817218490:theme_minimal() +
1707817218505:theme(legend.title = element_blank(),
1707817218519:plot.background = element_rect(fill = "white", color = NA)) +
1707817218532:annotate(
1707817218546:"text",
1707817218561:x = 2,
1707817218577:y = Inf,
1707817218591:label = i,
1707817218605:hjust = 1,
1707817218621:vjust = 1,
1707817218634:size = 8,
1707817218651:angle = 0
1707817218668:)
1707817218695:p1 <-
1707817218709:p1 + theme(
1707817218723:axis.title = element_text(size = 16),
1707817218738:# Increase axis titles
1707817218751:axis.text = element_text(size = 16),
1707817218766:# Increase axis text
1707817218782:legend.text = element_text(size = 16)
1707817218796:) # Increase legend text
1707817218820:Filename <-  glue("./myndir/SE/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817218833:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817218866:}
1707817294549:for (i in unique(joined_data$Stadur)) {
1707817294580:filtered_data <- joined_data %>%
1707817294596:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817294609:select(where(~ !all(is.na(.))))
1707817294630:# Dynamically identify year columns that exist after filtering
1707817294641:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817294652:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817294672:# Pivot longer only with existing year columns
1707817294683:jd_long <- filtered_data %>%
1707817294694:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817294712:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817294737:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817294753:# Fjöldi tegunda í reit á ári
1707817294766:species_counts <- jd_long_Engin_NA %>%
1707817294779:group_by(Reitur, Year) %>%
1707817294792:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817294806:# Meðalfjöldi tegunda í reit á ári
1707817294819:group_by(Year) %>%
1707817294835:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817294849:mutate(Type = "Tegundafjöldi")|>
1707817294864:select(Type, Year, Mean, SE)
1707817294892:# Meðalþekja reita eftir Type
1707817294906:df <- jd_long |>
1707817294920:group_by(Type,Year,Reitur) %>%
1707817294934:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817294949:group_by(Type,Year) %>%
1707817294963:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817294986:# heildarþekja (öll Type) allra reita innan ára
1707817295001:df_summary <- jd_long |>
1707817295014:group_by(Year,Reitur) %>%
1707817295029:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817295044:group_by(Year) %>%
1707817295059:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817295074:mutate(Type = "Heildarþekja") |>
1707817295090:select(Type, Year, Mean, SE)
1707817295132:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817295147:# Ensure Type is ordered as desired
1707817295160:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817295186:# Plot
1707817295201:p1 <-
1707817295215:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707817295228:geom_bar(
1707817295244:stat = "identity",
1707817295260:color = "black",
1707817295275:size = .6,
1707817295289:position = position_dodge(width = 0.75)
1707817295304:) +
1707817295318:# geom_errorbar(
1707817295332:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707817295346:#   width = .2,
1707817295362:#   position = position_dodge(width = 0.75)
1707817295375:# ) +
1707817295390:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817295405:scale_y_continuous(
1707817295419:labels = label_dollar(prefix = "", suffix = " \n%"),
1707817295434:# Example secondary axis (e.g., double the Mean for illustration)
1707817295451:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707817295468:) +
1707817295481:labs(title = "",
1707817295497:y = "Meðalþekja", x = "") +
1707817295510:scale_x_discrete(
1707817295525:"",
1707817295539:labels = c(
1707817295554:"Mosar" = "Mosar",
1707817295569:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817295582:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817295596:"Heildarþekja" = "Heildarþekja",
1707817295612:"Tegundafjöldi" = "Tegundafjöldi"
1707817295627:)
1707817295642:) +
1707817295656:theme_minimal() +
1707817295671:theme(legend.title = element_blank(),
1707817295686:plot.background = element_rect(fill = "white", color = NA)) +
1707817295700:annotate(
1707817295712:"text",
1707817295723:x = 2,
1707817295734:y = Inf,
1707817295745:label = i,
1707817295756:hjust = 1,
1707817295768:vjust = 1,
1707817295782:size = 8,
1707817295794:angle = 0
1707817295807:)
1707817295829:p1 <-
1707817295844:p1 + theme(
1707817295861:axis.title = element_text(size = 16),
1707817295878:# Increase axis titles
1707817295893:axis.text = element_text(size = 16),
1707817295909:# Increase axis text
1707817295925:legend.text = element_text(size = 16)
1707817295938:) # Increase legend text
1707817295961:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817295973:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817296002:}
1707817388232:list.files()
1707817406111:list.files("./myndir")
1707817412569:length(list.files("./myndir"))
1707817415917:length(list.files("./myndir/SE"))
1707817426736:for (i in unique(joined_data$Stadur)) {
1707817426773:filtered_data <- joined_data %>%
1707817426786:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817426799:select(where(~ !all(is.na(.))))
1707817426822:# Dynamically identify year columns that exist after filtering
1707817426837:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817426851:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817426875:# Pivot longer only with existing year columns
1707817426889:jd_long <- filtered_data %>%
1707817426903:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817426927:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817426951:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817426967:# Fjöldi tegunda í reit á ári
1707817426984:species_counts <- jd_long_Engin_NA %>%
1707817427001:group_by(Reitur, Year) %>%
1707817427019:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817427034:# Meðalfjöldi tegunda í reit á ári
1707817427052:group_by(Year) %>%
1707817427067:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817427082:mutate(Type = "Tegundafjöldi")|>
1707817427096:select(Type, Year, Mean, SE)
1707817427121:# Meðalþekja reita eftir Type
1707817427134:df <- jd_long |>
1707817427149:group_by(Type,Year,Reitur) %>%
1707817427163:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817427179:group_by(Type,Year) %>%
1707817427193:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817427218:# heildarþekja (öll Type) allra reita innan ára
1707817427233:df_summary <- jd_long |>
1707817427247:group_by(Year,Reitur) %>%
1707817427261:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817427275:group_by(Year) %>%
1707817427289:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817427303:mutate(Type = "Heildarþekja") |>
1707817427316:select(Type, Year, Mean, SE)
1707817427353:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817427368:# Ensure Type is ordered as desired
1707817427381:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817427404:# Plot
1707817427418:p1 <-
1707817427432:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707817427447:geom_bar(
1707817427461:stat = "identity",
1707817427475:color = "black",
1707817427490:size = .6,
1707817427508:position = position_dodge(width = 0.75)
1707817427523:) +
1707817427539:# geom_errorbar(
1707817427553:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707817427568:#   width = .2,
1707817427583:#   position = position_dodge(width = 0.75)
1707817427596:# ) +
1707817427610:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817427626:scale_y_continuous(
1707817427641:labels = label_dollar(prefix = "", suffix = " \n%"),
1707817427654:# Example secondary axis (e.g., double the Mean for illustration)
1707817427668:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707817427681:) +
1707817427696:labs(title = "",
1707817427710:y = "Meðalþekja", x = "") +
1707817427724:scale_x_discrete(
1707817427738:"",
1707817427752:labels = c(
1707817427767:"Mosar" = "Mosar",
1707817427782:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817427798:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817427813:"Heildarþekja" = "Heildarþekja",
1707817427829:"Tegundafjöldi" = "Tegundafjöldi"
1707817427845:)
1707817427858:) +
1707817427874:theme_minimal() +
1707817427889:theme(legend.title = element_blank(),
1707817427905:plot.background = element_rect(fill = "white", color = NA)) +
1707817427918:annotate(
1707817427931:"text",
1707817427945:x = 2,
1707817427959:y = Inf,
1707817427973:label = i,
1707817427987:hjust = 1,
1707817428002:vjust = 1,
1707817428015:size = 8,
1707817428029:angle = 0
1707817428042:)
1707817428065:p1 <-
1707817428077:p1 + theme(
1707817428091:axis.title = element_text(size = 16),
1707817428105:# Increase axis titles
1707817428118:axis.text = element_text(size = 16),
1707817428134:# Increase axis text
1707817428147:legend.text = element_text(size = 16)
1707817428162:) # Increase legend text
1707817428186:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817428200:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817428237:}
1707817450744:length(list.files("./myndir"))
1707817454627:length(list.files("./myndir/SE"))
1707817484235:for (i in unique(joined_data$Stadur)) {
1707817484265:filtered_data <- joined_data %>%
1707817484279:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817484294:select(where(~ !all(is.na(.))))
1707817484321:# Dynamically identify year columns that exist after filtering
1707817484335:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817484349:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817484374:# Pivot longer only with existing year columns
1707817484390:jd_long <- filtered_data %>%
1707817484404:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817484428:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817484452:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817484467:# Fjöldi tegunda í reit á ári
1707817484482:species_counts <- jd_long_Engin_NA %>%
1707817484496:group_by(Reitur, Year) %>%
1707817484510:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817484524:# Meðalfjöldi tegunda í reit á ári
1707817484538:group_by(Year) %>%
1707817484553:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817484567:mutate(Type = "Tegundafjöldi")|>
1707817484581:select(Type, Year, Mean, SE)
1707817484606:# Meðalþekja reita eftir Type
1707817484621:df <- jd_long |>
1707817484635:group_by(Type,Year,Reitur) %>%
1707817484649:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817484663:group_by(Type,Year) %>%
1707817484678:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817484703:# heildarþekja (öll Type) allra reita innan ára
1707817484717:df_summary <- jd_long |>
1707817484731:group_by(Year,Reitur) %>%
1707817484746:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817484759:group_by(Year) %>%
1707817484774:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817484788:mutate(Type = "Heildarþekja") |>
1707817484802:select(Type, Year, Mean, SE)
1707817484838:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817484854:# Ensure Type is ordered as desired
1707817484868:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817484894:# Plot
1707817484907:p1 <-
1707817484920:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707817484935:geom_bar(
1707817484949:stat = "identity",
1707817484964:color = "black",
1707817484979:size = .6,
1707817484993:position = position_dodge(width = 0.75)
1707817485007:) +
1707817485020:geom_errorbar(
1707817485033:aes(ymin = Mean - SE, ymax = Mean + SE),
1707817485048:width = .2,
1707817485061:position = position_dodge(width = 0.75)
1707817485076:) +
1707817485089:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817485103:scale_y_continuous(
1707817485117:labels = label_dollar(prefix = "", suffix = " \n%"),
1707817485131:# Example secondary axis (e.g., double the Mean for illustration)
1707817485145:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707817485159:) +
1707817485172:labs(title = "",
1707817485188:y = "Meðalþekja", x = "") +
1707817485203:scale_x_discrete(
1707817485219:"",
1707817485235:labels = c(
1707817485250:"Mosar" = "Mosar",
1707817485264:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817485278:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817485295:"Heildarþekja" = "Heildarþekja",
1707817485310:"Tegundafjöldi" = "Tegundafjöldi"
1707817485324:)
1707817485338:) +
1707817485353:theme_minimal() +
1707817485367:theme(legend.title = element_blank(),
1707817485381:plot.background = element_rect(fill = "white", color = NA)) +
1707817485395:annotate(
1707817485409:"text",
1707817485423:x = 2,
1707817485438:y = Inf,
1707817485452:label = i,
1707817485466:hjust = 1,
1707817485479:vjust = 1,
1707817485493:size = 8,
1707817485506:angle = 0
1707817485519:)
1707817485546:p1 <-
1707817485562:p1 + theme(
1707817485578:axis.title = element_text(size = 16),
1707817485592:# Increase axis titles
1707817485605:axis.text = element_text(size = 16),
1707817485618:# Increase axis text
1707817485634:legend.text = element_text(size = 16)
1707817485650:) # Increase legend text
1707817485677:Filename <-  glue("./myndir/SE/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817485691:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817485729:}
1707817503089:length(list.files("./myndir/SE"))
1707817505837:length(list.files("./myndir"))
1707817619952:for (i in unique(joined_data$Stadur)[5]) {
1707817619997:filtered_data <- joined_data %>%
1707817620018:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817620042:select(where(~ !all(is.na(.))))
1707817620073:# Dynamically identify year columns that exist after filtering
1707817620088:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817620104:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817620128:# Pivot longer only with existing year columns
1707817620142:jd_long <- filtered_data %>%
1707817620157:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817620183:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817620237:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817620252:# Fjöldi tegunda í reit á ári
1707817620267:species_counts <- jd_long_Engin_NA %>%
1707817620281:group_by(Reitur, Year) %>%
1707817620298:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817620313:# Meðalfjöldi tegunda í reit á ári
1707817620327:group_by(Year) %>%
1707817620345:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817620359:mutate(Type = "Tegundafjöldi")|>
1707817620374:select(Type, Year, Mean, SE)
1707817620397:# Meðalþekja reita eftir Type
1707817620412:df <- jd_long |>
1707817620425:group_by(Type,Year,Reitur) %>%
1707817620439:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817620453:group_by(Type,Year) %>%
1707817620467:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817620494:# heildarþekja (öll Type) allra reita innan ára
1707817620511:df_summary <- jd_long |>
1707817620527:group_by(Year,Reitur) %>%
1707817620542:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817620556:group_by(Year) %>%
1707817620571:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817620585:mutate(Type = "Heildarþekja") |>
1707817620598:select(Type, Year, Mean, SE)
1707817620634:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817620648:# Ensure Type is ordered as desired
1707817620661:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817620687:# Plot
1707817620701:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill=Year)) +
1707817620717:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707817620731:geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707817620744:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817620757:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707817620771:# Example secondary axis (e.g., double the Mean for illustration)
1707817620784:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707817620801:labs(title = "",
1707817620819:y = "Meðalþekja", x = "") +
1707817620834:scale_x_discrete(
1707817620851:"",
1707817620867:labels = c(
1707817620886:"Mosar" = "Mosar",
1707817620905:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817620920:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817620936:"Heildarþekja" = "Heildarþekja",
1707817620951:"Tegundafjöldi" = "Tegundafjöldi"
1707817620969:))+
1707817620983:theme_minimal()+
1707817620998:theme(legend.title = element_blank(),
1707817621011:plot.background = element_rect(fill = "white", color = NA)) +
1707817621025:annotate("text", x = 2, y = Inf, label = "Ofan\nHvalfjarðareyrar", hjust = 1, vjust = 1, size = 8, angle = 0)
1707817621051:p1 <- p1 + theme(axis.title = element_text(size = 16), # Increase axis titles
1707817621065:axis.text = element_text(size = 16), # Increase axis text
1707817621079:legend.text = element_text(size = 16)) # Increase legend text
1707817621118:Filename <-  glue(i,"-","{paste(unique(species_counts$Reitur), collapse='_')}.png")
1707817621132:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817621157:}
1707817805358:for (i in unique(joined_data$Stadur)[5]) {
1707817805390:filtered_data <- joined_data %>%
1707817805404:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817805418:select(where(~ !all(is.na(.))))
1707817805442:# Dynamically identify year columns that exist after filtering
1707817805456:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817805471:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817805496:# Pivot longer only with existing year columns
1707817805512:jd_long <- filtered_data %>%
1707817805526:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817805551:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817805577:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817805590:# Fjöldi tegunda í reit á ári
1707817805603:species_counts <- jd_long_Engin_NA %>%
1707817805619:group_by(Reitur, Year) %>%
1707817805632:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817805644:# Meðalfjöldi tegunda í reit á ári
1707817805657:group_by(Year) %>%
1707817805669:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817805682:mutate(Type = "Tegundafjöldi")|>
1707817805695:select(Type, Year, Mean, SE)
1707817805719:# Meðalþekja reita eftir Type
1707817805733:df <- jd_long |>
1707817805747:group_by(Type,Year,Reitur) %>%
1707817805762:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817805777:group_by(Type,Year) %>%
1707817805790:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817805813:# heildarþekja (öll Type) allra reita innan ára
1707817805826:df_summary <- jd_long |>
1707817805842:group_by(Year,Reitur) %>%
1707817805856:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817805869:group_by(Year) %>%
1707817805881:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817805897:mutate(Type = "Heildarþekja") |>
1707817805913:select(Type, Year, Mean, SE)
1707817805948:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817805962:# Ensure Type is ordered as desired
1707817805976:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817805997:# Plot
1707817806009:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill=Year)) +
1707817806021:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707817806031:geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707817806043:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817806054:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707817806065:# Example secondary axis (e.g., double the Mean for illustration)
1707817806076:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707817806087:labs(title = "",
1707817806098:y = "Meðalþekja", x = "") +
1707817806109:scale_x_discrete(
1707817806120:"",
1707817806131:labels = c(
1707817806142:"Mosar" = "Mosar",
1707817806152:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817806163:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817806175:"Heildarþekja" = "Heildarþekja",
1707817806189:"Tegundafjöldi" = "Tegundafjöldi"
1707817806204:))+
1707817806218:theme_minimal()+
1707817806233:theme(legend.title = element_blank(),
1707817806248:plot.background = element_rect(fill = "white", color = NA)) +
1707817806264:annotate("text", x = 2, y = Inf, label = "Ofan\nHvalfjarðareyrar", hjust = 1, vjust = 1, size = 8, angle = 0)
1707817806292:p1 <- p1 + theme(axis.title = element_text(size = 16), # Increase axis titles
1707817806306:axis.text = element_text(size = 16), # Increase axis text
1707817806322:legend.text = element_text(size = 16)) # Increase legend text
1707817806361:Filename <-  glue("./myndir/SE/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817806378:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817806405:}
1707817839201:for (i in unique(joined_data$Stadur)[5]) {
1707817839230:filtered_data <- joined_data %>%
1707817839247:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707817839261:select(where(~ !all(is.na(.))))
1707817839287:# Dynamically identify year columns that exist after filtering
1707817839301:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707817839317:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707817839339:# Pivot longer only with existing year columns
1707817839350:jd_long <- filtered_data %>%
1707817839365:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707817839390:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707817839415:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707817839430:# Fjöldi tegunda í reit á ári
1707817839444:species_counts <- jd_long_Engin_NA %>%
1707817839457:group_by(Reitur, Year) %>%
1707817839472:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707817839485:# Meðalfjöldi tegunda í reit á ári
1707817839499:group_by(Year) %>%
1707817839513:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707817839527:mutate(Type = "Tegundafjöldi")|>
1707817839542:select(Type, Year, Mean, SE)
1707817839568:# Meðalþekja reita eftir Type
1707817839583:df <- jd_long |>
1707817839599:group_by(Type,Year,Reitur) %>%
1707817839615:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707817839629:group_by(Type,Year) %>%
1707817839643:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707817839666:# heildarþekja (öll Type) allra reita innan ára
1707817839679:df_summary <- jd_long |>
1707817839695:group_by(Year,Reitur) %>%
1707817839712:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707817839728:group_by(Year) %>%
1707817839743:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707817839758:mutate(Type = "Heildarþekja") |>
1707817839772:select(Type, Year, Mean, SE)
1707817839807:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707817839822:# Ensure Type is ordered as desired
1707817839836:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707817839865:# Plot
1707817839879:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill=Year)) +
1707817839894:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707817839911:#geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707817839927:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707817839942:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707817839959:# Example secondary axis (e.g., double the Mean for illustration)
1707817839973:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707817839986:labs(title = "",
1707817840002:y = "Meðalþekja", x = "") +
1707817840017:scale_x_discrete(
1707817840031:"",
1707817840046:labels = c(
1707817840062:"Mosar" = "Mosar",
1707817840076:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707817840090:"Hrúðurfléttur" = "Hrúðurfléttur",
1707817840105:"Heildarþekja" = "Heildarþekja",
1707817840122:"Tegundafjöldi" = "Tegundafjöldi"
1707817840136:))+
1707817840148:theme_minimal()+
1707817840161:theme(legend.title = element_blank(),
1707817840174:plot.background = element_rect(fill = "white", color = NA)) +
1707817840187:annotate("text", x = 2, y = Inf, label = "Ofan\nHvalfjarðareyrar", hjust = 1, vjust = 1, size = 8, angle = 0)
1707817840212:p1 <- p1 + theme(axis.title = element_text(size = 16), # Increase axis titles
1707817840228:axis.text = element_text(size = 16), # Increase axis text
1707817840241:legend.text = element_text(size = 16)) # Increase legend text
1707817840276:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707817840291:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707817840315:}
1707817991112:mynd <- read.table("mynd40.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707817991134:pivot_longer(cols = c("hraunbreyskja","snepaskóf" ), names_to = "Gerd", values_to = "Heild" )
1707817992635:ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.S.g)) +
1707817992653:geom_bar(
1707817992670:stat = "identity",
1707817992684:color = "black",
1707817992700:size = .6,
1707817992715:position = position_dodge(width = 0.75)
1707817992730:)
1707818055417:ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.S.g)) +
1707818055435:geom_bar(
1707818055451:stat = "identity",
1707818055465:color = "black",
1707818055480:size = .6,
1707818055494:position = position_dodge(width = 0.75)
1707818055508:) +
1707818055523:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818055538:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707818055550:# Example secondary axis (e.g., double the Mean for illustration)
1707818055563:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi"))
1707818126588:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818126606:geom_bar(
1707818126620:stat = "identity",
1707818126635:color = "black",
1707818126651:size = .6,
1707818126667:position = position_dodge(width = 0.75)
1707818126681:) +
1707818126695:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818126710:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707818126724:# Example secondary axis (e.g., double the Mean for illustration)
1707818126738:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi"))
1707818173035:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818173052:geom_bar(
1707818173067:stat = "identity",
1707818173082:color = "black",
1707818173095:size = .6,
1707818173110:position = position_dodge(width = 0.75)
1707818173123:) +
1707818173137:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818173149:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707818173162:# Example secondary axis (e.g., double the Mean for illustration)
1707818173176:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi"))
1707818223615:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818223630:geom_bar(
1707818223644:stat = "identity",
1707818223656:color = "black",
1707818223667:size = .6,
1707818223678:position = position_dodge(width = 0.75)
1707818223689:) +
1707818223699:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818223710:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707818223721:# Example secondary axis (e.g., double the Mean for illustration)
1707818223733:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707818223743:labs(title = "",  y = "Meðalþekja", x = "")
1707818236783:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818236800:geom_bar(
1707818236818:stat = "identity",
1707818236833:color = "black",
1707818236847:size = .6,
1707818236862:position = position_dodge(width = 0.75)
1707818236878:) +
1707818236892:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818236907:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707818236921:# Example secondary axis (e.g., double the Mean for illustration)
1707818236936:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707818236950:labs(title = "",  y = "% S", x = "")
1707818278531:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818278549:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818278565:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818278579:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818278593:labs(title = "",  y = "% S", x = "")
1707818335586:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818335604:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818335619:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818335631:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818335642:labs(title = "",  y = "% S", x = "") +
1707818335652:theme_minimal()+
1707818335665:theme(legend.title = element_blank(),
1707818335677:plot.background = element_rect(fill = "white", color = NA)) +
1707818335691:annotate("text", x = 2, y = Inf, label = "Ofan\nHvalfjarðareyrar", hjust = 1, vjust = 1, size = 8, angle = 0) +
1707818335704:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818335718:axis.text = element_text(size = 16), # Increase axis text
1707818335731:legend.text = element_text(size = 16)) # Increase legend text
1707818349808:?annotate
1707818360123:p <- ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point()
1707818360146:p + annotate("text", x = 4, y = 25, label = "Some text")
1707818360288:p + annotate("text", x = 2:5, y = 25, label = "Some text")
1707818361140:p + annotate("rect", xmin = 3, xmax = 4.2, ymin = 12, ymax = 21,
1707818361155:alpha = .2)
1707818362008:p + annotate("segment", x = 2.5, xend = 4, y = 15, yend = 25,
1707818362031:colour = "blue")
1707818362848:p + annotate("pointrange", x = 3.5, y = 20, ymin = 12, ymax = 28,
1707818362863:colour = "red", size = 1.5)
1707818363784:p + annotate("text", x = 2:3, y = 20:21, label = c("my label", "label 2"))
1707818364680:p + annotate("text", x = 4, y = 25, label = "italic(R) ^ 2 == 0.75",
1707818364695:parse = TRUE)
1707818365550:p + annotate("text", x = 4, y = 25,
1707818365567:label = "paste(italic(R) ^ 2, \" = .75\")", parse = TRUE)
1707818471642:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818471663:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818471683:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818471697:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818471712:labs(title = "",  y = "% S", x = "") +
1707818471727:theme_minimal()+
1707818471742:ggtitle("Plot of length \n by dose")+
1707818471755:theme(legend.title = element_blank(),
1707818471767:plot.background = element_rect(fill = "white", color = NA)) +
1707818471780:annotate("text", x = 2, y = Inf, label = "Ofan\nHvalfjarðareyrar", hjust = 1, vjust = 1, size = 8, angle = 0) +
1707818471792:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818471806:axis.text = element_text(size = 16), # Increase axis text
1707818471819:legend.text = element_text(size = 16)) # Increase legend text
1707818494505:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818494525:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818494544:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818494558:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818494572:labs(title = "",  y = "% S", x = "") +
1707818494587:theme_minimal()+
1707818494601:ggtitle("Plot of length \n by dose")+
1707818494616:theme(legend.title = element_blank(),
1707818494628:plot.background = element_rect(fill = "white", color = NA)) +
1707818494643:annotate("text", x = 2, y = Inf, label = "Álþök", hjust = 1, vjust = 1, size = 8, angle = 0) +
1707818494658:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818494671:axis.text = element_text(size = 16), # Increase axis text
1707818494686:legend.text = element_text(size = 16)) # Increase legend text
1707818510041:?ggtitle
1707818588716:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818588732:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818588752:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818588767:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818588780:labs(title = "",  y = "% S", x = "") +
1707818588794:theme_minimal()+
1707818588808:ggtitle("Plot of length \n by dose")+
1707818588821:theme(legend.title = element_blank(),
1707818588835:plot.background = element_rect(fill = "white", color = NA)) +
1707818588849:annotate("text", x = 2, y = Inf, label = "Álþök", hjust = 1, vjust = 1, size = 8, angle = 0) +
1707818588863:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818588876:axis.text = element_text(size = 16), # Increase axis text
1707818588891:legend.text = element_text(size = 16),
1707818588905:plot.title = element_text(size = 18)) # Increase legend text
1707818618354:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707818618374:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818618391:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818618408:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818618422:labs(title = "",  y = "% S", x = "") +
1707818618436:theme_minimal()+
1707818618450:ggtitle("Brennisteinn")+
1707818618464:theme(legend.title = element_blank(),
1707818618478:plot.background = element_rect(fill = "white", color = NA)) +
1707818618493:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818618507:axis.text = element_text(size = 16), # Increase axis text
1707818618520:legend.text = element_text(size = 16),
1707818618535:plot.title = element_text(size = 18)) # Increase legend text
1707818642728:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707818642746:pivot_longer(cols = c("hraunbreyskja","snepaskóf" ), names_to = "Gerd", values_to = "Heild" )
1707818643683:ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.F.g)) +
1707818643707:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818643726:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818643742:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818643755:labs(title = "",  y = "% S", x = "") +
1707818643770:theme_minimal()+
1707818643786:ggtitle("Brennisteinn")+
1707818643800:theme(legend.title = element_blank(),
1707818643814:plot.background = element_rect(fill = "white", color = NA)) +
1707818643828:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818643842:axis.text = element_text(size = 16), # Increase axis text
1707818643856:legend.text = element_text(size = 16),
1707818643870:plot.title = element_text(size = 18)) # Increase legend text
1707818667642:ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.F.g)) +
1707818667661:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818667680:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818667695:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818667708:labs(title = "",  y = "% S", x = "") +
1707818667722:theme_minimal()+
1707818667738:ggtitle("Flúor")+
1707818667752:theme(legend.title = element_blank(),
1707818667769:plot.background = element_rect(fill = "white", color = NA)) +
1707818667788:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818667804:axis.text = element_text(size = 16), # Increase axis text
1707818667819:legend.text = element_text(size = 16),
1707818667835:plot.title = element_text(size = 18)) # Increase legend text
1707818703981:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707818703997:pivot_longer(cols = c("snepaskóf","hraunbreyskja"), names_to = "Gerd", values_to = "Heild" )
1707818704476:ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.F.g)) +
1707818704497:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818704514:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818704531:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818704548:labs(title = "",  y = "% S", x = "") +
1707818704565:theme_minimal()+
1707818704579:ggtitle("Flúor")+
1707818704592:theme(legend.title = element_blank(),
1707818704606:plot.background = element_rect(fill = "white", color = NA)) +
1707818704620:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818704635:axis.text = element_text(size = 16), # Increase axis text
1707818704649:legend.text = element_text(size = 16),
1707818704664:plot.title = element_text(size = 18)) # Increase legend text
1707818903897:ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.F.g)) +
1707818903916:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707818903934:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707818903948:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707818903963:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707818903978:theme_minimal()+
1707818903993:ggtitle("Flúor")+
1707818904008:theme(legend.title = element_blank(),
1707818904021:plot.background = element_rect(fill = "white", color = NA)) +
1707818904036:theme(axis.title = element_text(size = 16), # Increase axis titles
1707818904050:axis.text = element_text(size = 16), # Increase axis text
1707818904063:legend.text = element_text(size = 16),
1707818904078:plot.title = element_text(size = 18)) # Increase legend text
1707819076735:mynd
1707819208613:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707819208632:pivot_longer(cols = c("snepaskóf","hraunbreyskja"), names_to = "Gerd", values_to = "Heild" ) |>
1707819208651:rename(Snepaskóf = snepaskóf)
1707819281916:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707819281934:pivot_longer(cols = c("snepaskóf","hraunbreyskja"), names_to = "Gerd", values_to = "Heild" ) |>
1707819281953:mutate(Gerd = case_when(
1707819281967:"snepaskóf"~"Snepaskóf"
1707819281983:))
1707819297351:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707819297367:pivot_longer(cols = c("snepaskóf","hraunbreyskja"), names_to = "Gerd", values_to = "Heild" ) |>
1707819297388:mutate(Gerd = case_when(
1707819297404:Gerd == "snepaskóf"~"Snepaskóf"
1707819297417:))
1707819301816:mynd
1707819333617:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707819333637:pivot_longer(cols = c("snepaskóf","hraunbreyskja"), names_to = "Gerd", values_to = "Heild" ) |>
1707819333655:mutate(Gerd = case_when(
1707819333669:Gerd == "snepaskóf"~"Snepaskóf",
1707819333684:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707819333698:))
1707819334291:mynd$Gerd <- factor(mynd$Gerd, levels = c("Snepaskóf","Hraunbreyskja"))
1707819335828:ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.F.g)) +
1707819335861:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707819335877:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707819335898:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707819335918:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707819335935:theme_minimal()+
1707819335950:ggtitle("Flúor")+
1707819335964:theme(legend.title = element_blank(),
1707819335979:plot.background = element_rect(fill = "white", color = NA)) +
1707819335992:theme(axis.title = element_text(size = 16), # Increase axis titles
1707819336006:axis.text = element_text(size = 16), # Increase axis text
1707819336019:legend.text = element_text(size = 16),
1707819336032:plot.title = element_text(size = 18)) # Increase legend text
1707819438617:mynd$Gerd <- factor(mynd$Gerd, levels = c("Snepaskóf","Hraunbreyskja"))
1707819440481:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707819440502:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707819440518:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707819440532:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707819440547:labs(title = "",  y = "% S", x = "") +
1707819440561:theme_minimal()+
1707819440575:ggtitle("Brennisteinn")+
1707819440590:theme(legend.title = element_blank(),
1707819440605:plot.background = element_rect(fill = "white", color = NA)) +
1707819440619:theme(axis.title = element_text(size = 16), # Increase axis titles
1707819440633:axis.text = element_text(size = 16), # Increase axis text
1707819440646:legend.text = element_text(size = 16),
1707819440660:plot.title = element_text(size = 18)) # Increase legend text
1707819447583:mynd
1707819452476:mynd <- read.table("mynd40.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707819452497:pivot_longer(cols = c("hraunbreyskja","snepaskóf" ), names_to = "Gerd", values_to = "Heild" ) |>
1707819452514:mutate(Gerd = case_when(
1707819452527:Gerd == "snepaskóf"~"Snepaskóf",
1707819452541:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707819452555:))
1707819453386:mynd$Gerd <- factor(mynd$Gerd, levels = c("Snepaskóf","Hraunbreyskja"))
1707819455480:ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707819455499:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707819455514:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707819455529:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707819455544:labs(title = "",  y = "% S", x = "") +
1707819455558:theme_minimal()+
1707819455571:ggtitle("Brennisteinn")+
1707819455588:theme(legend.title = element_blank(),
1707819455601:plot.background = element_rect(fill = "white", color = NA)) +
1707819455615:theme(axis.title = element_text(size = 16), # Increase axis titles
1707819455631:axis.text = element_text(size = 16), # Increase axis text
1707819455644:legend.text = element_text(size = 16),
1707819455661:plot.title = element_text(size = 18)) # Increase legend text
1707819545504:Filename <-  glue("./myndir/efnagreiningar/","mynd40",}.png")
1707819585962:glue("./myndir/efnagreiningar/","mynd40",.png")
1707819597113:glue("./myndir/efnagreiningar/","mynd40",".png")
1707819611154:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707819612302:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707819636281:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707819636299:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707819636314:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707819636328:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707819636341:labs(title = "",  y = "% S", x = "") +
1707819636355:theme_minimal()+
1707819636370:ggtitle("Brennisteinn")+
1707819636384:theme(legend.title = element_blank(),
1707819636398:plot.background = element_rect(fill = "white", color = NA)) +
1707819636413:theme(axis.title = element_text(size = 16), # Increase axis titles
1707819636426:axis.text = element_text(size = 16), # Increase axis text
1707819636440:legend.text = element_text(size = 16),
1707819636454:plot.title = element_text(size = 18)) # Increase legend text
1707819637697:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707819638856:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707819669456:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = µg.S.g)) +
1707819669475:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707819669493:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707819669508:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707819669521:labs(title = "",  y = "S", x = "") +
1707819669535:theme_minimal()+
1707819669546:ggtitle("Brennisteinn")+
1707819669558:theme(legend.title = element_blank(),
1707819669569:plot.background = element_rect(fill = "white", color = NA)) +
1707819669584:theme(axis.title = element_text(size = 16), # Increase axis titles
1707819669599:axis.text = element_text(size = 16), # Increase axis text
1707819669614:legend.text = element_text(size = 16),
1707819669628:plot.title = element_text(size = 18)) # Increase legend text
1707819670329:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707819670561:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707819802648:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707819802667:pivot_longer(cols = c("snepaskóf","hraunbreyskja"), names_to = "Gerd", values_to = "Heild" ) |>
1707819802684:mutate(Gerd = case_when(
1707819802698:Gerd == "snepaskóf"~"Snepaskóf",
1707819802712:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707819802729:))
1707819822183:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.F.g)) +
1707819822202:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707819822222:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707819822238:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707819822252:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707819822267:theme_minimal()+
1707819822281:ggtitle("Flúor")+
1707819822294:theme(legend.title = element_blank(),
1707819822309:plot.background = element_rect(fill = "white", color = NA)) +
1707819822323:theme(axis.title = element_text(size = 16), # Increase axis titles
1707819822337:axis.text = element_text(size = 16), # Increase axis text
1707819822353:legend.text = element_text(size = 16),
1707819822366:plot.title = element_text(size = 18)) # Increase legend text
1707819825145:Filename <-  glue("./myndir/efnagreiningar/","mynd41",".png")
1707819826281:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707819848855:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild, fill = µg.F.g)) +
1707819848874:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707819848893:scale_fill_manual(values = colors_dark2) +
1707819848909:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707819848924:theme_minimal()+
1707819848938:ggtitle("Flúor")+
1707819848957:theme(legend.title = element_blank(),
1707819848974:plot.background = element_rect(fill = "white", color = NA)) +
1707819848989:theme(axis.title = element_text(size = 16), # Increase axis titles
1707819849004:axis.text = element_text(size = 16), # Increase axis text
1707819849018:legend.text = element_text(size = 16),
1707819849033:plot.title = element_text(size = 18)) # Increase legend text
1707819849920:Filename <-  glue("./myndir/efnagreiningar/","mynd41",".png")
1707819850001:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707819949729:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707819949751:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707819949771:names_to = "Year",
1707819949786:values_to = "Value",
1707819949802:names_prefix = "") %>%
1707819949818:mutate(Year = as.numeric(Year))
1707819950544:ggplot(mynd, aes(x = `µg S/g`, y = Value, fill = Year)) +
1707819950560:geom_bar(
1707819950575:stat = "identity",
1707819950588:color = "black",
1707819950603:size = .6,
1707819950617:position = position_dodge(width = 0.75)
1707819950631:)  +
1707819950645:scale_fill_manual(values = colors_dark2)
1707819955672:mynd
1707819965257:read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F)
1707820241160:read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707820241178:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707820241196:names_to = "Year",
1707820241213:values_to = "Value",
1707820241227:names_prefix = "") %>%
1707820241241:mutate(Year = as.numeric(Year))
1707820258942:ggplot(mynd, aes(x = `µg S/g`, y = Value, fill = Year)) +
1707820258960:geom_bar(
1707820258976:stat = "identity",
1707820258991:color = "black",
1707820259006:size = .6,
1707820259021:position = position_dodge(width = 0.75)
1707820259036:)
1707820274789:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707820274806:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707820274820:names_to = "Year",
1707820274836:values_to = "Value",
1707820274851:names_prefix = "") %>%
1707820274865:mutate(Year = as.numeric(Year))
1707820276709:mynd
1707820285404:print(mynd, n=100)
1707820334383:ggplot(mynd, aes(x = `µg S/g`, y = Value, fill = Year)) +
1707820334399:geom_bar(
1707820334418:stat = "identity",
1707820334435:color = "black",
1707820334450:size = .6,
1707820334466:position = position_dodge(width = 0.75)
1707820334480:)  +
1707820334495:scale_fill_manual(values = colors_dark2)
1707820388457:ggplot(mynd, aes(x = factor(Year), y = Value, fill = `µg S/g`)) +
1707820388472:geom_col(position = "dodge") +
1707820388489:theme_minimal() +
1707820388505:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820388519:theme(axis.text.x = element_text(angle = 45, hjust = 1))
1707820432290:ggplot(mynd, aes(fill = factor(Year), y = Value, x = `µg S/g`)) +
1707820432308:geom_col(position = "dodge") +
1707820432323:theme_minimal() +
1707820432340:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820432357:theme(axis.text.x = element_text(angle = 45, hjust = 1))
1707820469427:ggplot(mynd, aes(fill = factor(Year), y = Value, x = `µg S/g`)) +
1707820469445:geom_col(position = "dodge") +
1707820469464:theme_minimal() +
1707820469479:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820469493:theme(axis.text.x = element_text(angle = 45, hjust = 1))  +
1707820469508:theme(legend.title = element_blank(),
1707820469522:plot.background = element_rect(fill = "white", color = NA)) +
1707820469537:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820469555:axis.text = element_text(size = 16), # Increase axis text
1707820469570:legend.text = element_text(size = 16),
1707820469584:plot.title = element_text(size = 18)) # Increase legend text
1707820504852:ggplot(mynd, aes(fill = factor(Year), y = Value, x = `µg S/g`)) +
1707820504874:geom_col(position = "dodge") +
1707820504896:theme_minimal() +
1707820504914:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820504930:scale_fill_manual(values = colors_dark2) +
1707820504947:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820504960:theme_minimal()+
1707820504973:theme(axis.text.x = element_text(angle = 45, hjust = 1))  +
1707820504989:theme(legend.title = element_blank(),
1707820505006:plot.background = element_rect(fill = "white", color = NA)) +
1707820505021:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820505038:axis.text = element_text(size = 16), # Increase axis text
1707820505051:legend.text = element_text(size = 16),
1707820505066:plot.title = element_text(size = 18)) # Increase legend text
1707820544163:ggplot(mynd, aes(fill = factor(Year), y = Value, x = `µg S/g`*0.001)) +
1707820544186:geom_col(position = "dodge") +
1707820544204:theme_minimal() +
1707820544219:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820544235:scale_fill_manual(values = colors_dark2) +
1707820544249:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820544265:theme_minimal()+
1707820544280:theme(axis.text.x = element_text(angle = 45, hjust = 1))  +
1707820544294:theme(legend.title = element_blank(),
1707820544307:plot.background = element_rect(fill = "white", color = NA)) +
1707820544322:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820544336:axis.text = element_text(size = 16), # Increase axis text
1707820544349:legend.text = element_text(size = 16),
1707820544362:plot.title = element_text(size = 18)) # Increase legend text
1707820557506:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707820557528:geom_col(position = "dodge") +
1707820557544:theme_minimal() +
1707820557559:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820557573:scale_fill_manual(values = colors_dark2) +
1707820557588:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820557603:theme_minimal()+
1707820557618:theme(axis.text.x = element_text(angle = 45, hjust = 1))  +
1707820557632:theme(legend.title = element_blank(),
1707820557646:plot.background = element_rect(fill = "white", color = NA)) +
1707820557665:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820557683:axis.text = element_text(size = 16), # Increase axis text
1707820557700:legend.text = element_text(size = 16),
1707820557715:plot.title = element_text(size = 18)) # Increase legend text
1707820592706:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707820592731:geom_col(position = "dodge") +
1707820592753:theme_minimal() +
1707820592769:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820592783:scale_fill_manual(values = colors_dark2) +
1707820592798:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820592812:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707820592831:theme(axis.text.x = element_text(angle = 45, hjust = 1))  +
1707820592853:theme(legend.title = element_blank(),
1707820592868:plot.background = element_rect(fill = "white", color = NA)) +
1707820592883:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820592898:axis.text = element_text(size = 16), # Increase axis text
1707820592912:legend.text = element_text(size = 16),
1707820592927:plot.title = element_text(size = 18)) # Increase legend text
1707820605356:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707820605375:geom_bar(position = "dodge") +
1707820605389:theme_minimal() +
1707820605405:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820605418:scale_fill_manual(values = colors_dark2) +
1707820605431:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820605445:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707820605458:theme(axis.text.x = element_text(angle = 45, hjust = 1))  +
1707820605471:theme(legend.title = element_blank(),
1707820605487:plot.background = element_rect(fill = "white", color = NA)) +
1707820605502:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820605515:axis.text = element_text(size = 16), # Increase axis text
1707820605529:legend.text = element_text(size = 16),
1707820605543:plot.title = element_text(size = 18)) # Increase legend text
1707820614901:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707820614924:geom_bar(position = "dodge") +
1707820614943:theme_minimal() +
1707820614958:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820614973:scale_fill_manual(values = colors_dark2) +
1707820614988:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820615004:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707820615019:theme(legend.title = element_blank(),
1707820615033:plot.background = element_rect(fill = "white", color = NA)) +
1707820615049:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820615062:axis.text = element_text(size = 16), # Increase axis text
1707820615077:legend.text = element_text(size = 16),
1707820615093:plot.title = element_text(size = 18)) # Increase legend text
1707820652977:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707820652997:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707820653016:theme_minimal() +
1707820653030:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820653046:scale_fill_manual(values = colors_dark2) +
1707820653059:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820653073:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707820653087:theme(legend.title = element_blank(),
1707820653100:plot.background = element_rect(fill = "white", color = NA)) +
1707820653115:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820653130:axis.text = element_text(size = 16), # Increase axis text
1707820653145:legend.text = element_text(size = 16),
1707820653159:plot.title = element_text(size = 18)) # Increase legend text
1707820722345:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707820722362:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75))
1707820809007:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707820809030:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707820809045:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707820809058:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707820809073:scale_fill_manual(values = colors_dark2) +
1707820809087:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707820809100:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707820809114:theme_minimal() +
1707820809130:theme(legend.title = element_blank(),
1707820809146:plot.background = element_rect(fill = "white", color = NA)) +
1707820809159:theme(axis.title = element_text(size = 16), # Increase axis titles
1707820809174:axis.text = element_text(size = 16), # Increase axis text
1707820809189:legend.text = element_text(size = 16),
1707820809203:plot.title = element_text(size = 18)) # Increase legend text
1707821110474:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821110490:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821110506:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821110522:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821110536:scale_fill_manual(values = colors_dark2) +
1707821110549:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707821110562:#scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707821110576:theme_minimal() +
1707821110591:theme(legend.title = element_blank(),
1707821110605:plot.background = element_rect(fill = "white", color = NA)) +
1707821110617:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821110628:axis.text = element_text(size = 16), # Increase axis text
1707821110639:legend.text = element_text(size = 16),
1707821110650:plot.title = element_text(size = 18)) # Increase legend text
1707821138363:ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821138381:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821138397:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821138412:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821138426:scale_fill_manual(values = colors_dark2) +
1707821138440:labs(title = "",  y = "S", x = "") +
1707821138455:#scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707821138469:theme_minimal() +
1707821138482:theme(legend.title = element_blank(),
1707821138497:plot.background = element_rect(fill = "white", color = NA)) +
1707821138510:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821138524:axis.text = element_text(size = 16), # Increase axis text
1707821138542:legend.text = element_text(size = 16),
1707821138562:plot.title = element_text(size = 18)) # Increase legend text
1707821218412:########
1707821218432:#mynd 42
1707821218446:########
1707821218461:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821218473:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821218487:names_to = "Year",
1707821218502:values_to = "Value",
1707821218516:names_prefix = "") %>%
1707821218529:mutate(Year = as.numeric(Year))
1707821220171:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821220190:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821220209:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821220225:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821220238:scale_fill_manual(values = colors_dark2) +
1707821220251:labs(title = "",  y = "S", x = "") +
1707821220264:theme_minimal() +
1707821220278:theme(legend.title = element_blank(),
1707821220291:plot.background = element_rect(fill = "white", color = NA)) +
1707821220305:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821220318:axis.text = element_text(size = 16), # Increase axis text
1707821220332:legend.text = element_text(size = 16),
1707821220345:plot.title = element_text(size = 18)) # Increase legend text
1707821225988:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707821226886:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707821565086:read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821565102:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821565115:names_to = "Year",
1707821565127:values_to = "Value",
1707821565141:names_prefix = "") %>%
1707821565155:mutate(Year = as.numeric(Year))
1707821585562:########
1707821585581:#mynd 43
1707821585602:########
1707821585621:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821585638:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821585657:names_to = "Year",
1707821585674:values_to = "Value",
1707821585690:names_prefix = "") %>%
1707821585707:mutate(Year = as.numeric(Year))
1707821590545:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821590571:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821590591:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821590608:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821590620:scale_fill_manual(values = colors_dark2) +
1707821590634:labs(title = "",  y = "S", x = "") +
1707821590648:theme_minimal() +
1707821590664:theme(legend.title = element_blank(),
1707821590679:plot.background = element_rect(fill = "white", color = NA)) +
1707821590693:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821590709:axis.text = element_text(size = 16), # Increase axis text
1707821590722:legend.text = element_text(size = 16),
1707821590739:plot.title = element_text(size = 18)) # Increase legend text
1707821597115:mynd
1707821607401:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821607416:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821607433:names_to = "Year",
1707821607448:values_to = "Value",
1707821607464:names_prefix = "") %>%
1707821607479:mutate(Year = as.numeric(Year))
1707821680885:########
1707821680909:#mynd 43
1707821680929:########
1707821680949:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821680965:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821680981:names_to = "Year",
1707821680998:values_to = "Value",
1707821681012:names_prefix = "") %>%
1707821681028:mutate(Year = as.numeric(Year))
1707821682010:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821682029:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821682051:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821682074:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821682094:scale_fill_manual(values = colors_dark2) +
1707821682109:labs(title = "",  y = "S", x = "") +
1707821682123:ggtitle("Hraunbreyskja")+
1707821682137:theme_minimal() +
1707821682153:theme(legend.title = element_blank(),
1707821682167:plot.background = element_rect(fill = "white", color = NA)) +
1707821682181:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821682196:axis.text = element_text(size = 16), # Increase axis text
1707821682210:legend.text = element_text(size = 16),
1707821682225:plot.title = element_text(size = 18)) # Increase legend text
1707821683771:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707821684794:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707821710999:########
1707821711017:#mynd 43
1707821711035:########
1707821711050:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821711065:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821711080:names_to = "Year",
1707821711094:values_to = "Value",
1707821711111:names_prefix = "") %>%
1707821711126:mutate(Year = as.numeric(Year))
1707821713284:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821713309:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821713327:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821713341:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821713354:scale_fill_manual(values = colors_dark2) +
1707821713369:labs(title = "",  y = "S", x = "") +
1707821713382:ggtitle("Hraunbreyskja")+
1707821713397:theme_minimal() +
1707821713413:theme(legend.title = element_blank(),
1707821713428:plot.background = element_rect(fill = "white", color = NA)) +
1707821713442:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821713456:axis.text = element_text(size = 16), # Increase axis text
1707821713470:legend.text = element_text(size = 16),
1707821713485:plot.title = element_text(size = 18)) # Increase legend text
1707821715979:p1
1707821744062:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821744075:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821744086:names_to = "Year",
1707821744098:values_to = "Value",
1707821744110:names_prefix = "") %>%
1707821744121:mutate(Year = as.numeric(Year))
1707821744153:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821744168:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821744183:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821744196:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821744210:scale_fill_manual(values = colors_dark2) +
1707821744224:labs(title = "",  y = "S", x = "") +
1707821744238:ggtitle("Hraunbreyskja")+
1707821744251:theme_minimal() +
1707821744264:theme(legend.title = element_blank(),
1707821744279:plot.background = element_rect(fill = "white", color = NA)) +
1707821744293:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821744307:axis.text = element_text(size = 16), # Increase axis text
1707821744321:legend.text = element_text(size = 16),
1707821744334:plot.title = element_text(size = 18)) # Increase legend text
1707821744471:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707821744488:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707821759352:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707821759366:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707821759376:names_to = "Year",
1707821759388:values_to = "Value",
1707821759399:names_prefix = "") %>%
1707821759411:mutate(Year = as.numeric(Year))
1707821759440:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707821759451:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707821759462:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707821759473:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707821759484:scale_fill_manual(values = colors_dark2) +
1707821759495:labs(title = "",  y = "S", x = "") +
1707821759506:ggtitle("Snepaskóf")+
1707821759517:theme_minimal() +
1707821759529:theme(legend.title = element_blank(),
1707821759539:plot.background = element_rect(fill = "white", color = NA)) +
1707821759551:theme(axis.title = element_text(size = 16), # Increase axis titles
1707821759562:axis.text = element_text(size = 16), # Increase axis text
1707821759572:legend.text = element_text(size = 16),
1707821759586:plot.title = element_text(size = 18)) # Increase legend text
1707821764188:p1
1707822035823:########
1707822035850:#mynd 43
1707822035869:########
1707822035885:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822035901:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822035917:names_to = "Year",
1707822035931:values_to = "Value",
1707822035946:names_prefix = "") %>%
1707822035960:mutate(Year = as.numeric(Year))
1707822039556:mynd
1707822070668:Filename <-  glue("./myndir/efnagreiningar/","mynd43",".png")
1707822071730:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707822227931:########
1707822227949:#mynd 42
1707822227963:########
1707822227981:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822227995:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822228009:names_to = "Year",
1707822228024:values_to = "Value",
1707822228037:names_prefix = "") %>%
1707822228051:mutate(Year = as.numeric(Year))
1707822228475:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707822228490:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707822228505:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707822228518:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707822228533:scale_fill_manual(values = colors_dark2) +
1707822228550:labs(title = "",  y = "S", x = "") +
1707822228563:ggtitle("Snepaskóf")+
1707822228576:theme_minimal() +
1707822228589:theme(legend.title = element_blank(),
1707822228604:plot.background = element_rect(fill = "white", color = NA)) +
1707822228618:theme(axis.title = element_text(size = 16), # Increase axis titles
1707822228631:axis.text = element_text(size = 16), # Increase axis text
1707822228645:legend.text = element_text(size = 16),
1707822228660:plot.title = element_text(size = 18)) # Increase legend text
1707822230721:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707822231429:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707822233283:########
1707822233305:#mynd 43
1707822233322:########
1707822233335:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822233349:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822233364:names_to = "Year",
1707822233380:values_to = "Value",
1707822233395:names_prefix = "") %>%
1707822233410:mutate(Year = as.numeric(Year))
1707822234977:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707822234995:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707822235011:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707822235025:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707822235039:scale_fill_manual(values = colors_dark2) +
1707822235054:labs(title = "",  y = "S", x = "") +
1707822235067:ggtitle("Hraunbreyskja")+
1707822235081:theme_minimal() +
1707822235095:theme(legend.title = element_blank(),
1707822235109:plot.background = element_rect(fill = "white", color = NA)) +
1707822235122:theme(axis.title = element_text(size = 16), # Increase axis titles
1707822235135:axis.text = element_text(size = 16), # Increase axis text
1707822235150:legend.text = element_text(size = 16),
1707822235166:plot.title = element_text(size = 18)) # Increase legend text
1707822236713:Filename <-  glue("./myndir/efnagreiningar/","mynd43",".png")
1707822237268:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707822254496:########
1707822254514:#mynd 44
1707822254535:########
1707822254550:mynd <- read.table("mynd44.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822254565:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822254580:names_to = "Year",
1707822254594:values_to = "Value",
1707822254609:names_prefix = "") %>%
1707822254623:mutate(Year = as.numeric(Year))
1707822257811:mynd
1707822310477:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = `µg S/g`)) +
1707822310498:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707822310515:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707822310530:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707822310544:scale_fill_manual(values = colors_dark2) +
1707822310558:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707822310574:ggtitle("Snepaskóf")+
1707822310590:theme_minimal() +
1707822310605:theme(legend.title = element_blank(),
1707822310622:plot.background = element_rect(fill = "white", color = NA)) +
1707822310637:theme(axis.title = element_text(size = 16), # Increase axis titles
1707822310652:axis.text = element_text(size = 16), # Increase axis text
1707822310664:legend.text = element_text(size = 16),
1707822310677:plot.title = element_text(size = 18)) # Increase legend text
1707822312555:Filename <-  glue("./myndir/efnagreiningar/","mynd44",".png")
1707822313521:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707822340916:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = `µg F/g`)) +
1707822340937:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707822340960:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707822340977:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707822340994:scale_fill_manual(values = colors_dark2) +
1707822341009:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707822341024:ggtitle("Snepaskóf")+
1707822341040:theme_minimal() +
1707822341056:theme(legend.title = element_blank(),
1707822341073:plot.background = element_rect(fill = "white", color = NA)) +
1707822341088:theme(axis.title = element_text(size = 16), # Increase axis titles
1707822341104:axis.text = element_text(size = 16), # Increase axis text
1707822341118:legend.text = element_text(size = 16),
1707822341132:plot.title = element_text(size = 18)) # Increase legend text
1707822343827:Filename <-  glue("./myndir/efnagreiningar/","mynd44",".png")
1707822344249:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707822583881:########
1707822583899:#mynd 45
1707822583917:########
1707822583932:mynd <- read.table("mynd44.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822583946:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822583959:names_to = "Year",
1707822583969:values_to = "Value",
1707822583981:names_prefix = "") %>%
1707822583992:mutate(Year = as.numeric(Year))
1707822588449:mynd
1707822648816:########
1707822648833:#mynd 45
1707822648851:########
1707822648869:mynd <- read.table("mynd45.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822648882:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822648897:names_to = "Year",
1707822648912:values_to = "Value",
1707822648927:names_prefix = "") %>%
1707822648943:mutate(Year = as.numeric(Year))
1707822651708:mynd
1707822659962:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = `µg F/g`)) +
1707822659985:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707822660005:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707822660025:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707822660043:scale_fill_manual(values = colors_dark2) +
1707822660056:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707822660070:ggtitle("Hraunbreiskja")+
1707822660086:theme_minimal() +
1707822660104:theme(legend.title = element_blank(),
1707822660120:plot.background = element_rect(fill = "white", color = NA)) +
1707822660134:theme(axis.title = element_text(size = 16), # Increase axis titles
1707822660147:axis.text = element_text(size = 16), # Increase axis text
1707822660160:legend.text = element_text(size = 16),
1707822660175:plot.title = element_text(size = 18)) # Increase legend text
1707822662641:Filename <-  glue("./myndir/efnagreiningar/","mynd45",".png")
1707822663266:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707822768504:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822768522:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822768540:names_to = "Year",
1707822768557:values_to = "Value",
1707822768570:names_prefix = "") %>%
1707822768584:mutate(Year = as.numeric(Year))
1707822772628:mynd
1707822807927:colnames(mynd[,1])
1707822819470:colnames(mynd[,1]) <- "Stadir"
1707822823330:mynd
1707822843910:colnames(mynd)[1] <- "Stadir"
1707822847257:mynd
1707822968005:########
1707822968023:#mynd 45
1707822968040:########
1707822968055:mynd <- read.table("mynd45.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707822968070:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707822968084:names_to = "Year",
1707822968099:values_to = "Value",
1707822968114:names_prefix = "") %>%
1707822968129:mutate(Year = as.numeric(Year))
1707822968436:colnames(mynd)[1] <- "Stadir"
1707822969394:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = Stadir)) +
1707822969418:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707822969439:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707822969459:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707822969475:scale_fill_manual(values = colors_dark2) +
1707822969491:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707822969506:ggtitle("Hraunbreiskja")+
1707822969520:theme_minimal() +
1707822969535:theme(legend.title = element_blank(),
1707822969551:plot.background = element_rect(fill = "white", color = NA)) +
1707822969567:theme(axis.title = element_text(size = 16), # Increase axis titles
1707822969588:axis.text = element_text(size = 16), # Increase axis text
1707822969604:legend.text = element_text(size = 16),
1707822969622:plot.title = element_text(size = 18)) # Increase legend text
1707823039081:unique(mynd$Stadir)
1707823073993:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707823074015:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707823074035:names_to = "Year",
1707823074051:values_to = "Value",
1707823074065:names_prefix = "") %>%
1707823074078:mutate(Year = as.numeric(Year))
1707823074109:colnames(mynd)[1] <- "Stadir"
1707823074124:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823074149:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = Stadir)) +
1707823074163:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823074177:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707823074192:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707823074206:scale_fill_manual(values = colors_dark2) +
1707823074219:labs(title = "",  y = "S", x = "") +
1707823074233:ggtitle("Snepaskóf")+
1707823074247:theme_minimal() +
1707823074260:theme(legend.title = element_blank(),
1707823074274:plot.background = element_rect(fill = "white", color = NA)) +
1707823074289:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823074305:axis.text = element_text(size = 16), # Increase axis text
1707823074318:legend.text = element_text(size = 16),
1707823074333:plot.title = element_text(size = 18)) # Increase legend text
1707823074380:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707823074394:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823121652:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707823121668:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707823121686:names_to = "Year",
1707823121702:values_to = "Value",
1707823121714:names_prefix = "") %>%
1707823121727:mutate(Year = as.numeric(Year))
1707823121755:colnames(mynd)[1] <- "Stadir"
1707823121768:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823121793:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = Stadir)) +
1707823121807:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823121822:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707823121836:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707823121851:scale_fill_manual(values = colors_dark2) +
1707823121864:labs(title = "",  y = "S", x = "") +
1707823121879:ggtitle("Snepaskóf")+
1707823121893:theme_minimal() +
1707823121908:theme(legend.title = element_blank(),
1707823121924:plot.background = element_rect(fill = "white", color = NA)) +
1707823121936:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823121949:axis.text = element_text(size = 16), # Increase axis text
1707823121964:legend.text = element_text(size = 16),
1707823121980:plot.title = element_text(size = 18)) # Increase legend text
1707823122018:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707823122035:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823122602:########
1707823122618:#mynd 43
1707823122635:########
1707823122653:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707823122672:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707823122686:names_to = "Year",
1707823122702:values_to = "Value",
1707823122719:names_prefix = "") %>%
1707823122732:mutate(Year = as.numeric(Year))
1707823122762:colnames(mynd)[1] <- "Stadir"
1707823122778:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823122804:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = Stadir)) +
1707823122819:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823122833:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707823122847:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707823122861:scale_fill_manual(values = colors_dark2) +
1707823122875:labs(title = "",  y = "S", x = "") +
1707823122889:ggtitle("Hraunbreyskja")+
1707823122904:theme_minimal() +
1707823122921:theme(legend.title = element_blank(),
1707823122935:plot.background = element_rect(fill = "white", color = NA)) +
1707823122952:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823122971:axis.text = element_text(size = 16), # Increase axis text
1707823122988:legend.text = element_text(size = 16),
1707823123008:plot.title = element_text(size = 18)) # Increase legend text
1707823123050:Filename <-  glue("./myndir/efnagreiningar/","mynd43",".png")
1707823123068:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823123610:########
1707823123623:#mynd 44
1707823123637:########
1707823123651:mynd <- read.table("mynd44.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707823123664:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707823123678:names_to = "Year",
1707823123692:values_to = "Value",
1707823123707:names_prefix = "") %>%
1707823123720:mutate(Year = as.numeric(Year))
1707823123746:colnames(mynd)[1] <- "Stadir"
1707823123759:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823123786:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = Stadir)) +
1707823123800:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823123816:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707823123832:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707823123845:scale_fill_manual(values = colors_dark2) +
1707823123861:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707823123874:ggtitle("Snepaskóf")+
1707823123889:theme_minimal() +
1707823123902:theme(legend.title = element_blank(),
1707823123916:plot.background = element_rect(fill = "white", color = NA)) +
1707823123929:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823123943:axis.text = element_text(size = 16), # Increase axis text
1707823123957:legend.text = element_text(size = 16),
1707823123971:plot.title = element_text(size = 18)) # Increase legend text
1707823124004:Filename <-  glue("./myndir/efnagreiningar/","mynd44",".png")
1707823124018:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823124561:########
1707823124572:#mynd 45
1707823124583:########
1707823124595:mynd <- read.table("mynd45.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707823124606:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707823124617:names_to = "Year",
1707823124628:values_to = "Value",
1707823124640:names_prefix = "") %>%
1707823124651:mutate(Year = as.numeric(Year))
1707823124674:colnames(mynd)[1] <- "Stadir"
1707823124686:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823124706:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = Stadir)) +
1707823124718:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823124729:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707823124740:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707823124751:scale_fill_manual(values = colors_dark2) +
1707823124762:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707823124774:ggtitle("Hraunbreiskja")+
1707823124786:theme_minimal() +
1707823124798:theme(legend.title = element_blank(),
1707823124809:plot.background = element_rect(fill = "white", color = NA)) +
1707823124821:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823124836:axis.text = element_text(size = 16), # Increase axis text
1707823124848:legend.text = element_text(size = 16),
1707823124860:plot.title = element_text(size = 18)) # Increase legend text
1707823124886:Filename <-  glue("./myndir/efnagreiningar/","mynd45",".png")
1707823124898:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823326396:######
1707823326411:mynd <- read.table("mynd45.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707823326427:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707823326444:names_to = "Year",
1707823326460:values_to = "Value",
1707823326474:names_prefix = "") %>%
1707823326488:mutate(Year = as.numeric(Year))
1707823326516:colnames(mynd)[1] <- "Stadir"
1707823326531:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823326557:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = Stadir)) +
1707823326573:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823326588:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707823326601:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707823326615:scale_fill_manual(values = colors_dark2) +
1707823326630:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707823326644:ggtitle("Hraunbreiskja")+
1707823326660:theme_minimal() +
1707823326677:theme(legend.title = element_blank(),
1707823326695:plot.background = element_rect(fill = "white", color = NA)) +
1707823326710:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823326728:axis.text = element_text(size = 16), # Increase axis text
1707823326743:legend.text = element_text(size = 16),
1707823326758:plot.title = element_text(size = 18)) # Increase legend text
1707823326797:Filename <-  glue("./myndir/efnagreiningar/","mynd45",".png")
1707823326811:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823449837:mynd <- read.table("mynd40.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707823449854:pivot_longer(cols = c("hraunbreyskja","snepaskóf" ), names_to = "Gerd", values_to = "Heild" ) |>
1707823449872:mutate(Gerd = case_when(
1707823449888:Gerd == "snepaskóf"~"Snepaskóf",
1707823449902:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707823449915:))
1707823456555:mynd
1707823522627:mynd <- read.table("mynd40.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707823522643:pivot_longer(cols = c("hraunbreyskja","snepaskóf" ), names_to = "Gerd", values_to = "Heild" ) |>
1707823522656:mutate(Gerd = case_when(
1707823522668:Gerd == "snepaskóf"~"Snepaskóf",
1707823522679:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707823522689:))
1707823523449:colnames(mynd)[1] <- "Stadir"
1707823524099:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823524721:mynd$Gerd <- factor(mynd$Gerd, levels = c("Snepaskóf","Hraunbreyskja"))
1707823526736:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild*0.01, fill = Stadir)) +
1707823526756:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823526773:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707823526789:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707823526801:labs(title = "",  y = "S", x = "") +
1707823526815:theme_minimal()+
1707823526828:ggtitle("Brennisteinn")+
1707823526843:theme(legend.title = element_blank(),
1707823526861:plot.background = element_rect(fill = "white", color = NA)) +
1707823526877:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823526892:axis.text = element_text(size = 16), # Increase axis text
1707823526907:legend.text = element_text(size = 16),
1707823526921:plot.title = element_text(size = 18)) # Increase legend text
1707823529900:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707823530347:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823592186:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild*0.001, fill = Stadir)) +
1707823592201:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823592218:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707823592235:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%")) +
1707823592249:labs(title = "",  y = "S", x = "") +
1707823592264:theme_minimal()+
1707823592278:ggtitle("Brennisteinn")+
1707823592292:theme(legend.title = element_blank(),
1707823592309:plot.background = element_rect(fill = "white", color = NA)) +
1707823592324:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823592338:axis.text = element_text(size = 16), # Increase axis text
1707823592350:legend.text = element_text(size = 16),
1707823592366:plot.title = element_text(size = 18)) # Increase legend text
1707823592581:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707823592823:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823620812:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild*0.001, fill = Stadir)) +
1707823620839:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823620860:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707823620877:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707823620894:labs(title = "",  y = "S", x = "") +
1707823620915:theme_minimal()+
1707823620932:ggtitle("Brennisteinn")+
1707823620948:theme(legend.title = element_blank(),
1707823620963:plot.background = element_rect(fill = "white", color = NA)) +
1707823620976:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823620990:axis.text = element_text(size = 16), # Increase axis text
1707823621003:legend.text = element_text(size = 16),
1707823621017:plot.title = element_text(size = 18)) # Increase legend text
1707823621835:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707823622019:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707823824812:mynd <- read.table("mynd41.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707823824833:pivot_longer(cols = c("snepaskóf","hraunbreyskja"), names_to = "Gerd", values_to = "Heild" ) |>
1707823824850:mutate(Gerd = case_when(
1707823824866:Gerd == "snepaskóf"~"Snepaskóf",
1707823824880:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707823824893:))
1707823825963:colnames(mynd)[1] <- "Stadir"
1707823826413:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707823826957:mynd$Gerd <- factor(mynd$Gerd, levels = c("Snepaskóf","Hraunbreyskja"))
1707823828916:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild, fill = Stadir)) +
1707823828938:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707823828956:scale_fill_manual(values = colors_dark2) +
1707823828972:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707823828988:theme_minimal()+
1707823829003:ggtitle("Flúor")+
1707823829019:theme(legend.title = element_blank(),
1707823829034:plot.background = element_rect(fill = "white", color = NA)) +
1707823829050:theme(axis.title = element_text(size = 16), # Increase axis titles
1707823829064:axis.text = element_text(size = 16), # Increase axis text
1707823829079:legend.text = element_text(size = 16),
1707823829093:plot.title = element_text(size = 18)) # Increase legend text
1707823831211:Filename <-  glue("./myndir/efnagreiningar/","mynd41",".png")
1707823832056:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707825086529:joined_data <- data %>%
1707825086545:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825086562:select(species, Type, Reitur, km, everything()) |>
1707825086579:#select(-c(`1999`)) |>
1707825086594:filter(!species %in% "Ber klöpp" &
1707825086609:!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62") &
1707825086623:species == "Ramalina subfarinacea" ) |>
1707825086639:filter(!species %in% "Ber klöpp")
1707825098396:str(joined_data)
1707825367764:joined_data
1707825394140:joined_data <- data %>%
1707825394199:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825394226:select(species, Type, Reitur, km, everything()) |>
1707825394243:filter(!species %in% "Ber klöpp" |
1707825394257:!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707825394271:"R55", "R57", "R58", "R59", "R61", "R62") |
1707825394287:species == "Ramalina subfarinacea" ) |>
1707825394302:filter(!species %in% "Ber klöpp")
1707825396708:joined_data
1707825423232:joined_data <- data %>%
1707825423250:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825423266:select(species, Type, Reitur, km, everything()) |>
1707825423283:filter(!species %in% "Ber klöpp" &
1707825423298:!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707825423312:"R55", "R57", "R58", "R59", "R61", "R62") &
1707825423327:species == "Ramalina subfarinacea" ) |>
1707825423343:filter(!species %in% "Ber klöpp")
1707825424147:joined_data
1707825688688:joined_data <- data %>%
1707825688708:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825688724:select(species, Type, Reitur, km, everything()) |>
1707825688736:filter(!species %in% "Ber klöpp" &
1707825688750:!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707825688765:"R55", "R57", "R58", "R59", "R61", "R62") &
1707825688779:species == "Ramalina subfarinacea" )
1707825690975:joined_data
1707825701939:joined_data <- data %>%
1707825701956:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825701977:select(species, Type, Reitur, km, everything()) |>
1707825701991:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707825702004:"R55", "R57", "R58", "R59", "R61", "R62") &
1707825702021:species == "Ramalina subfarinacea" )
1707825703916:joined_data
1707825719913:joined_data <- data %>%
1707825719933:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825719950:select(species, Type, Reitur, km, everything()) |>
1707825719964:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707825719978:"R55", "R57", "R58", "R59", "R61", "R62") &
1707825719992:species %in% "Ramalina subfarinacea" )
1707825722475:joined_data
1707825730494:joined_data <- data %>%
1707825730514:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825730530:select(species, Type, Reitur, km, everything()) |>
1707825730545:filter( species %in% "Ramalina subfarinacea" )
1707825732402:joined_data
1707825774035:joined_data <- data %>%
1707825774059:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825774077:select(species, Type, Reitur, km, everything()) |>
1707825774093:#select(-c(`1999`)) |>
1707825774108:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707825774123:mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707825774138:filter(!species %in% "Ber klöpp")
1707825799852:joined_data[joined_data$species== "Ramalina subfarinacea",]
1707825895381:joined_data <- data %>%
1707825895404:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825895423:select(species, Type, Reitur, km, everything()) |>
1707825895440:filter( species %in% "Ramalina subfarinacea" )
1707825898218:joined_data[joined_data$species== "Ramalina subfarinacea",]
1707825901379:joined_data
1707825921004:joined_data <- data %>%
1707825921020:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825921040:select(species, Type, Reitur, km, everything()) |>
1707825921055:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707825921070:"R55", "R57", "R58", "R59", "R61", "R62") &
1707825921084:species %in% "Ramalina subfarinacea" )
1707825923732:joined_data
1707825954316:joined_data <- data %>%
1707825954334:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707825954346:select(species, Type, Reitur, km, everything()) |>
1707825954358:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707825954369:"R55", "R57", "R58", "R59", "R61", "R62") &
1707825954380:species %in% "Ramalina subfarinacea" ) |>
1707825954391:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707825954402:names_to = "Year",
1707825954413:values_to = "Value",
1707825954424:names_prefix = "")
1707825959536:joined_data
1707826051033:ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707826051053:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707826051070:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707826051086:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707826051102:scale_fill_manual(values = colors_dark2) +
1707826051117:labs(title = "",  y = "Þekja", x = "") +
1707826051132:ggtitle("Hraunbreiskja")+
1707826051148:theme_minimal() +
1707826051164:theme(legend.title = element_blank(),
1707826051179:plot.background = element_rect(fill = "white", color = NA)) +
1707826051194:theme(axis.title = element_text(size = 16), # Increase axis titles
1707826051209:axis.text = element_text(size = 16), # Increase axis text
1707826051224:legend.text = element_text(size = 16),
1707826051240:plot.title = element_text(size = 18)) # Increase legend text
1707826070155:ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707826070175:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75))
1707826089443:colors_dark2 <- brewer.pal(9, "Accent")
1707826136868:joined_data <- data %>%
1707826136891:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707826136909:select(species, Type, Reitur, km, everything()) |>
1707826136924:select(-c(`1997`)) |>
1707826136939:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707826136952:"R55", "R57", "R58", "R59", "R61", "R62") &
1707826136968:species %in% "Ramalina subfarinacea" ) |>
1707826136987:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707826137002:names_to = "Year",
1707826137017:values_to = "Value",
1707826137035:names_prefix = "")
1707826138084:ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707826138104:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707826138119:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707826138136:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707826138152:scale_fill_manual(values = colors_dark2) +
1707826138166:labs(title = "",  y = "Þekja", x = "") +
1707826138180:ggtitle("Hraunbreiskja")+
1707826138195:theme_minimal() +
1707826138210:theme(legend.title = element_blank(),
1707826138225:plot.background = element_rect(fill = "white", color = NA)) +
1707826138241:theme(axis.title = element_text(size = 16), # Increase axis titles
1707826138256:axis.text = element_text(size = 16), # Increase axis text
1707826138270:legend.text = element_text(size = 16),
1707826138284:plot.title = element_text(size = 18)) # Increase legend text
1707826170194:ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707826170210:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707826170228:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707826170244:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707826170259:scale_fill_manual(values = colors_dark2) +
1707826170274:labs(title = "",  y = "Þekja", x = "") +
1707826170289:ggtitle("Klettastrý")+
1707826170305:theme_minimal() +
1707826170319:theme(legend.title = element_blank(),
1707826170334:plot.background = element_rect(fill = "white", color = NA)) +
1707826170349:theme(axis.title = element_text(size = 16), # Increase axis titles
1707826170363:axis.text = element_text(size = 16), # Increase axis text
1707826170379:legend.text = element_text(size = 16),
1707826170392:plot.title = element_text(size = 18)) # Increase legend text
1707826188644:joined_data
1707826206606:print(joined_data, n=200)
1707826459852:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707826459873:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707826459892:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707826459908:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707826459922:scale_fill_manual(values = colors_dark2) +
1707826459936:labs(title = "",  y = "Þekja", x = "") +
1707826459951:ggtitle("Klettastrý")+
1707826459966:theme_minimal() +
1707826459980:theme(legend.title = element_blank(),
1707826459997:plot.background = element_rect(fill = "white", color = NA)) +
1707826460011:theme(axis.title = element_text(size = 16), # Increase axis titles
1707826460028:axis.text = element_text(size = 16), # Increase axis text
1707826460043:legend.text = element_text(size = 16),
1707826460056:plot.title = element_text(size = 18)) # Increase legend text
1707826460917:#ath í R_2023, reit 33 er ártalið 1997 með 1% klettastrý. Er það talan fyrir árið 1999 í mynd 37 í skýrslunni?
1707826460942:Filename <-  glue("./myndir/","mynd37",".png")
1707826461104:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707826574198:joined_data <- data %>%
1707826574213:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707826574231:select(species, Type, Reitur, km, everything()) |>
1707826574248:select(-c(`1997`)) |>
1707826574262:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707826574279:"R55", "R57", "R58", "R59", "R61", "R62") &
1707826574293:species %in% "Ramalina subfarinacea" )
1707826583116:dput(joined_data)
1707826998250:joined_data <- data %>%
1707826998268:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707826998288:select(species, Type, Reitur, km, everything()) |>
1707826998305:#select(-c(`1997`)) |>
1707826998322:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707826998338:"R55", "R57", "R58", "R59", "R61", "R62") &
1707826998356:species %in% "Ramalina subfarinacea" )
1707827001042:dput(joined_data)
1707827040971:joined_data <- data %>%
1707827040988:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707827041006:select(species, Type, Reitur, km, everything()) |>
1707827041023:select(-c(`1997`)) |>
1707827041037:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707827041051:"R55", "R57", "R58", "R59", "R61", "R62") &
1707827041065:species %in% "Ramalina subfarinacea" )
1707827046933:dput(joined_data)
1707827191083:#dput(joined_data)
1707827191104:structure(list(species = c("Ramalina subfarinacea", "Ramalina subfarinacea",
1707827191123:"Ramalina subfarinacea"), Type = c("Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur"),
1707827191138:Reitur = c("R33","R56", "R60"), km = c(1.4, 2.3, 2.4), `1976` = c(20, NA, NA),
1707827191150:`2006` = c(6, 9, 1), `2011` = c(5, 1, 0.5), `2014` = c(3,1, 0.5), `2017` = c(10, 2, 1),
1707827191167:`2020` = c(15, 3, 1), `2023` = c(17,8, 2), `1999` = c(1, 20, 1),
1707827191181:Fluor = c(1L, 0L, 0L), Brennisteinn = c(1L,1L, 1L), Stadur = c("Stekkjarás", "Akrafjall", "Akrafjall"),
1707827191196:Mynd = c("7. mynd", "13. mynd", "13. mynd")), class = "data.frame", row.names = c(NA,-3L))|>
1707827191209:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707827191223:names_to = "Year",
1707827191237:values_to = "Value",
1707827191252:names_prefix = "")
1707827211673:#dput(joined_data)
1707827211692:mynd <- structure(list(species = c("Ramalina subfarinacea", "Ramalina subfarinacea",
1707827211710:"Ramalina subfarinacea"), Type = c("Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur"),
1707827211726:Reitur = c("R33","R56", "R60"), km = c(1.4, 2.3, 2.4), `1976` = c(20, NA, NA),
1707827211742:`2006` = c(6, 9, 1), `2011` = c(5, 1, 0.5), `2014` = c(3,1, 0.5), `2017` = c(10, 2, 1),
1707827211758:`2020` = c(15, 3, 1), `2023` = c(17,8, 2), `1999` = c(1, 20, 1),
1707827211773:Fluor = c(1L, 0L, 0L), Brennisteinn = c(1L,1L, 1L), Stadur = c("Stekkjarás", "Akrafjall", "Akrafjall"),
1707827211786:Mynd = c("7. mynd", "13. mynd", "13. mynd")), class = "data.frame", row.names = c(NA,-3L))|>
1707827211803:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707827211820:names_to = "Year",
1707827211835:values_to = "Value",
1707827211851:names_prefix = "")
1707827214315:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707827214366:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707827214380:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707827214396:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707827214415:scale_fill_manual(values = colors_dark2) +
1707827214426:labs(title = "",  y = "Þekja", x = "") +
1707827214438:ggtitle("Klettastrý")+
1707827214449:theme_minimal() +
1707827214461:theme(legend.title = element_blank(),
1707827214472:plot.background = element_rect(fill = "white", color = NA)) +
1707827214482:theme(axis.title = element_text(size = 16), # Increase axis titles
1707827214494:axis.text = element_text(size = 16), # Increase axis text
1707827214505:legend.text = element_text(size = 16),
1707827214515:plot.title = element_text(size = 18)) # Increase legend text
1707827217522:#ath í R_2023, reit 33 er ártalið 1997 með 1% klettastrý. Er það talan fyrir árið 1999 í mynd 37 í skýrslunni?
1707827217544:Filename <-  glue("./myndir/","mynd37",".png")
1707827217861:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707830721376:joined_data <- data %>%
1707830721394:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707830721406:select(species, Type, Reitur, km, everything()) |>
1707830721418:#select(-c(`1997`)) |>
1707830721430:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707830721441:"R55", "R57", "R58", "R59", "R61", "R62") &
1707830721452:species %in% "Parmelia saxatilis" )
1707830726972:joined_data
1707830868789:joined_data <- data %>%
1707830868807:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707830868823:select(species, Type, Reitur, km, everything()) |>
1707830868840:#select(-c(`1997`)) |>
1707830868855:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707830868869:"R55", "R57", "R58", "R59", "R61", "R62") &
1707830868883:species %in% "Parmelia saxatilis" ) |>
1707830868897:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707830868912:names_to = "Year",
1707830868928:values_to = "Value",
1707830868942:names_prefix = "")
1707830872620:joined_data
1707830901140:unique(joined_data$Reitur)
1707831005465:joined_data <- data %>%
1707831005483:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707831005499:select(species, Type, Reitur, km, everything()) |>
1707831005517:#select(-c(`1997`)) |>
1707831005533:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707831005549:"R55", "R57", "R58", "R59", "R61", "R62") &
1707831005565:species %in% "Parmelia saxatilis" ) |>
1707831005580:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707831005594:names_to = "Year",
1707831005609:values_to = "Value",
1707831005624:names_prefix = "") |>
1707831005639:filter(Reitur %in% c("R11", "R33", "R34", "R56", "R60"))
1707831010678:unique(joined_data$Reitur)
1707831056299:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707831056320:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707831056338:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707831056353:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707831056368:scale_fill_manual(values = colors_dark2) +
1707831056381:labs(title = "",  y = "Þekja", x = "") +
1707831056394:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707831056409:theme_minimal() +
1707831056424:theme(legend.title = element_blank(),
1707831056439:plot.background = element_rect(fill = "white", color = NA)) +
1707831056453:theme(axis.title = element_text(size = 16), # Increase axis titles
1707831056468:axis.text = element_text(size = 16), # Increase axis text
1707831056483:legend.text = element_text(size = 16),
1707831056499:plot.title = element_text(size = 18)) # Increase legend text
1707831059358:p1
1707831085407:joined_data$Year
1707831090061:unique(joined_data$Year)
1707831104503:joined_data <- data %>%
1707831104524:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707831104540:select(species, Type, Reitur, km, everything()) |>
1707831104557:select(-c(`1999`)) |>
1707831104571:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707831104587:"R55", "R57", "R58", "R59", "R61", "R62") &
1707831104601:species %in% "Parmelia saxatilis" ) |>
1707831104615:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707831104628:names_to = "Year",
1707831104642:values_to = "Value",
1707831104656:names_prefix = "") |>
1707831104671:filter(Reitur %in% c("R11", "R33", "R34", "R56", "R60"))
1707831105520:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707831105536:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707831105553:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707831105565:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707831105576:scale_fill_manual(values = colors_dark2) +
1707831105590:labs(title = "",  y = "Þekja", x = "") +
1707831105604:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707831105618:theme_minimal() +
1707831105632:theme(legend.title = element_blank(),
1707831105648:plot.background = element_rect(fill = "white", color = NA)) +
1707831105664:theme(axis.title = element_text(size = 16), # Increase axis titles
1707831105679:axis.text = element_text(size = 16), # Increase axis text
1707831105695:legend.text = element_text(size = 16),
1707831105711:plot.title = element_text(size = 18)) # Increase legend text
1707831108285:p1
1707831543294:joined_data <- data %>%
1707831543315:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707831543336:select(species, Type, Reitur, km, everything()) |>
1707831543353:#select(-c(`1999`)) |>
1707831543368:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707831543384:"R55", "R57", "R58", "R59", "R61", "R62") &
1707831543400:species %in% "Parmelia saxatilis" ) |>
1707831543415:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707831543431:names_to = "Year",
1707831543445:values_to = "Value",
1707831543460:names_prefix = "") |>
1707831543475:filter(Reitur %in% c("R11", "R33", "R34", "R56", "R60"))
1707831544361:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707831544378:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707831544395:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707831544410:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707831544426:scale_fill_manual(values = colors_dark2) +
1707831544440:labs(title = "",  y = "Þekja", x = "") +
1707831544454:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707831544469:theme_minimal() +
1707831544485:theme(legend.title = element_blank(),
1707831544501:plot.background = element_rect(fill = "white", color = NA)) +
1707831544516:theme(axis.title = element_text(size = 16), # Increase axis titles
1707831544532:axis.text = element_text(size = 16), # Increase axis text
1707831544548:legend.text = element_text(size = 16),
1707831544564:plot.title = element_text(size = 18)) # Increase legend text
1707831564126:#ath í R_2023, reit 33 er ártalið 1997 með 1% klettastrý. Er það talan fyrir árið 1999 í mynd 37 í skýrslunni?
1707831564145:Filename <-  glue("./myndir/","mynd38",".png")
1707831565542:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707831577100:colors_dark2
1707831668684:colors_dark2 <- brewer.pal(9, "Accent")
1707831679679:?brewer.pal
1707831704341:colors_dark2 <- brewer.pal(9, "Pastel1")
1707831706803:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707831706822:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707831706834:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707831706847:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707831706863:scale_fill_manual(values = colors_dark2) +
1707831706876:labs(title = "",  y = "Þekja", x = "") +
1707831706891:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707831706907:theme_minimal() +
1707831706924:theme(legend.title = element_blank(),
1707831706937:plot.background = element_rect(fill = "white", color = NA)) +
1707831706952:theme(axis.title = element_text(size = 16), # Increase axis titles
1707831706967:axis.text = element_text(size = 16), # Increase axis text
1707831706982:legend.text = element_text(size = 16),
1707831706996:plot.title = element_text(size = 18)) # Increase legend text
1707831709399:p1
1707831731445:colors_dark2 <- brewer.pal(9, "Set1")
1707831734533:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707831734550:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707831734564:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707831734579:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707831734593:scale_fill_manual(values = colors_dark2) +
1707831734608:labs(title = "",  y = "Þekja", x = "") +
1707831734622:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707831734634:theme_minimal() +
1707831734645:theme(legend.title = element_blank(),
1707831734656:plot.background = element_rect(fill = "white", color = NA)) +
1707831734673:theme(axis.title = element_text(size = 16), # Increase axis titles
1707831734687:axis.text = element_text(size = 16), # Increase axis text
1707831734700:legend.text = element_text(size = 16),
1707831734714:plot.title = element_text(size = 18)) # Increase legend text
1707831736640:p1
1707831830190:dput(joined_data)
1707831841036:joined_data <- data %>%
1707831841052:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707831841068:select(species, Type, Reitur, km, everything()) |>
1707831841084:#select(-c(`1999`)) |>
1707831841097:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707831841111:"R55", "R57", "R58", "R59", "R61", "R62") &
1707831841124:species %in% "Parmelia saxatilis" )
1707831842504:dput(joined_data)
1707832009356:mynd <-
1707832009381:structure(list(species = c("Parmelia saxatilis", "Parmelia saxatilis",
1707832009400:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009419:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009435:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009451:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009467:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009482:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009497:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009512:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832009529:"Parmelia saxatilis"), Type = c("Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009544:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009559:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009575:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009590:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009608:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009623:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009638:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009653:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832009668:"Blað- og runnfléttur"), Reitur = c("R11", "R12", "R13", "R14",
1707832009683:"R16", "R21", "R30", "R32", "R33", "R34", "R37", "R42", "R44",
1707832009697:"R45", "R47", "R48", "R49", "R51", "R52", "R56", "R60", "R64",
1707832009712:"R67", "R69", "R70", "R72", "R73"), km = c(1.9, 2, 2, 2, 8.7,
1707832009726:20.9, 3.2, 3.2, 1.4, 1.5, 3, 16.1, 16.1, 17.3, 17.3, 8.1, 8.1,
1707832009740:3.9, 3.9, 2.3, 2.4, 3.2, 5, 5, 5, 4, 4), `1976` = c(NA, 12, 1,
1707832009754:0.5, 1, 1, 7, 35, 40, NA, 50, 1, 20, NA, 1, 22, NA, 5, NA, NA,
1707832009769:NA, NA, NA, NA, NA, NA, NA), `1997` = c(NA, 3, NA, 1, 7, 5, 10,
1707832009785:2, 10, NA, 25, 1, 10, NA, 1, 28, NA, 12, 0.5, 2, 70, NA, NA,
1707832009800:NA, NA, NA, NA), `2006` = c(NA, 5, NA, 2, 10, 8, 13, NA, 13,
1707832009815:NA, 25, 1, 10, NA, 5, 30, NA, 16, 0.5, 4, 25, NA, NA, NA, NA,
1707832009829:NA, NA), `2011` = c(1, 9, 0.5, 1, 9, 7, 7, NA, 19, NA, 0.5, 0.5,
1707832009843:6, NA, 5, 27, NA, 13, NA, 3, 6, NA, NA, NA, NA, NA, NA), `2014` = c(1,
1707832009859:6, 0.5, NA, 8, 10, 2, NA, 26, NA, NA, 1, 4, NA, 5, 30, NA, 6,
1707832009873:0.5, 4, 4, NA, 20, 12, 1, 5, 8), `2017` = c(NA, 1, NA, NA, 6,
1707832009889:11, NA, NA, 50, 0.5, NA, 0.5, 6, 0.5, 6, 42, NA, 6, 1, 4, 6,
1707832009904:2, 22, 13, 8, 3, 8), `2020` = c(0.5, 0.5, NA, NA, 10, 7, NA,
1707832009919:NA, 53, NA, NA, 0.5, 2, 0.5, 5, 50, NA, 5, 0.5, 8, 7, 1, 23,
1707832009934:16, 4, 2, 10), `2023` = c(2, 0.5, NA, NA, 9, 10, NA, NA, 50,
1707832009952:NA, NA, 1, 5, 1, 9, 38, 1, NA, 2, 7, 9, 1, 33, 14, 3, 2, 14),
1707832009970:`1999` = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
1707832009985:NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
1707832010001:), Fluor = c(1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L,
1707832010016:0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
1707832010032:0L), Brennisteinn = c(1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L,
1707832010050:1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L,
1707832010066:0L, 0L, 0L), Stadur = c("Selás", "Bjarnarholt", "Bjarnarholt",
1707832010082:"Bjarnarholt", "Tíðaskarð", "Hvalfjarðarbotn", "Álfholt",
1707832010097:"Álfholt", "Stekkjarás", "Stekkjarás", "Kalmansá", "Hafnarbæli",
1707832010113:"Hafnarbæli", "Þyrilsnes", "Þyrilsnes", "Hvammsnes", "Hvammsnes",
1707832010127:"Ofan Hvalfjarðareyrar", "Ofan Hvalfjarðareyrar", "Akrafjall",
1707832010146:"Akrafjall", "Kalastaðakot", "Miðfellsmúli", "Gimbrapallar",
1707832010163:"Gimbrapallar", "Ofan við Gröf", "Ofan við Gröf"), Mynd = c("11. mynd",
1707832010177:"24. mynd", "24. mynd", "24. mynd", "31. mynd", "36. mynd",
1707832010191:"26. mynd", "26. mynd", "7. mynd", "7. mynd", "20. mynd",
1707832010207:"34. mynd", "34. mynd", "35. mynd", "35. mynd", "29. mynd",
1707832010223:"29. mynd", "28. mynd", "28. mynd", "13. mynd", "13. mynd",
1707832010239:"21. mynd", "22. mynd", "32. mynd", "32. mynd", "16. mynd",
1707832010256:"16. mynd")), class = "data.frame", row.names = c(NA, -27L
1707832010270:)) |>
1707832010288:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707832010302:names_to = "Year",
1707832010318:values_to = "Value",
1707832010334:names_prefix = "") |>
1707832010352:filter(Reitur %in% c("R11", "R33", "R34", "R56", "R60"))
1707832014134:mynd
1707832061305:mynd <-
1707832061325:structure(list(species = c("Parmelia saxatilis", "Parmelia saxatilis",
1707832061344:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061361:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061379:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061395:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061409:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061422:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061437:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061450:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832061463:"Parmelia saxatilis"), Type = c("Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061477:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061491:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061506:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061520:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061534:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061547:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061560:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061574:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832061589:"Blað- og runnfléttur"), Reitur = c("R11", "R12", "R13", "R14",
1707832061603:"R16", "R21", "R30", "R32", "R33", "R34", "R37", "R42", "R44",
1707832061619:"R45", "R47", "R48", "R49", "R51", "R52", "R56", "R60", "R64",
1707832061635:"R67", "R69", "R70", "R72", "R73"), km = c(1.9, 2, 2, 2, 8.7,
1707832061650:20.9, 3.2, 3.2, 1.4, 1.5, 3, 16.1, 16.1, 17.3, 17.3, 8.1, 8.1,
1707832061664:3.9, 3.9, 2.3, 2.4, 3.2, 5, 5, 5, 4, 4), `1976` = c(NA, 12, 1,
1707832061677:0.5, 1, 1, 7, 35, 40, NA, 50, 1, 20, NA, 1, 22, NA, 5, NA, NA,
1707832061694:NA, NA, NA, NA, NA, NA, NA), `1997` = c(NA, 3, NA, 1, 7, 5, 10,
1707832061709:2, 10, NA, 25, 1, 10, NA, 1, 28, NA, 12, 0.5, 2, 70, NA, NA,
1707832061727:NA, NA, NA, NA), `2006` = c(NA, 5, NA, 2, 10, 8, 13, NA, 13,
1707832061742:NA, 25, 1, 10, NA, 5, 30, NA, 16, 0.5, 4, 25, NA, NA, NA, NA,
1707832061753:NA, NA), `2011` = c(1, 9, 0.5, 1, 9, 7, 7, NA, 19, NA, 0.5, 0.5,
1707832061768:6, NA, 5, 27, NA, 13, NA, 3, 6, NA, NA, NA, NA, NA, NA), `2014` = c(1,
1707832061782:6, 0.5, NA, 8, 10, 2, NA, 26, NA, NA, 1, 4, NA, 5, 30, NA, 6,
1707832061796:0.5, 4, 4, NA, 20, 12, 1, 5, 8), `2017` = c(NA, 1, NA, NA, 6,
1707832061810:11, NA, NA, 50, 0.5, NA, 0.5, 6, 0.5, 6, 42, NA, 6, 1, 4, 6,
1707832061824:2, 22, 13, 8, 3, 8), `2020` = c(0.5, 0.5, NA, NA, 10, 7, NA,
1707832061837:NA, 53, NA, NA, 0.5, 2, 0.5, 5, 50, NA, 5, 0.5, 8, 7, 1, 23,
1707832061851:16, 4, 2, 10), `2023` = c(2, 0.5, NA, NA, 9, 10, NA, NA, 50,
1707832061865:NA, NA, 1, 5, 1, 9, 38, 1, NA, 2, 7, 9, 1, 33, 14, 3, 2, 14),
1707832061878:`1999` = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,
1707832061893:NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA
1707832061908:), Fluor = c(1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L,
1707832061922:0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
1707832061937:0L), Brennisteinn = c(1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L,
1707832061952:1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L,
1707832061966:0L, 0L, 0L), Stadur = c("Selás", "Bjarnarholt", "Bjarnarholt",
1707832061983:"Bjarnarholt", "Tíðaskarð", "Hvalfjarðarbotn", "Álfholt",
1707832062001:"Álfholt", "Stekkjarás", "Stekkjarás", "Kalmansá", "Hafnarbæli",
1707832062020:"Hafnarbæli", "Þyrilsnes", "Þyrilsnes", "Hvammsnes", "Hvammsnes",
1707832062038:"Ofan Hvalfjarðareyrar", "Ofan Hvalfjarðareyrar", "Akrafjall",
1707832062056:"Akrafjall", "Kalastaðakot", "Miðfellsmúli", "Gimbrapallar",
1707832062072:"Gimbrapallar", "Ofan við Gröf", "Ofan við Gröf"), Mynd = c("11. mynd",
1707832062087:"24. mynd", "24. mynd", "24. mynd", "31. mynd", "36. mynd",
1707832062102:"26. mynd", "26. mynd", "7. mynd", "7. mynd", "20. mynd",
1707832062119:"34. mynd", "34. mynd", "35. mynd", "35. mynd", "29. mynd",
1707832062135:"29. mynd", "28. mynd", "28. mynd", "13. mynd", "13. mynd",
1707832062152:"21. mynd", "22. mynd", "32. mynd", "32. mynd", "16. mynd",
1707832062167:"16. mynd")), class = "data.frame", row.names = c(NA, -27L
1707832062182:)) |>
1707832062199:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707832062216:names_to = "Year",
1707832062232:values_to = "Value",
1707832062247:names_prefix = "") |>
1707832062264:filter(Reitur %in% c("R11", "R33", "R34", "R56", "R60") & !Year %in% 1999)
1707832064525:mynd
1707832073541:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707832073560:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707832073574:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707832073591:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707832073606:scale_fill_manual(values = colors_dark2) +
1707832073619:labs(title = "",  y = "Þekja", x = "") +
1707832073635:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707832073652:theme_minimal() +
1707832073669:theme(legend.title = element_blank(),
1707832073685:plot.background = element_rect(fill = "white", color = NA)) +
1707832073700:theme(axis.title = element_text(size = 16), # Increase axis titles
1707832073713:axis.text = element_text(size = 16), # Increase axis text
1707832073728:legend.text = element_text(size = 16),
1707832073744:plot.title = element_text(size = 18)) # Increase legend text
1707832079978:#ath í R_2023, reit 33 er ártalið 1997 með 1% klettastrý. Er það talan fyrir árið 1999 í mynd 37 í skýrslunni?
1707832079998:Filename <-  glue("./myndir/","mynd38",".png")
1707832080791:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707832216447:mynd <-
1707832216472:structure(list(species = c("Parmelia saxatilis", "Parmelia saxatilis",
1707832216518:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216530:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216541:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216558:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216578:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216589:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216600:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216611:"Parmelia saxatilis", "Parmelia saxatilis", "Parmelia saxatilis",
1707832216622:"Parmelia saxatilis"), Type = c("Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216634:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216647:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216658:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216669:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216681:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216692:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216703:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216715:"Blað- og runnfléttur", "Blað- og runnfléttur", "Blað- og runnfléttur",
1707832216727:"Blað- og runnfléttur"), Reitur = c("R11", "R12", "R13", "R14",
1707832216738:"R16", "R21", "R30", "R32", "R33", "R34", "R37", "R42", "R44",
1707832216750:"R45", "R47", "R48", "R49", "R51", "R52", "R56", "R60", "R64",
1707832216761:"R67", "R69", "R70", "R72", "R73"), km = c(1.9, 2, 2, 2, 8.7,
1707832216772:20.9, 3.2, 3.2, 1.4, 1.5, 3, 16.1, 16.1, 17.3, 17.3, 8.1, 8.1,
1707832216784:3.9, 3.9, 2.3, 2.4, 3.2, 5, 5, 5, 4, 4), `1976` = c(NA, 12, 1,
1707832216796:0.5, 1, 1, 7, 35, 40, NA, 50, 1, 20, NA, 1, 22, NA, 5, NA, NA,
1707832216807:NA, NA, NA, NA, NA, NA, NA), `1997` = c(NA, 3, NA, 1, 7, 5, 10,
1707832216819:2, 10, NA, 25, 1, 10, NA, 1, 28, NA, 12, 0.5, 2, 70, NA, NA,
1707832216830:NA, NA, NA, NA), `2006` = c(NA, 5, NA, 2, 10, 8, 13, NA, 13,
1707832216841:NA, 25, 1, 10, NA, 5, 30, NA, 16, 0.5, 4, 25, NA, NA, NA, NA,
1707832216853:NA, NA), `2011` = c(1, 9, 0.5, 1, 9, 7, 7, NA, 19, NA, 0.5, 0.5,
1707832216864:6, NA, 5, 27, NA, 13, NA, 3, 6, NA, NA, NA, NA, NA, NA), `2014` = c(1,
1707832216876:6, 0.5, NA, 8, 10, 2, NA, 26, NA, NA, 1, 4, NA, 5, 30, NA, 6,
1707832216887:0.5, 4, 4, NA, 20, 12, 1, 5, 8), `2017` = c(NA, 1, NA, NA, 6,
1707832216900:11, NA, NA, 50, 0.5, NA, 0.5, 6, 0.5, 6, 42, NA, 6, 1, 4, 6,
1707832216911:2, 22, 13, 8, 3, 8), `2020` = c(0.5, 0.5, NA, NA, 10, 7, NA,
1707832216922:NA, 53, NA, NA, 0.5, 2, 0.5, 5, 50, NA, 5, 0.5, 8, 7, 1, 23,
1707832216933:16, 4, 2, 10), `2023` = c(2, 0.5, NA, NA, 9, 10, NA, NA, 50,
1707832216944:NA, NA, 1, 5, 1, 9, 38, 1, NA, 2, 7, 9, 1, 33, 14, 3, 2, 14)), Fluor = c(1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L,
1707832216955:0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L,
1707832216966:0L), Brennisteinn = c(1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L,
1707832216978:1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L,
1707832216989:0L, 0L, 0L), Stadur = c("Selás", "Bjarnarholt", "Bjarnarholt",
1707832217002:"Bjarnarholt", "Tíðaskarð", "Hvalfjarðarbotn", "Álfholt",
1707832217015:"Álfholt", "Stekkjarás", "Stekkjarás", "Kalmansá", "Hafnarbæli",
1707832217028:"Hafnarbæli", "Þyrilsnes", "Þyrilsnes", "Hvammsnes", "Hvammsnes",
1707832217042:"Ofan Hvalfjarðareyrar", "Ofan Hvalfjarðareyrar", "Akrafjall",
1707832217055:"Akrafjall", "Kalastaðakot", "Miðfellsmúli", "Gimbrapallar",
1707832217067:"Gimbrapallar", "Ofan við Gröf", "Ofan við Gröf"), Mynd = c("11. mynd",
1707832217080:"24. mynd", "24. mynd", "24. mynd", "31. mynd", "36. mynd",
1707832217093:"26. mynd", "26. mynd", "7. mynd", "7. mynd", "20. mynd",
1707832217106:"34. mynd", "34. mynd", "35. mynd", "35. mynd", "29. mynd",
1707832217117:"29. mynd", "28. mynd", "28. mynd", "13. mynd", "13. mynd",
1707832217128:"21. mynd", "22. mynd", "32. mynd", "32. mynd", "16. mynd",
1707832217139:"16. mynd")), class = "data.frame", row.names = c(NA, -27L
1707832309657:joined_data <- data %>%
1707832309675:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707832309694:select(species, Type, Reitur, km, everything()) |>
1707832309710:#select(-c(`1999`)) |>
1707832309724:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707832309739:"R55", "R57", "R58", "R59", "R61", "R62") &
1707832309754:species %in% "Parmelia saxatilis" ) |>
1707832309769:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707832309784:names_to = "Year",
1707832309799:values_to = "Value",
1707832309811:names_prefix = "") |>
1707832309823:filter(Reitur %in% c("R11", "R33", "R34", "R56", "R60"))
1707832311039:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707832311056:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707832311069:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707832311081:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707832311092:scale_fill_manual(values = colors_dark2) +
1707832311102:labs(title = "",  y = "Þekja", x = "") +
1707832311114:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707832311125:theme_minimal() +
1707832311136:theme(legend.title = element_blank(),
1707832311148:plot.background = element_rect(fill = "white", color = NA)) +
1707832311159:theme(axis.title = element_text(size = 16), # Increase axis titles
1707832311170:axis.text = element_text(size = 16), # Increase axis text
1707832311184:legend.text = element_text(size = 16),
1707832311196:plot.title = element_text(size = 18)) # Increase legend text
1707832314213:#ath í R_2023, reit 33 er ártalið 1997 með 1% klettastrý. Er það talan fyrir árið 1999 í mynd 37 í skýrslunni?
1707832314232:Filename <-  glue("./myndir/","mynd38",".png")
1707832314700:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707832699020:library(patchwork)
1707832701360:library('patchwork')
1707832705820:install.packages('patchwork')
1707832715441:library('patchwork')
1707832729084:joined_data <- data %>%
1707832729101:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707832729119:select(species, Type, Reitur, km, everything()) |>
1707832729136:#select(-c(`1999`)) |>
1707832729150:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54",
1707832729164:"R55", "R57", "R58", "R59", "R61", "R62") &
1707832729178:species %in% "Parmelia saxatilis" ) |>
1707832729191:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707832729205:names_to = "Year",
1707832729221:values_to = "Value",
1707832729237:names_prefix = "") |>
1707832729250:filter(!Reitur %in% c("R11", "R33", "R34", "R56", "R60"))
1707832733931:joined_data
1707832749640:unique(joined_data$Reitur)
1707832791323:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707832791343:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707832791359:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707832791376:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707832791389:scale_fill_manual(values = colors_dark2) +
1707832791403:labs(title = "",  y = "Þekja", x = "") +
1707832791417:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707832791431:theme_minimal() +
1707832791444:theme(legend.title = element_blank(),
1707832791460:plot.background = element_rect(fill = "white", color = NA)) +
1707832791472:theme(axis.title = element_text(size = 16), # Increase axis titles
1707832791487:axis.text = element_text(size = 16), # Increase axis text
1707832791501:legend.text = element_text(size = 16),
1707832791516:plot.title = element_text(size = 18)) # Increase legend text
1707832793477:p1
1707833660645:# Load necessary libraries
1707833660657:library(ggplot2)
1707833660671:library(reshape2) # For melting the data frame
1707833676317:install.packages("reshape2")
1707833685657:# Load necessary libraries
1707833685674:library(ggplot2)
1707833685693:library(reshape2) # For melting the data frame
1707833685829:# Assuming you have a data frame 'df' with the first column as the sampling square ('Square'),
1707833685846:# the remaining columns as years (e.g., '1976', '1997', etc.), and the cell values as cover percentages.
1707833685862:# You need to transform the data into a long format for ggplot2 to work with it.
1707833685893:# Melting the data frame to long format
1707833685908:df_long <- melt(df, id.vars = 'Square', variable.name = 'Year', value.name = 'Cover')
1707833741263:str(joined_data)
1707833761627:# Melting the data frame to long format
1707833761646:df_long <- melt(joined_data, id.vars = 'Reitur', variable.name = 'Year', value.name = 'Value')
1707833763401:# Creating the heatmap
1707833763424:ggplot(df_long, aes(x = Year, y = Reitur, fill = Value)) +
1707833763442:geom_tile() + # This creates the actual heatmap
1707833763458:scale_fill_gradient(low = "blue", high = "yellow") + # You can change colors as needed
1707833763472:theme_minimal() +
1707833763486:labs(x = 'Year', y = 'Sampling Reitur', fill = 'Value %') +
1707833763499:theme(axis.text.x = element_text(angle = 90, hjust = 1)) # Rotate x-axis text if needed
1707833774955:ggplot(df_long, aes(x = Year, y = Reitur, fill = Value)) +
1707833774972:geom_tile()
1707835612487:# Melting the data frame to long format
1707835612507:df <- melt(joined_data[,c("Reitur", "Year", "Value")], id.vars = 'Reitur', variable.name = 'Year', value.name = 'Value')
1707835614327:# Creating the heatmap
1707835614349:ggplot(df, aes(x = Year, y = Reitur, fill = Value)) +
1707835614367:geom_tile() + # This creates the actual heatmap
1707835614383:scale_fill_gradient(low = "blue", high = "yellow") + # You can change colors as needed
1707835614398:theme_minimal() +
1707835614411:labs(x = 'Year', y = 'Sampling Reitur', fill = 'Value %') +
1707835614425:theme(axis.text.x = element_text(angle = 90, hjust = 1)) # Rotate x-axis text if needed
1707835621067:ggplot(df, aes(x = Year, y = Reitur, fill = Value)) +
1707835621082:geom_tile() + # This creates the actual heatmap
1707835621103:scale_fill_gradient(low = "blue", high = "yellow")
1707835627116:ggplot(df, aes(x = Year, y = Reitur, fill = Value)) +
1707835627136:geom_tile()
1707835834022:p1 <- ggplot(joined_data[,1:11], aes(fill = factor(Year), y = Value, x = Reitur)) +
1707835834043:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707835834059:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707835834077:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707835834091:scale_fill_manual(values = colors_dark2) +
1707835834107:labs(title = "",  y = "Þekja", x = "") +
1707835834122:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707835834140:theme_minimal() +
1707835834154:theme(legend.title = element_blank(),
1707835834169:plot.background = element_rect(fill = "white", color = NA)) +
1707835834183:theme(axis.title = element_text(size = 16), # Increase axis titles
1707835834197:axis.text = element_text(size = 16), # Increase axis text
1707835834212:legend.text = element_text(size = 16),
1707835834227:plot.title = element_text(size = 18),
1707835834241:legend.position = "none") # Increase legend text
1707835959929:unique(joined_data$Reitur)
1707836163913:joined_data <- data %>%
1707836163931:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707836163950:select(species, Type, Reitur, km, everything()) |>
1707836163967:#select(-c(`1999`)) |>
1707836163981:filter(species %in% "Parmelia saxatilis" ) |>
1707836163996:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707836164011:names_to = "Year",
1707836164025:values_to = "Value",
1707836164039:names_prefix = "") |>
1707836164053:filter(Reitur %in% c("R12","R13","R14","R16","R21","R30","R32","R37","R42","R44","R45"))
1707836165463:library('patchwork')
1707836166738:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707836166756:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707836166773:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707836166788:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707836166803:scale_fill_manual(values = colors_dark2) +
1707836166817:labs(title = "",  y = "Þekja", x = "") +
1707836166831:ggtitle("Snepaskóf - innan þynningarsvæðis")+
1707836166846:theme_minimal() +
1707836166859:theme(legend.title = element_blank(),
1707836166874:plot.background = element_rect(fill = "white", color = NA)) +
1707836166886:theme(axis.title = element_text(size = 16), # Increase axis titles
1707836166901:axis.text = element_text(size = 16), # Increase axis text
1707836166916:legend.text = element_text(size = 16),
1707836166930:plot.title = element_text(size = 18),
1707836166944:legend.position = "none") # Increase legend text
1707836168508:joined_dataB <- data %>%
1707836168532:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707836168549:select(species, Type, Reitur, km, everything()) |>
1707836168563:#select(-c(`1999`)) |>
1707836168578:filter(species %in% "Parmelia saxatilis" ) |>
1707836168592:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707836168607:names_to = "Year",
1707836168622:values_to = "Value",
1707836168637:names_prefix = "") |>
1707836168653:filter(Reitur %in% c("R47","R48","R49","R51","R52","R64","R67","R69","R70","R72","R73"))
1707836171428:p2 <- ggplot(joined_dataB, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707836171450:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707836171469:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707836171485:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707836171501:scale_fill_manual(values = colors_dark2) +
1707836171515:labs(title = "",  y = "Þekja", x = "") +
1707836171529:theme_minimal() +
1707836171541:theme(legend.title = element_blank(),
1707836171556:plot.background = element_rect(fill = "white", color = NA)) +
1707836171571:theme(axis.title = element_text(size = 16), # Increase axis titles
1707836171586:axis.text = element_text(size = 16), # Increase axis text
1707836171600:legend.text = element_text(size = 16),
1707836171614:plot.title = element_text(size = 18))
1707836172982:stacked_plots <- p1 / p2
1707836174461:# Display the stacked plots
1707836174482:stacked_plots
1707836207471:Filename <-  glue("./myndir/","mynd39",".png")
1707836208653:ggsave(filename = Filename, plot = stacked_plots, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707836667823:df
1707836686150:joined_data[,c("Reitur", "Year", "Value")]
1707836714443:writeLines(joined_data[,c("Reitur", "Year", "Value")])
1707836744746:write.csv(joined_data[,c("Reitur", "Year", "Value")], row.names = F)
1707836946901:mynd <- read.table("mynd40.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707836946923:pivot_longer(cols = c("hraunbreyskja","snepaskóf" ), names_to = "Gerd", values_to = "Heild" ) |>
1707836946941:mutate(Gerd = case_when(
1707836946958:Gerd == "snepaskóf"~"Snepaskóf",
1707836946973:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707836946989:))
1707836948004:colnames(mynd)[1] <- "Stadir"
1707836948820:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707836949406:mynd$Gerd <- factor(mynd$Gerd, levels = c("Snepaskóf","Hraunbreyskja"))
1707836950538:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild*0.001, fill = Stadir)) +
1707836950556:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707836950575:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707836950594:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707836950608:labs(title = "",  y = "µg S/g þurrefnis", x = "") +
1707836950624:theme_minimal()+
1707836950638:ggtitle("Brennisteinn")+
1707836950651:theme(legend.title = element_blank(),
1707836950665:plot.background = element_rect(fill = "white", color = NA)) +
1707836950679:theme(axis.title = element_text(size = 16), # Increase axis titles
1707836950693:axis.text = element_text(size = 16), # Increase axis text
1707836950709:legend.text = element_text(size = 16),
1707836950724:plot.title = element_text(size = 18)) # Increase legend text
1707836952678:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707836954006:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707836964431:########
1707836964448:#mynd 42
1707836964462:########
1707836964481:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707836964494:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707836964510:names_to = "Year",
1707836964524:values_to = "Value",
1707836964538:names_prefix = "") %>%
1707836964552:mutate(Year = as.numeric(Year))
1707836964975:colnames(mynd)[1] <- "Stadir"
1707836965319:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707836965750:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = Stadir)) +
1707836965770:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707836965787:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707836965807:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707836965826:scale_fill_manual(values = colors_dark2) +
1707836965849:labs(title = "",  y = "µg S/g þurrefnis", x = "") +
1707836965870:ggtitle("Snepaskóf")+
1707836965887:theme_minimal() +
1707836965907:theme(legend.title = element_blank(),
1707836965923:plot.background = element_rect(fill = "white", color = NA)) +
1707836965939:theme(axis.title = element_text(size = 16), # Increase axis titles
1707836965957:axis.text = element_text(size = 16), # Increase axis text
1707836965972:legend.text = element_text(size = 16),
1707836965988:plot.title = element_text(size = 18)) # Increase legend text
1707836966574:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707836966732:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707836979869:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707836979885:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707836979900:names_to = "Year",
1707836979918:values_to = "Value",
1707836979935:names_prefix = "") %>%
1707836979950:mutate(Year = as.numeric(Year))
1707836979979:colnames(mynd)[1] <- "Stadir"
1707836979991:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707836980011:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = Stadir)) +
1707836980022:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707836980033:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707836980044:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707836980054:scale_fill_manual(values = colors_dark2) +
1707836980068:labs(title = "",  y = "µg S/g þurrefnis", x = "") +
1707836980082:ggtitle("Hraunbreyskja")+
1707836980097:theme_minimal() +
1707836980111:theme(legend.title = element_blank(),
1707836980126:plot.background = element_rect(fill = "white", color = NA)) +
1707836980142:theme(axis.title = element_text(size = 16), # Increase axis titles
1707836980156:axis.text = element_text(size = 16), # Increase axis text
1707836980170:legend.text = element_text(size = 16),
1707836980185:plot.title = element_text(size = 18)) # Increase legend text
1707836980221:Filename <-  glue("./myndir/efnagreiningar/","mynd43",".png")
1707836980238:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707837022432:colors_dark2 <- brewer.pal(8, "Accent")
1707837032829:mynd <- read.table("mynd40.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8") %>%
1707837032850:pivot_longer(cols = c("hraunbreyskja","snepaskóf" ), names_to = "Gerd", values_to = "Heild" ) |>
1707837032865:mutate(Gerd = case_when(
1707837032880:Gerd == "snepaskóf"~"Snepaskóf",
1707837032894:Gerd == "hraunbreyskja"~"Hraunbreyskja"
1707837032908:))
1707837032932:colnames(mynd)[1] <- "Stadir"
1707837032947:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707837032962:mynd$Gerd <- factor(mynd$Gerd, levels = c("Snepaskóf","Hraunbreyskja"))
1707837032999:p1 <- ggplot(mynd, aes(x = Gerd, y = Heild*0.001, fill = Stadir)) +
1707837033014:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707837033028:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707837033043:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707837033058:labs(title = "",  y = "µg S/g þurrefnis", x = "") +
1707837033072:theme_minimal()+
1707837033086:ggtitle("Brennisteinn")+
1707837033100:theme(legend.title = element_blank(),
1707837033114:plot.background = element_rect(fill = "white", color = NA)) +
1707837033128:theme(axis.title = element_text(size = 16), # Increase axis titles
1707837033144:axis.text = element_text(size = 16), # Increase axis text
1707837033158:legend.text = element_text(size = 16),
1707837033171:plot.title = element_text(size = 18)) # Increase legend text
1707837033204:Filename <-  glue("./myndir/efnagreiningar/","mynd40",".png")
1707837033219:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707837043039:mynd <- read.table("mynd42.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707837043056:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707837043076:names_to = "Year",
1707837043091:values_to = "Value",
1707837043103:names_prefix = "") %>%
1707837043120:mutate(Year = as.numeric(Year))
1707837043149:colnames(mynd)[1] <- "Stadir"
1707837043164:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707837043189:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = Stadir)) +
1707837043203:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707837043220:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707837043235:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707837043251:scale_fill_manual(values = colors_dark2) +
1707837043268:labs(title = "",  y = "µg S/g þurrefnis", x = "") +
1707837043284:ggtitle("Snepaskóf")+
1707837043298:theme_minimal() +
1707837043313:theme(legend.title = element_blank(),
1707837043328:plot.background = element_rect(fill = "white", color = NA)) +
1707837043344:theme(axis.title = element_text(size = 16), # Increase axis titles
1707837043358:axis.text = element_text(size = 16), # Increase axis text
1707837043375:legend.text = element_text(size = 16),
1707837043391:plot.title = element_text(size = 18)) # Increase legend text
1707837043428:Filename <-  glue("./myndir/efnagreiningar/","mynd42",".png")
1707837043442:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707837054014:mynd <- read.table("mynd43.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707837054035:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707837054054:names_to = "Year",
1707837054071:values_to = "Value",
1707837054089:names_prefix = "") %>%
1707837054104:mutate(Year = as.numeric(Year))
1707837054131:colnames(mynd)[1] <- "Stadir"
1707837054147:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707837054174:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value*0.001, x = Stadir)) +
1707837054188:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707837054202:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707837054216:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707837054230:scale_fill_manual(values = colors_dark2) +
1707837054244:labs(title = "",  y = "µg S/g þurrefnis", x = "") +
1707837054259:ggtitle("Hraunbreyskja")+
1707837054274:theme_minimal() +
1707837054289:theme(legend.title = element_blank(),
1707837054301:plot.background = element_rect(fill = "white", color = NA)) +
1707837054319:theme(axis.title = element_text(size = 16), # Increase axis titles
1707837054333:axis.text = element_text(size = 16), # Increase axis text
1707837054347:legend.text = element_text(size = 16),
1707837054362:plot.title = element_text(size = 18)) # Increase legend text
1707837054398:Filename <-  glue("./myndir/efnagreiningar/","mynd43",".png")
1707837054413:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707837271216:joined_data <- data %>%
1707837271234:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707837271252:select(species, Type, Reitur, km, everything()) |>
1707837271268:#select(-c(`1999`)) |>
1707837271280:filter(species %in% "Parmelia saxatilis" ) |>
1707837271295:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707837271309:names_to = "Year",
1707837271324:values_to = "Value",
1707837271339:names_prefix = "") |>
1707837271354:filter(Reitur %in% c("R12","R13","R14","R16","R21","R30","R32","R37","R42","R44","R45"))
1707837271444:library('patchwork')
1707837271477:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707837271492:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707837271507:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707837271521:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707837271535:scale_fill_manual(values = colors_dark2) +
1707837271550:labs(title = "",  y = "Þekja", x = "") +
1707837271568:ggtitle("Snepaskóf - utan þynningarsvæðis")+
1707837271583:theme_minimal() +
1707837271598:theme(legend.title = element_blank(),
1707837271611:plot.background = element_rect(fill = "white", color = NA)) +
1707837271624:theme(axis.title = element_text(size = 16), # Increase axis titles
1707837271638:axis.text = element_text(size = 16), # Increase axis text
1707837271654:legend.text = element_text(size = 16),
1707837271668:plot.title = element_text(size = 18),
1707837271684:legend.position = "none") # Increase legend text
1707837271731:joined_dataB <- data %>%
1707837271748:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707837271761:select(species, Type, Reitur, km, everything()) |>
1707837271774:#select(-c(`1999`)) |>
1707837271789:filter(species %in% "Parmelia saxatilis" ) |>
1707837271804:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707837271818:names_to = "Year",
1707837271830:values_to = "Value",
1707837271845:names_prefix = "") |>
1707837271862:filter(Reitur %in% c("R47","R48","R49","R51","R52","R64","R67","R69","R70","R72","R73"))
1707837271940:p2 <- ggplot(joined_dataB, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707837271954:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707837271971:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707837271987:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707837272003:scale_fill_manual(values = colors_dark2) +
1707837272023:labs(title = "",  y = "Þekja", x = "") +
1707837272045:theme_minimal() +
1707837272062:theme(legend.title = element_blank(),
1707837272083:plot.background = element_rect(fill = "white", color = NA)) +
1707837272100:theme(axis.title = element_text(size = 16), # Increase axis titles
1707837272114:axis.text = element_text(size = 16), # Increase axis text
1707837272128:legend.text = element_text(size = 16),
1707837272141:plot.title = element_text(size = 18))
1707837272172:stacked_plots <- p1 / p2
1707837272199:# Display the stacked plots
1707837272214:stacked_plots
1707837280000:colors_dark2 <- brewer.pal(9, "Set1")
1707837284691:joined_data <- data %>%
1707837284711:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707837284723:select(species, Type, Reitur, km, everything()) |>
1707837284736:#select(-c(`1999`)) |>
1707837284747:filter(species %in% "Parmelia saxatilis" ) |>
1707837284758:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707837284770:names_to = "Year",
1707837284781:values_to = "Value",
1707837284793:names_prefix = "") |>
1707837284804:filter(Reitur %in% c("R12","R13","R14","R16","R21","R30","R32","R37","R42","R44","R45"))
1707837284897:library('patchwork')
1707837284919:p1 <- ggplot(joined_data, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707837284930:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707837284941:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707837284952:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707837284964:scale_fill_manual(values = colors_dark2) +
1707837284975:labs(title = "",  y = "Þekja", x = "") +
1707837284986:ggtitle("Snepaskóf - utan þynningarsvæðis")+
1707837284997:theme_minimal() +
1707837285008:theme(legend.title = element_blank(),
1707837285019:plot.background = element_rect(fill = "white", color = NA)) +
1707837285030:theme(axis.title = element_text(size = 16), # Increase axis titles
1707837285042:axis.text = element_text(size = 16), # Increase axis text
1707837285052:legend.text = element_text(size = 16),
1707837285064:plot.title = element_text(size = 18),
1707837285075:legend.position = "none") # Increase legend text
1707837285113:joined_dataB <- data %>%
1707837285127:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707837285139:select(species, Type, Reitur, km, everything()) |>
1707837285150:#select(-c(`1999`)) |>
1707837285162:filter(species %in% "Parmelia saxatilis" ) |>
1707837285174:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707837285185:names_to = "Year",
1707837285197:values_to = "Value",
1707837285207:names_prefix = "") |>
1707837285219:filter(Reitur %in% c("R47","R48","R49","R51","R52","R64","R67","R69","R70","R72","R73"))
1707837285290:p2 <- ggplot(joined_dataB, aes(fill = factor(Year), y = Value, x = Reitur)) +
1707837285301:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707837285314:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".",suffix = " \n%")) +
1707837285326:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707837285337:scale_fill_manual(values = colors_dark2) +
1707837285349:labs(title = "",  y = "Þekja", x = "") +
1707837285361:theme_minimal() +
1707837285373:theme(legend.title = element_blank(),
1707837285385:plot.background = element_rect(fill = "white", color = NA)) +
1707837285396:theme(axis.title = element_text(size = 16), # Increase axis titles
1707837285407:axis.text = element_text(size = 16), # Increase axis text
1707837285464:legend.text = element_text(size = 16),
1707837285477:plot.title = element_text(size = 18))
1707837285514:stacked_plots <- p1 / p2
1707837285538:# Display the stacked plots
1707837285551:stacked_plots
1707837286016:Filename <-  glue("./myndir/","mynd39",".png")
1707837286028:ggsave(filename = Filename, plot = stacked_plots, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707837786883:joined_data |>
1707837786897:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707837786910:names_to = "Year",
1707837786922:values_to = "Value",
1707837786934:names_prefix = "")
1707837798649:joined_data <- data %>%
1707837798664:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707837798681:select(species, Type, Reitur, km, everything()) |>
1707837798698:select(-c(`1999`,`1976`, `1997`, `2006`, `2011`)) |>
1707837798711:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29",
1707837798726:"R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707837798741:filter(!species %in% "Ber klöpp" &
1707837798756:!Type %in% c("Grænþörungar", "Cyanobacteria"))
1707837802543:joined_data
1707837821673:jd_long <- joined_data |>
1707837821685:pivot_longer(cols = starts_with("20"),
1707837821697:names_to = "Year",
1707837821709:values_to = "Value",
1707837821720:names_prefix = "")
1707837824721:jd_long
1707837855772:jd_long <- joined_data |>
1707837855787:pivot_longer(cols = starts_with("20"),
1707837855801:names_to = "Year",
1707837855824:values_to = "Coverage",
1707837855843:names_prefix = "")
1707837862646:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707837864383:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707837864401:# Fjöldi tegunda í reit á ári
1707837864421:species_counts <- jd_long_Engin_NA %>%
1707837864437:group_by(Reitur, Year) %>%
1707837864451:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707837864464:# Meðalfjöldi tegunda í reit á ári
1707837864481:group_by(Year) %>%
1707837864496:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707837864511:mutate(Type = "Tegundafjöldi")|>
1707837864526:select(Type, Year, Mean, SE)
1707837868097:species_counts
1707837920372:# Meðalþekja reita eftir Type
1707837920390:df <- jd_long |>
1707837920402:group_by(Type,Year,Reitur) %>%
1707837920416:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707837920431:group_by(Type,Year) %>%
1707837920445:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707837923301:# heildarþekja (öll Type) allra reita innan ára
1707837923318:df_summary <- jd_long |>
1707837923330:group_by(Year,Reitur) %>%
1707837923342:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707837923353:group_by(Year) %>%
1707837923364:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707837923375:mutate(Type = "Heildarþekja") |>
1707837923385:select(Type, Year, Mean, SE)
1707837926043:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707837930675:# Ensure Type is ordered as desired
1707837930697:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707837932301:# Plot
1707837932357:p1 <-
1707837932376:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707837932398:geom_bar(
1707837932414:stat = "identity",
1707837932426:color = "black",
1707837932438:size = .6,
1707837932453:position = position_dodge(width = 0.75)
1707837932467:) +
1707837932482:geom_errorbar(
1707837932495:aes(ymin = Mean - SE, ymax = Mean + SE),
1707837932507:width = .2,
1707837932518:position = position_dodge(width = 0.75)
1707837932529:) +
1707837932540:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707837932551:scale_y_continuous(
1707837932564:labels = label_dollar(prefix = "", suffix = " \n%"),
1707837932574:# Example secondary axis (e.g., double the Mean for illustration)
1707837932586:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707837932597:) +
1707837932608:labs(title = "",
1707837932622:y = "Meðalþekja", x = "") +
1707837932637:scale_x_discrete(
1707837932652:"",
1707837932667:labels = c(
1707837932683:"Mosar" = "Mosar",
1707837932699:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707837932714:"Hrúðurfléttur" = "Hrúðurfléttur",
1707837932730:"Heildarþekja" = "Heildarþekja",
1707837932745:"Tegundafjöldi" = "Tegundafjöldi"
1707837932760:)
1707837932776:) +
1707837932789:theme_minimal() +
1707837932802:theme(legend.title = element_blank(),
1707837932816:plot.background = element_rect(fill = "white", color = NA)) +
1707837932830:annotate(
1707837932843:"text",
1707837932858:x = 2,
1707837932871:y = Inf,
1707837932887:label = i,
1707837932901:hjust = 1,
1707837932916:vjust = 1,
1707837932930:size = 8,
1707837932943:angle = 0
1707837932956:)
1707837935457:p1
1707838036069:# Plot
1707838036088:p1 <-
1707838036109:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707838036126:geom_bar(
1707838036141:stat = "identity",
1707838036157:color = "black",
1707838036173:size = .6,
1707838036188:position = position_dodge(width = 0.75)
1707838036203:) +
1707838036217:geom_errorbar(
1707838036235:aes(ymin = Mean - SE, ymax = Mean + SE),
1707838036250:width = .2,
1707838036265:position = position_dodge(width = 0.75)
1707838036283:) +
1707838036305:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707838036322:scale_y_continuous(
1707838036338:labels = label_dollar(prefix = "", suffix = " \n%"),
1707838036352:# Example secondary axis (e.g., double the Mean for illustration)
1707838036367:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707838036381:) +
1707838036396:labs(title = "",
1707838036410:y = "Meðalþekja", x = "") +
1707838036424:scale_x_discrete(
1707838036438:"",
1707838036452:labels = c(
1707838036465:"Mosar" = "Mosar",
1707838036477:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707838036491:"Hrúðurfléttur" = "Hrúðurfléttur",
1707838036505:"Heildarþekja" = "Heildarþekja",
1707838036518:"Tegundafjöldi" = "Tegundafjöldi"
1707838036532:)
1707838036544:) +
1707838036557:theme_minimal() +
1707838036572:theme(legend.title = element_blank(),
1707838036586:plot.background = element_rect(fill = "white", color = NA)) +
1707838036602:annotate("text", x = 2, y = Inf, label = "Allir reitir", hjust = 1, vjust = 1, size = 8, angle = 0)
1707838039806:p1
1707838288348:colors_dark2 <- brewer.pal(8, "Accent")
1707838298260:# Plot
1707838298280:p1 <-
1707838298297:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707838298309:geom_bar(
1707838298320:stat = "identity",
1707838298331:color = "black",
1707838298341:size = .6,
1707838298354:position = position_dodge(width = 0.75)
1707838298365:) +
1707838298376:geom_errorbar(
1707838298387:aes(ymin = Mean - SE, ymax = Mean + SE),
1707838298398:width = .2,
1707838298413:position = position_dodge(width = 0.75)
1707838298426:) +
1707838298439:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707838298452:scale_y_continuous(
1707838298463:labels = label_dollar(prefix = "", suffix = " \n%"),
1707838298474:# Example secondary axis (e.g., double the Mean for illustration)
1707838298486:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707838298497:) +
1707838298508:labs(title = "",
1707838298519:y = "Meðalþekja", x = "") +
1707838298531:scale_x_discrete(
1707838298542:"",
1707838298554:labels = c(
1707838298565:"Mosar" = "Mosar",
1707838298576:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707838298588:"Hrúðurfléttur" = "Hrúðurfléttur",
1707838298600:"Heildarþekja" = "Heildarþekja",
1707838298611:"Tegundafjöldi" = "Tegundafjöldi"
1707838298622:)
1707838298634:) +
1707838298645:theme_minimal() +
1707838298656:theme(legend.title = element_blank(),
1707838298668:plot.background = element_rect(fill = "white", color = NA)) +
1707838298679:annotate("text", x = 2, y = Inf, label = "Allir reitir", hjust = 1, vjust = 1, size = 8, angle = 0)
1707838302230:p1 <-
1707838302247:p1 + theme(
1707838302262:axis.title = element_text(size = 16),
1707838302277:# Increase axis titles
1707838302291:axis.text = element_text(size = 16),
1707838302305:# Increase axis text
1707838302320:legend.text = element_text(size = 16)
1707838302333:) # Increase legend text
1707838307153:p1
1707838395446:unique(joined_data$Reitur)
1707838419911:Filename <-  glue("./myndir/","mynd3_SE","-","{paste(unique(joined_data$Reitur), collapse='_')}.png")
1707838423150:Filename
1707838432722:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707838479037:Filename <-  glue("./myndir/","mynd3_SE","-",".png")
1707838479693:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707838522155:p1 <-
1707838522172:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707838522189:geom_bar(
1707838522204:stat = "identity",
1707838522218:color = "black",
1707838522233:size = .6,
1707838522248:position = position_dodge(width = 0.75)
1707838522262:) +
1707838522275:# geom_errorbar(
1707838522288:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707838522303:#   width = .2,
1707838522317:#   position = position_dodge(width = 0.75)
1707838522331:# ) +
1707838522346:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707838522362:scale_y_continuous(
1707838522376:labels = label_dollar(prefix = "", suffix = " \n%"),
1707838522391:# Example secondary axis (e.g., double the Mean for illustration)
1707838522406:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707838522420:) +
1707838522434:labs(title = "",
1707838522449:y = "Meðalþekja", x = "") +
1707838522464:scale_x_discrete(
1707838522477:"",
1707838522491:labels = c(
1707838522505:"Mosar" = "Mosar",
1707838522520:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707838522533:"Hrúðurfléttur" = "Hrúðurfléttur",
1707838522546:"Heildarþekja" = "Heildarþekja",
1707838522560:"Tegundafjöldi" = "Tegundafjöldi"
1707838522573:)
1707838522588:) +
1707838522603:theme_minimal() +
1707838522618:theme(legend.title = element_blank(),
1707838522631:plot.background = element_rect(fill = "white", color = NA)) +
1707838522646:annotate("text", x = 2, y = Inf, label = "Allir reitir", hjust = 1, vjust = 1, size = 8, angle = 0)
1707838522681:p1 <-
1707838522695:p1 + theme(
1707838522708:axis.title = element_text(size = 16),
1707838522724:# Increase axis titles
1707838522737:axis.text = element_text(size = 16),
1707838522752:# Increase axis text
1707838522768:legend.text = element_text(size = 16)
1707838522785:) # Increase legend text
1707838522816:Filename <-  glue("./myndir/","mynd3","-",".png")
1707838522832:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707839108043:joined_data <- data %>%
1707839108061:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707839108074:select(species, Type, Reitur, km, everything()) |>
1707839108090:select(-c(`1999`,`1976`,)) |>
1707839108105:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62", "R63", "R64", "R65", "R66", "R67", "R68", "R69",
1707839108119:"R70", "R71", "R72", "R73", "R74", "R75", "R76", "R77")) |>
1707839108133:filter(!species %in% "Ber klöpp" &
1707839108146:!Type %in% c("Grænþörungar", "Cyanobacteria"))
1707839108879:jd_long <- joined_data |>
1707839108899:pivot_longer(cols = starts_with("20"),
1707839108915:names_to = "Year",
1707839108929:values_to = "Coverage",
1707839108941:names_prefix = "")
1707839111550:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707839112070:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707839112091:# Fjöldi tegunda í reit á ári
1707839112107:species_counts <- jd_long_Engin_NA %>%
1707839112119:group_by(Reitur, Year) %>%
1707839112132:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707839112143:# Meðalfjöldi tegunda í reit á ári
1707839112154:group_by(Year) %>%
1707839112164:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707839112176:mutate(Type = "Tegundafjöldi")|>
1707839112191:select(Type, Year, Mean, SE)
1707839112760:# Meðalþekja reita eftir Type
1707839112783:df <- jd_long |>
1707839112800:group_by(Type,Year,Reitur) %>%
1707839112815:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707839112828:group_by(Type,Year) %>%
1707839112842:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707839113406:# heildarþekja (öll Type) allra reita innan ára
1707839113428:df_summary <- jd_long |>
1707839113442:group_by(Year,Reitur) %>%
1707839113457:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707839113472:group_by(Year) %>%
1707839113486:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707839113502:mutate(Type = "Heildarþekja") |>
1707839113517:select(Type, Year, Mean, SE)
1707839114102:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707839114429:# Ensure Type is ordered as desired
1707839114443:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur",
1707839114457:"Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707839115237:# Plot
1707839115258:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year), fill = "white") +
1707839115276:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707839115293:geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707839115308:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707839115321:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707839115334:# Example secondary axis (e.g., double the Mean for illustration)
1707839115349:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707839115363:labs(title = "",
1707839115378:y = "Meðalþekja", x = "") +
1707839115393:scale_x_discrete(
1707839115408:"",
1707839115423:labels = c(
1707839115435:"Mosar" = "Mosar",
1707839115449:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707839115465:"Hrúðurfléttur" = "Hrúðurfléttur",
1707839115479:"Heildarþekja" = "Heildarþekja",
1707839115493:"Tegundafjöldi" = "Tegundafjöldi"
1707839115508:))+
1707839115522:theme_minimal()+
1707839115536:theme(legend.title = element_blank(),
1707839115550:plot.background = element_rect(fill = "white", color = NA)) +
1707839115563:annotate("text", x = 3, y = Inf, label = "Allir reitir utan \n15 nýrra frá 2014", hjust = 1, vjust = 1, size = 8, angle = 0)
1707839117357:p1 <- p1 + theme(axis.title = element_text(size = 16), # Increase axis titles
1707839117380:axis.text = element_text(size = 16), # Increase axis text
1707839117400:legend.text = element_text(size = 16)) # Increase legend text
1707839120718:p1
1707839326537:jd_long <- joined_data |>
1707839326553:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707839326568:names_to = "Year",
1707839326585:values_to = "Coverage",
1707839326599:names_prefix = "")
1707839326645:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707839326670:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707839326684:# Fjöldi tegunda í reit á ári
1707839326698:species_counts <- jd_long_Engin_NA %>%
1707839326711:group_by(Reitur, Year) %>%
1707839326726:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707839326741:# Meðalfjöldi tegunda í reit á ári
1707839326755:group_by(Year) %>%
1707839326769:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707839326784:mutate(Type = "Tegundafjöldi")|>
1707839326799:select(Type, Year, Mean, SE)
1707839326855:# Meðalþekja reita eftir Type
1707839326872:df <- jd_long |>
1707839326887:group_by(Type,Year,Reitur) %>%
1707839326902:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707839326920:group_by(Type,Year) %>%
1707839326934:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707839327039:# heildarþekja (öll Type) allra reita innan ára
1707839327055:df_summary <- jd_long |>
1707839327072:group_by(Year,Reitur) %>%
1707839327088:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707839327107:group_by(Year) %>%
1707839327122:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707839327138:mutate(Type = "Heildarþekja") |>
1707839327155:select(Type, Year, Mean, SE)
1707839327214:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707839327231:# Ensure Type is ordered as desired
1707839327247:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur",
1707839327262:"Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707839327288:# Plot
1707839327302:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year), fill = "white") +
1707839327320:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707839327336:geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707839327351:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707839327366:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707839327383:# Example secondary axis (e.g., double the Mean for illustration)
1707839327398:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707839327413:labs(title = "",
1707839327428:y = "Meðalþekja", x = "") +
1707839327441:scale_x_discrete(
1707839327457:"",
1707839327472:labels = c(
1707839327486:"Mosar" = "Mosar",
1707839327502:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707839327516:"Hrúðurfléttur" = "Hrúðurfléttur",
1707839327530:"Heildarþekja" = "Heildarþekja",
1707839327542:"Tegundafjöldi" = "Tegundafjöldi"
1707839327556:))+
1707839327571:theme_minimal()+
1707839327586:theme(legend.title = element_blank(),
1707839327601:plot.background = element_rect(fill = "white", color = NA)) +
1707839327616:annotate("text", x = 3, y = Inf, label = "Allir reitir utan \n15 nýrra frá 2014", hjust = 1, vjust = 1, size = 8, angle = 0)
1707839327653:p1 <- p1 + theme(axis.title = element_text(size = 16), # Increase axis titles
1707839327671:axis.text = element_text(size = 16), # Increase axis text
1707839327688:legend.text = element_text(size = 16)) # Increase legend text
1707839330254:p1
1707839368071:ggsave(filename = "mynd4.png", plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707839443679:ggsave(filename = "mynd4_SE.png", plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707839464723:# Plot
1707839464739:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year), fill = "white") +
1707839464760:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707839464776:#geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707839464792:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707839464805:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707839464819:# Example secondary axis (e.g., double the Mean for illustration)
1707839464833:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707839464847:labs(title = "",
1707839464862:y = "Meðalþekja", x = "") +
1707839464880:scale_x_discrete(
1707839464896:"",
1707839464913:labels = c(
1707839464929:"Mosar" = "Mosar",
1707839464945:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707839464960:"Hrúðurfléttur" = "Hrúðurfléttur",
1707839464974:"Heildarþekja" = "Heildarþekja",
1707839464989:"Tegundafjöldi" = "Tegundafjöldi"
1707839465004:))+
1707839465019:theme_minimal()+
1707839465035:theme(legend.title = element_blank(),
1707839465050:plot.background = element_rect(fill = "white", color = NA)) +
1707839465065:annotate("text", x = 3, y = Inf, label = "Allir reitir utan \n15 nýrra frá 2014", hjust = 1, vjust = 1, size = 8, angle = 0)
1707839466614:p1 <- p1 + theme(axis.title = element_text(size = 16), # Increase axis titles
1707839466634:axis.text = element_text(size = 16), # Increase axis text
1707839466650:legend.text = element_text(size = 16)) # Increase legend text
1707839467582:ggsave(filename = "mynd4.png", plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707903947056:library(tidyverse)
1707903947078:library(glue)
1707903947092:library(scales)
1707903947120:colors_dark2 <- brewer.pal(8, "Accent")
1707903947135:KM <- read.csv("gogn/coverkm.csv", check.names = F)
1707903947175:KM <-  KM[,-c(7:9)]
1707903947196:data <- read.csv("gogn/hreinsad.csv", check.names = F)
1707903947256:joined_data <- data %>%
1707903947273:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`. Þá gæti verið að plyr pakkinn sé í gangi og að þvælast fyrir
1707903947289:select(species, Type, Reitur, km, everything()) |>
1707903947304:#select(-c(`1999`)) |>
1707903947319:filter(!Reitur %in% c("R51", "R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707903947334:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707903947348:filter(!species %in% "Ber klöpp")
1707903947416:#########
1707903947433:### lúppa fyrir myndir allra staða - stöplarit: "Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"
1707903947449:#########
1707903947473:for (i in unique(joined_data$Stadur)[5]) {
1707903947499:filtered_data <- joined_data %>%
1707903947513:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707903947528:select(where(~ !all(is.na(.))))
1707903947554:# Dynamically identify year columns that exist after filtering
1707903947568:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707903947582:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707903947607:# Pivot longer only with existing year columns
1707903947622:jd_long <- filtered_data %>%
1707903947637:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707903947660:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707903947684:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707903947697:# Fjöldi tegunda í reit á ári
1707903947712:species_counts <- jd_long_Engin_NA %>%
1707903947726:group_by(Reitur, Year) %>%
1707903947743:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707903947759:# Meðalfjöldi tegunda í reit á ári
1707903947772:group_by(Year) %>%
1707903947789:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707903947803:mutate(Type = "Tegundafjöldi")|>
1707903947816:select(Type, Year, Mean, SE)
1707903947841:# Meðalþekja reita eftir Type
1707903947856:df <- jd_long |>
1707903947871:group_by(Type,Year,Reitur) %>%
1707903947886:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707903947900:group_by(Type,Year) %>%
1707903947914:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707903947939:# heildarþekja (öll Type) allra reita innan ára
1707903947952:df_summary <- jd_long |>
1707903947967:group_by(Year,Reitur) %>%
1707903947982:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707903947996:group_by(Year) %>%
1707903948013:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707903948029:mutate(Type = "Heildarþekja") |>
1707903948043:select(Type, Year, Mean, SE)
1707903948083:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707903948099:# Ensure Type is ordered as desired
1707903948115:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707903948142:# Plot
1707903948156:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill=Year)) +
1707903948174:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707903948189:#geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707903948204:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707903948220:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707903948235:# Example secondary axis (e.g., double the Mean for illustration)
1707903948251:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707903948269:labs(title = "",
1707903948285:y = "Meðalþekja", x = "") +
1707903948303:scale_x_discrete(
1707903948318:"",
1707903948335:labels = c(
1707903948353:"Mosar" = "Mosar",
1707903948373:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707903948394:"Hrúðurfléttur" = "Hrúðurfléttur",
1707903948415:"Heildarþekja" = "Heildarþekja",
1707903948432:"Tegundafjöldi" = "Tegundafjöldi"
1707903948449:))+
1707903948462:theme_minimal()+
1707903948477:theme(legend.title = element_blank(),
1707903948492:plot.background = element_rect(fill = "white", color = NA)) +
1707903948507:annotate("text", x = 2, y = Inf, label = "Ofan\nHvalfjarðareyrar", hjust = 1, vjust = 1, size = 8, angle = 0)
1707903948532:p1 <- p1 + theme(axis.title = element_text(size = 16), # Increase axis titles
1707903948547:axis.text = element_text(size = 16), # Increase axis text
1707903948562:legend.text = element_text(size = 16)) # Increase legend text
1707903948597:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707903948612:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707903948637:}
1707903955713:Filename
1707904295205:library(ggplot2)
1707904295229:# Example data
1707904295241:df <- data.frame(x = 1, y = 1)
1707904295262:# Plot
1707904295275:ggplot(df, aes(x, y)) +
1707904295290:geom_point() + # Example point
1707904295305:annotate("text", x = 1, y = 1, label = "\u00C1lava", family = "Arial Unicode MS") +
1707904295319:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904312609:unique(joined_data$Stadur)[5]
1707904315369:unique(joined_data$Stadur)
1707904396385:for (i in unique(joined_data$Stadur)[9]) {
1707904396425:filtered_data <- joined_data %>%
1707904396441:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707904396456:select(where(~ !all(is.na(.))))
1707904396483:# Dynamically identify year columns that exist after filtering
1707904396498:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707904396513:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707904396540:# Pivot longer only with existing year columns
1707904396555:jd_long <- filtered_data %>%
1707904396570:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707904396596:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707904396622:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707904396636:# Fjöldi tegunda í reit á ári
1707904396651:species_counts <- jd_long_Engin_NA %>%
1707904396663:group_by(Reitur, Year) %>%
1707904396676:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707904396691:# Meðalfjöldi tegunda í reit á ári
1707904396707:group_by(Year) %>%
1707904396720:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707904396733:mutate(Type = "Tegundafjöldi")|>
1707904396747:select(Type, Year, Mean, SE)
1707904396774:# Meðalþekja reita eftir Type
1707904396789:df <- jd_long |>
1707904396805:group_by(Type,Year,Reitur) %>%
1707904396821:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707904396834:group_by(Type,Year) %>%
1707904396851:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707904396877:# heildarþekja (öll Type) allra reita innan ára
1707904396891:df_summary <- jd_long |>
1707904396905:group_by(Year,Reitur) %>%
1707904396918:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707904396931:group_by(Year) %>%
1707904396945:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707904396958:mutate(Type = "Heildarþekja") |>
1707904396973:select(Type, Year, Mean, SE)
1707904397007:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707904397023:# Ensure Type is ordered as desired
1707904397035:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707904397057:# Plot
1707904397069:p1 <-
1707904397079:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904397091:geom_bar(
1707904397102:stat = "identity",
1707904397113:color = "black",
1707904397124:size = .6,
1707904397136:position = position_dodge(width = 0.75)
1707904397146:) +
1707904397157:# geom_errorbar(
1707904397169:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904397180:#   width = .2,
1707904397190:#   position = position_dodge(width = 0.75)
1707904397201:# ) +
1707904397212:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904397225:scale_y_continuous(
1707904397236:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904397247:# Example secondary axis (e.g., double the Mean for illustration)
1707904397259:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904397271:) +
1707904397282:labs(title = "",
1707904397294:y = "Meðalþekja", x = "") +
1707904397306:scale_x_discrete(
1707904397317:"",
1707904397328:labels = c(
1707904397340:"Mosar" = "Mosar",
1707904397352:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904397364:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904397377:"Heildarþekja" = "Heildarþekja",
1707904397392:"Tegundafjöldi" = "Tegundafjöldi"
1707904397408:)
1707904397423:) +
1707904397437:theme_minimal() +
1707904397451:theme(legend.title = element_blank(),
1707904397465:plot.background = element_rect(fill = "white", color = NA)) +
1707904397480:annotate(
1707904397495:"text",
1707904397512:x = 2,
1707904397526:y = Inf,
1707904397540:label = i,
1707904397554:hjust = 1,
1707904397568:vjust = 1,
1707904397584:size = 8,
1707904397599:angle = 0
1707904397612:) +
1707904397626:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904397650:p1 <-
1707904397665:p1 + theme(
1707904397679:axis.title = element_text(size = 16),
1707904397693:# Increase axis titles
1707904397708:axis.text = element_text(size = 16),
1707904397723:# Increase axis text
1707904397740:legend.text = element_text(size = 16)
1707904397755:) # Increase legend text
1707904397779:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707904397793:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707904397828:}
1707904402321:Filename
1707904499258:i
1707904553947:# Plot
1707904553963:p1 <-
1707904553981:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904553998:geom_bar(
1707904554012:stat = "identity",
1707904554027:color = "black",
1707904554040:size = .6,
1707904554054:position = position_dodge(width = 0.75)
1707904554069:) +
1707904554083:# geom_errorbar(
1707904554097:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904554112:#   width = .2,
1707904554127:#   position = position_dodge(width = 0.75)
1707904554142:# ) +
1707904554156:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904554169:scale_y_continuous(
1707904554183:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904554196:# Example secondary axis (e.g., double the Mean for illustration)
1707904554209:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904554222:) +
1707904554236:labs(title = "",
1707904554249:y = "Meðalþekja", x = "") +
1707904554263:scale_x_discrete(
1707904554276:"",
1707904554290:labels = c(
1707904554306:"Mosar" = "Mosar",
1707904554322:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904554342:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904554358:"Heildarþekja" = "Heildarþekja",
1707904554371:"Tegundafjöldi" = "Tegundafjöldi"
1707904554384:)
1707904554398:) +
1707904554413:theme_minimal() +
1707904554427:theme(legend.title = element_blank(),
1707904554440:plot.background = element_rect(fill = "white", color = NA)) +
1707904554454:annotate(
1707904554468:"text",
1707904554483:x = 2,
1707904554497:y = Inf,
1707904554513:label = "\u00C1lava",
1707904554528:hjust = 1,
1707904554544:vjust = 1,
1707904554557:size = 8,
1707904554572:angle = 0
1707904554587:) +
1707904554602:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904567595:for (i in unique(joined_data$Stadur)[9]) {
1707904567623:filtered_data <- joined_data %>%
1707904567640:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707904567654:select(where(~ !all(is.na(.))))
1707904567681:# Dynamically identify year columns that exist after filtering
1707904567696:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707904567711:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707904567736:# Pivot longer only with existing year columns
1707904567752:jd_long <- filtered_data %>%
1707904567767:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707904567793:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707904567819:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707904567833:# Fjöldi tegunda í reit á ári
1707904567847:species_counts <- jd_long_Engin_NA %>%
1707904567861:group_by(Reitur, Year) %>%
1707904567875:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707904567889:# Meðalfjöldi tegunda í reit á ári
1707904567903:group_by(Year) %>%
1707904567917:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707904567933:mutate(Type = "Tegundafjöldi")|>
1707904567948:select(Type, Year, Mean, SE)
1707904567971:# Meðalþekja reita eftir Type
1707904567985:df <- jd_long |>
1707904568000:group_by(Type,Year,Reitur) %>%
1707904568017:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707904568034:group_by(Type,Year) %>%
1707904568048:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707904568071:# heildarþekja (öll Type) allra reita innan ára
1707904568085:df_summary <- jd_long |>
1707904568100:group_by(Year,Reitur) %>%
1707904568114:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707904568128:group_by(Year) %>%
1707904568143:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707904568157:mutate(Type = "Heildarþekja") |>
1707904568172:select(Type, Year, Mean, SE)
1707904568211:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707904568226:# Ensure Type is ordered as desired
1707904568240:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707904568260:# Plot
1707904568271:p1 <-
1707904568283:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904568297:geom_bar(
1707904568311:stat = "identity",
1707904568323:color = "black",
1707904568342:size = .6,
1707904568357:position = position_dodge(width = 0.75)
1707904568371:) +
1707904568385:# geom_errorbar(
1707904568399:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904568415:#   width = .2,
1707904568429:#   position = position_dodge(width = 0.75)
1707904568446:# ) +
1707904568463:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904568479:scale_y_continuous(
1707904568497:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904568514:# Example secondary axis (e.g., double the Mean for illustration)
1707904568529:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904568546:) +
1707904568562:labs(title = "",
1707904568580:y = "Meðalþekja", x = "") +
1707904568595:scale_x_discrete(
1707904568612:"",
1707904568628:labels = c(
1707904568644:"Mosar" = "Mosar",
1707904568659:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904568677:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904568693:"Heildarþekja" = "Heildarþekja",
1707904568706:"Tegundafjöldi" = "Tegundafjöldi"
1707904568720:)
1707904568736:) +
1707904568750:theme_minimal() +
1707904568764:theme(legend.title = element_blank(),
1707904568779:plot.background = element_rect(fill = "white", color = NA)) +
1707904568792:annotate(
1707904568804:"text",
1707904568818:x = 2,
1707904568831:y = Inf,
1707904568845:label = "\u00C1lava",
1707904568862:hjust = 1,
1707904568876:vjust = 1,
1707904568890:size = 8,
1707904568902:angle = 0
1707904568916:) +
1707904568929:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904568954:p1 <-
1707904568968:p1 + theme(
1707904568983:axis.title = element_text(size = 16),
1707904568997:# Increase axis titles
1707904569010:axis.text = element_text(size = 16),
1707904569023:# Increase axis text
1707904569036:legend.text = element_text(size = 16)
1707904569050:) # Increase legend text
1707904569076:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707904569091:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707904569125:}
1707904599969:i
1707904604869:for (i in unique(joined_data$Stadur)[9]) {
1707904604904:filtered_data <- joined_data %>%
1707904604924:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707904604939:select(where(~ !all(is.na(.))))
1707904604965:# Dynamically identify year columns that exist after filtering
1707904604979:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707904604994:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707904605018:# Pivot longer only with existing year columns
1707904605033:jd_long <- filtered_data %>%
1707904605047:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707904605071:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707904605098:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707904605112:# Fjöldi tegunda í reit á ári
1707904605125:species_counts <- jd_long_Engin_NA %>%
1707904605139:group_by(Reitur, Year) %>%
1707904605154:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707904605177:# Meðalfjöldi tegunda í reit á ári
1707904605195:group_by(Year) %>%
1707904605214:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707904605232:mutate(Type = "Tegundafjöldi")|>
1707904605250:select(Type, Year, Mean, SE)
1707904605284:# Meðalþekja reita eftir Type
1707904605303:df <- jd_long |>
1707904605318:group_by(Type,Year,Reitur) %>%
1707904605332:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707904605348:group_by(Type,Year) %>%
1707904605363:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707904605389:# heildarþekja (öll Type) allra reita innan ára
1707904605405:df_summary <- jd_long |>
1707904605419:group_by(Year,Reitur) %>%
1707904605434:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707904605448:group_by(Year) %>%
1707904605462:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707904605475:mutate(Type = "Heildarþekja") |>
1707904605489:select(Type, Year, Mean, SE)
1707904605533:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707904605548:# Ensure Type is ordered as desired
1707904605562:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707904605586:# Plot
1707904605602:p1 <-
1707904605617:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904605631:geom_bar(
1707904605645:stat = "identity",
1707904605658:color = "black",
1707904605672:size = .6,
1707904605686:position = position_dodge(width = 0.75)
1707904605701:) +
1707904605715:# geom_errorbar(
1707904605729:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904605744:#   width = .2,
1707904605760:#   position = position_dodge(width = 0.75)
1707904605774:# ) +
1707904605787:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904605802:scale_y_continuous(
1707904605818:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904605832:# Example secondary axis (e.g., double the Mean for illustration)
1707904605849:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904605863:) +
1707904605878:labs(title = "",
1707904605892:y = "Meðalþekja", x = "") +
1707904605905:scale_x_discrete(
1707904605926:"",
1707904605943:labels = c(
1707904605959:"Mosar" = "Mosar",
1707904605977:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904605996:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904606014:"Heildarþekja" = "Heildarþekja",
1707904606034:"Tegundafjöldi" = "Tegundafjöldi"
1707904606053:)
1707904606068:) +
1707904606084:theme_minimal() +
1707904606101:theme(legend.title = element_blank(),
1707904606119:plot.background = element_rect(fill = "white", color = NA)) +
1707904606141:annotate(
1707904606156:"text",
1707904606169:x = 2,
1707904606182:y = Inf,
1707904606198:label = "\u00C1lfholt",
1707904606215:hjust = 1,
1707904606230:vjust = 1,
1707904606246:size = 8,
1707904606262:angle = 0
1707904606280:) +
1707904606296:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904606323:p1 <-
1707904606339:p1 + theme(
1707904606354:axis.title = element_text(size = 16),
1707904606369:# Increase axis titles
1707904606384:axis.text = element_text(size = 16),
1707904606399:# Increase axis text
1707904606414:legend.text = element_text(size = 16)
1707904606428:) # Increase legend text
1707904606455:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707904606472:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707904606509:}
1707904623138:for (i in unique(joined_data$Stadur)[9]) {
1707904623166:filtered_data <- joined_data %>%
1707904623183:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707904623199:select(where(~ !all(is.na(.))))
1707904623229:# Dynamically identify year columns that exist after filtering
1707904623243:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707904623257:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707904623282:# Pivot longer only with existing year columns
1707904623294:jd_long <- filtered_data %>%
1707904623310:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707904623337:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707904623362:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707904623377:# Fjöldi tegunda í reit á ári
1707904623392:species_counts <- jd_long_Engin_NA %>%
1707904623405:group_by(Reitur, Year) %>%
1707904623419:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707904623433:# Meðalfjöldi tegunda í reit á ári
1707904623447:group_by(Year) %>%
1707904623462:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707904623476:mutate(Type = "Tegundafjöldi")|>
1707904623490:select(Type, Year, Mean, SE)
1707904623515:# Meðalþekja reita eftir Type
1707904623530:df <- jd_long |>
1707904623544:group_by(Type,Year,Reitur) %>%
1707904623560:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707904623577:group_by(Type,Year) %>%
1707904623592:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707904623617:# heildarþekja (öll Type) allra reita innan ára
1707904623630:df_summary <- jd_long |>
1707904623644:group_by(Year,Reitur) %>%
1707904623659:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707904623674:group_by(Year) %>%
1707904623687:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707904623701:mutate(Type = "Heildarþekja") |>
1707904623715:select(Type, Year, Mean, SE)
1707904623752:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707904623766:# Ensure Type is ordered as desired
1707904623784:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707904623810:# Plot
1707904623826:p1 <-
1707904623840:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904623855:geom_bar(
1707904623870:stat = "identity",
1707904623885:color = "black",
1707904623900:size = .6,
1707904623915:position = position_dodge(width = 0.75)
1707904623931:) +
1707904623947:# geom_errorbar(
1707904623962:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904623978:#   width = .2,
1707904623997:#   position = position_dodge(width = 0.75)
1707904624016:# ) +
1707904624032:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904624047:scale_y_continuous(
1707904624062:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904624075:# Example secondary axis (e.g., double the Mean for illustration)
1707904624092:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904624107:) +
1707904624119:labs(title = "",
1707904624131:y = "Meðalþekja", x = "") +
1707904624143:scale_x_discrete(
1707904624156:"",
1707904624167:labels = c(
1707904624178:"Mosar" = "Mosar",
1707904624190:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904624201:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904624212:"Heildarþekja" = "Heildarþekja",
1707904624223:"Tegundafjöldi" = "Tegundafjöldi"
1707904624235:)
1707904624246:) +
1707904624257:theme_minimal() +
1707904624268:theme(legend.title = element_blank(),
1707904624280:plot.background = element_rect(fill = "white", color = NA)) +
1707904624291:annotate(
1707904624302:"text",
1707904624313:x = 2,
1707904624325:y = Inf,
1707904624336:label = "Álfholt",
1707904624352:hjust = 1,
1707904624367:vjust = 1,
1707904624383:size = 8,
1707904624397:angle = 0
1707904624413:) +
1707904624428:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904624453:p1 <-
1707904624467:p1 + theme(
1707904624481:axis.title = element_text(size = 16),
1707904624494:# Increase axis titles
1707904624510:axis.text = element_text(size = 16),
1707904624526:# Increase axis text
1707904624542:legend.text = element_text(size = 16)
1707904624557:) # Increase legend text
1707904624586:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707904624602:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707904624639:}
1707904656802:for (i in unique(joined_data$Stadur)[9]) {
1707904656837:filtered_data <- joined_data %>%
1707904656855:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707904656871:select(where(~ !all(is.na(.))))
1707904656897:# Dynamically identify year columns that exist after filtering
1707904656912:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707904656927:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707904656953:# Pivot longer only with existing year columns
1707904656970:jd_long <- filtered_data %>%
1707904656986:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707904657013:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707904657039:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707904657055:# Fjöldi tegunda í reit á ári
1707904657069:species_counts <- jd_long_Engin_NA %>%
1707904657085:group_by(Reitur, Year) %>%
1707904657099:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707904657113:# Meðalfjöldi tegunda í reit á ári
1707904657128:group_by(Year) %>%
1707904657143:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707904657161:mutate(Type = "Tegundafjöldi")|>
1707904657177:select(Type, Year, Mean, SE)
1707904657205:# Meðalþekja reita eftir Type
1707904657218:df <- jd_long |>
1707904657233:group_by(Type,Year,Reitur) %>%
1707904657248:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707904657263:group_by(Type,Year) %>%
1707904657277:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707904657302:# heildarþekja (öll Type) allra reita innan ára
1707904657319:df_summary <- jd_long |>
1707904657333:group_by(Year,Reitur) %>%
1707904657349:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707904657364:group_by(Year) %>%
1707904657379:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707904657394:mutate(Type = "Heildarþekja") |>
1707904657412:select(Type, Year, Mean, SE)
1707904657448:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707904657464:# Ensure Type is ordered as desired
1707904657479:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707904657505:# Plot
1707904657520:p1 <-
1707904657536:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904657552:geom_bar(
1707904657568:stat = "identity",
1707904657584:color = "black",
1707904657599:size = .6,
1707904657614:position = position_dodge(width = 0.75)
1707904657627:) +
1707904657645:# geom_errorbar(
1707904657660:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904657677:#   width = .2,
1707904657692:#   position = position_dodge(width = 0.75)
1707904657708:# ) +
1707904657723:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904657738:scale_y_continuous(
1707904657753:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904657770:# Example secondary axis (e.g., double the Mean for illustration)
1707904657787:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904657803:) +
1707904657817:labs(title = "",
1707904657833:y = "Meðalþekja", x = "") +
1707904657848:scale_x_discrete(
1707904657861:"",
1707904657878:labels = c(
1707904657891:"Mosar" = "Mosar",
1707904657905:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904657921:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904657935:"Heildarþekja" = "Heildarþekja",
1707904657948:"Tegundafjöldi" = "Tegundafjöldi"
1707904657961:)
1707904657977:) +
1707904657991:theme_minimal() +
1707904658005:theme(legend.title = element_blank(),
1707904658020:plot.background = element_rect(fill = "white", color = NA)) +
1707904658034:annotate(
1707904658048:"text",
1707904658062:x = 2,
1707904658077:y = Inf,
1707904658092:label = "\u00C1lfholt",
1707904658106:hjust = 1,
1707904658122:vjust = 1,
1707904658138:size = 8,
1707904658155:angle = 0
1707904658171:) +
1707904658189:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904658217:p1 <-
1707904658230:p1 + theme(
1707904658245:axis.title = element_text(size = 16),
1707904658258:# Increase axis titles
1707904658271:axis.text = element_text(size = 16),
1707904658286:# Increase axis text
1707904658299:legend.text = element_text(size = 16)
1707904658312:) # Increase legend text
1707904658338:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707904658353:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707904658391:}
1707904741796:Sys.getlocale()
1707904772292:Sys.setlocale("LC_ALL", "Icelandic")
1707904800299:Sys.setlocale("LC_CTYPE", "en_US.UTF-8")
1707904805587:for (i in unique(joined_data$Stadur)[9]) {
1707904805623:filtered_data <- joined_data %>%
1707904805637:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707904805650:select(where(~ !all(is.na(.))))
1707904805675:# Dynamically identify year columns that exist after filtering
1707904805690:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707904805705:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707904805730:# Pivot longer only with existing year columns
1707904805745:jd_long <- filtered_data %>%
1707904805760:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707904805783:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707904805802:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707904805813:# Fjöldi tegunda í reit á ári
1707904805824:species_counts <- jd_long_Engin_NA %>%
1707904805835:group_by(Reitur, Year) %>%
1707904805846:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707904805857:# Meðalfjöldi tegunda í reit á ári
1707904805868:group_by(Year) %>%
1707904805879:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707904805893:mutate(Type = "Tegundafjöldi")|>
1707904805909:select(Type, Year, Mean, SE)
1707904805933:# Meðalþekja reita eftir Type
1707904805948:df <- jd_long |>
1707904805964:group_by(Type,Year,Reitur) %>%
1707904805982:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707904806001:group_by(Type,Year) %>%
1707904806018:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707904806047:# heildarþekja (öll Type) allra reita innan ára
1707904806065:df_summary <- jd_long |>
1707904806081:group_by(Year,Reitur) %>%
1707904806098:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707904806114:group_by(Year) %>%
1707904806129:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707904806143:mutate(Type = "Heildarþekja") |>
1707904806159:select(Type, Year, Mean, SE)
1707904806198:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707904806213:# Ensure Type is ordered as desired
1707904806229:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707904806257:# Plot
1707904806274:p1 <-
1707904806290:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904806305:geom_bar(
1707904806320:stat = "identity",
1707904806335:color = "black",
1707904806350:size = .6,
1707904806365:position = position_dodge(width = 0.75)
1707904806379:) +
1707904806394:# geom_errorbar(
1707904806409:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904806424:#   width = .2,
1707904806438:#   position = position_dodge(width = 0.75)
1707904806454:# ) +
1707904806469:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904806484:scale_y_continuous(
1707904806500:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904806515:# Example secondary axis (e.g., double the Mean for illustration)
1707904806529:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904806545:) +
1707904806560:labs(title = "",
1707904806578:y = "Meðalþekja", x = "") +
1707904806595:scale_x_discrete(
1707904806611:"",
1707904806626:labels = c(
1707904806640:"Mosar" = "Mosar",
1707904806653:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904806670:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904806685:"Heildarþekja" = "Heildarþekja",
1707904806701:"Tegundafjöldi" = "Tegundafjöldi"
1707904806715:)
1707904806731:) +
1707904806747:theme_minimal() +
1707904806761:theme(legend.title = element_blank(),
1707904806777:plot.background = element_rect(fill = "white", color = NA)) +
1707904806794:annotate(
1707904806809:"text",
1707904806824:x = 2,
1707904806840:y = Inf,
1707904806856:label = "\u00C1lfholt",
1707904806871:hjust = 1,
1707904806886:vjust = 1,
1707904806901:size = 8,
1707904806918:angle = 0
1707904806937:) +
1707904806953:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904806980:p1 <-
1707904806997:p1 + theme(
1707904807011:axis.title = element_text(size = 16),
1707904807026:# Increase axis titles
1707904807043:axis.text = element_text(size = 16),
1707904807059:# Increase axis text
1707904807074:legend.text = element_text(size = 16)
1707904807091:) # Increase legend text
1707904807117:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707904807131:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707904807169:}
1707904828411:for (i in unique(joined_data$Stadur)[9]) {
1707904828452:filtered_data <- joined_data %>%
1707904828469:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707904828484:select(where(~ !all(is.na(.))))
1707904828513:# Dynamically identify year columns that exist after filtering
1707904828529:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707904828543:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707904828573:# Pivot longer only with existing year columns
1707904828589:jd_long <- filtered_data %>%
1707904828604:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707904828632:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707904828657:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707904828672:# Fjöldi tegunda í reit á ári
1707904828687:species_counts <- jd_long_Engin_NA %>%
1707904828703:group_by(Reitur, Year) %>%
1707904828717:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707904828732:# Meðalfjöldi tegunda í reit á ári
1707904828748:group_by(Year) %>%
1707904828764:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707904828781:mutate(Type = "Tegundafjöldi")|>
1707904828796:select(Type, Year, Mean, SE)
1707904828818:# Meðalþekja reita eftir Type
1707904828835:df <- jd_long |>
1707904828849:group_by(Type,Year,Reitur) %>%
1707904828866:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707904828885:group_by(Type,Year) %>%
1707904828904:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707904828930:# heildarþekja (öll Type) allra reita innan ára
1707904828944:df_summary <- jd_long |>
1707904828958:group_by(Year,Reitur) %>%
1707904828974:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707904828987:group_by(Year) %>%
1707904829001:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707904829016:mutate(Type = "Heildarþekja") |>
1707904829033:select(Type, Year, Mean, SE)
1707904829067:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707904829081:# Ensure Type is ordered as desired
1707904829096:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707904829122:# Plot
1707904829136:p1 <-
1707904829151:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707904829169:geom_bar(
1707904829184:stat = "identity",
1707904829202:color = "black",
1707904829217:size = .6,
1707904829235:position = position_dodge(width = 0.75)
1707904829249:) +
1707904829264:# geom_errorbar(
1707904829279:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707904829296:#   width = .2,
1707904829325:#   position = position_dodge(width = 0.75)
1707904829347:# ) +
1707904829367:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707904829389:scale_y_continuous(
1707904829408:labels = label_dollar(prefix = "", suffix = " \n%"),
1707904829427:# Example secondary axis (e.g., double the Mean for illustration)
1707904829442:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707904829454:) +
1707904829468:labs(title = "",
1707904829481:y = "Meðalþekja", x = "") +
1707904829494:scale_x_discrete(
1707904829506:"",
1707904829519:labels = c(
1707904829533:"Mosar" = "Mosar",
1707904829546:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707904829560:"Hrúðurfléttur" = "Hrúðurfléttur",
1707904829577:"Heildarþekja" = "Heildarþekja",
1707904829590:"Tegundafjöldi" = "Tegundafjöldi"
1707904829605:)
1707904829623:) +
1707904829639:theme_minimal() +
1707904829653:theme(legend.title = element_blank(),
1707904829666:plot.background = element_rect(fill = "white", color = NA)) +
1707904829680:annotate(
1707904829696:"text",
1707904829712:x = 2,
1707904829728:y = Inf,
1707904829744:label = "Álfholt",
1707904829761:hjust = 1,
1707904829776:vjust = 1,
1707904829793:size = 8,
1707904829812:angle = 0
1707904829832:) +
1707904829847:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707904829881:p1 <-
1707904829899:p1 + theme(
1707904829917:axis.title = element_text(size = 16),
1707904829933:# Increase axis titles
1707904829951:axis.text = element_text(size = 16),
1707904829968:# Increase axis text
1707904829983:legend.text = element_text(size = 16)
1707904829998:) # Increase legend text
1707904830026:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707904830040:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707904830077:}
1707904851853:Sys.setlocale("LC_CTYPE", "is_IS.UTF-8") # Adjust as necessary based on your system
1707904856793:Sys.setlocale("LC_CTYPE", "Icelandic_Iceland.1252")
1707905301276:for (i in unique(joined_data$Stadur)[9]) {
1707905301308:filtered_data <- joined_data %>%
1707905301327:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707905301342:select(where(~ !all(is.na(.))))
1707905301368:# Dynamically identify year columns that exist after filtering
1707905301383:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707905301399:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707905301424:# Pivot longer only with existing year columns
1707905301439:jd_long <- filtered_data %>%
1707905301453:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707905301480:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707905301508:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707905301524:# Fjöldi tegunda í reit á ári
1707905301541:species_counts <- jd_long_Engin_NA %>%
1707905301556:group_by(Reitur, Year) %>%
1707905301570:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707905301584:# Meðalfjöldi tegunda í reit á ári
1707905301599:group_by(Year) %>%
1707905301614:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707905301627:mutate(Type = "Tegundafjöldi")|>
1707905301643:select(Type, Year, Mean, SE)
1707905301671:# Meðalþekja reita eftir Type
1707905301685:df <- jd_long |>
1707905301702:group_by(Type,Year,Reitur) %>%
1707905301719:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707905301732:group_by(Type,Year) %>%
1707905301747:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707905301773:# heildarþekja (öll Type) allra reita innan ára
1707905301788:df_summary <- jd_long |>
1707905301802:group_by(Year,Reitur) %>%
1707905301814:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707905301825:group_by(Year) %>%
1707905301837:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707905301848:mutate(Type = "Heildarþekja") |>
1707905301859:select(Type, Year, Mean, SE)
1707905301889:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707905301901:# Ensure Type is ordered as desired
1707905301914:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707905301937:# Plot
1707905301951:p1 <-
1707905301966:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707905301981:geom_bar(
1707905301995:stat = "identity",
1707905302008:color = "black",
1707905302025:size = .6,
1707905302038:position = position_dodge(width = 0.75)
1707905302052:) +
1707905302067:# geom_errorbar(
1707905302083:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707905302096:#   width = .2,
1707905302111:#   position = position_dodge(width = 0.75)
1707905302124:# ) +
1707905302138:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707905302153:scale_y_continuous(
1707905302168:labels = label_dollar(prefix = "", suffix = " \n%"),
1707905302182:# Example secondary axis (e.g., double the Mean for illustration)
1707905302197:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707905302210:) +
1707905302225:labs(title = "",
1707905302239:y = "Meðalþekja", x = "") +
1707905302253:scale_x_discrete(
1707905302267:"",
1707905302284:labels = c(
1707905302298:"Mosar" = "Mosar",
1707905302314:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707905302330:"Hrúðurfléttur" = "Hrúðurfléttur",
1707905302345:"Heildarþekja" = "Heildarþekja",
1707905302359:"Tegundafjöldi" = "Tegundafjöldi"
1707905302373:)
1707905302387:) +
1707905302401:theme_minimal() +
1707905302415:theme(legend.title = element_blank(),
1707905302429:plot.background = element_rect(fill = "white", color = NA)) +
1707905302443:annotate(
1707905302459:"text",
1707905302474:x = 2,
1707905302488:y = Inf,
1707905302504:label = "Álfholt",
1707905302520:hjust = 1,
1707905302535:vjust = 1,
1707905302551:size = 8,
1707905302567:angle = 0
1707905302583:) +
1707905302598:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707905302627:p1 <-
1707905302642:p1 + theme(
1707905302657:axis.title = element_text(size = 16),
1707905302671:# Increase axis titles
1707905302686:axis.text = element_text(size = 16),
1707905302701:# Increase axis text
1707905302714:legend.text = element_text(size = 16)
1707905302727:) # Increase legend text
1707905302752:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707905302765:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707905302800:}
1707905332825:Sys.getlocale()
1707905351626:Sys.setlocale("LC_CTYPE", "is_IS.UTF-8") # Adjust as necessary based on your system
1707905356586:Sys.setlocale("LC_CTYPE", "Icelandic_Iceland.1252")
1707905388931:Sys.setlocale("LC_ALL", "Icelandic")
1707905482314:Sys.setlocale("LC_ALL", "Icelandic")
1707905688820:Sys.setlocale("LC_ALL", "Icelandic")
1707905697004:Sys.setlocale("LC_CTYPE", "Icelandic_Iceland.1252")
1707905699682:Sys.setlocale("LC_CTYPE", "is_IS.UTF-8") # Adjust as necessary based on your system
1707905706629:for (i in unique(joined_data$Stadur)[9]) {
1707905706656:filtered_data <- joined_data %>%
1707905706671:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707905706685:select(where(~ !all(is.na(.))))
1707905706709:# Dynamically identify year columns that exist after filtering
1707905706723:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707905706738:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707905706764:# Pivot longer only with existing year columns
1707905706776:jd_long <- filtered_data %>%
1707905706790:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707905706816:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707905706840:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707905706854:# Fjöldi tegunda í reit á ári
1707905706867:species_counts <- jd_long_Engin_NA %>%
1707905706880:group_by(Reitur, Year) %>%
1707905706893:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707905706908:# Meðalfjöldi tegunda í reit á ári
1707905706923:group_by(Year) %>%
1707905706937:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707905706950:mutate(Type = "Tegundafjöldi")|>
1707905706964:select(Type, Year, Mean, SE)
1707905706989:# Meðalþekja reita eftir Type
1707905707003:df <- jd_long |>
1707905707017:group_by(Type,Year,Reitur) %>%
1707905707030:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707905707042:group_by(Type,Year) %>%
1707905707058:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707905707081:# heildarþekja (öll Type) allra reita innan ára
1707905707094:df_summary <- jd_long |>
1707905707108:group_by(Year,Reitur) %>%
1707905707123:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707905707135:group_by(Year) %>%
1707905707148:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707905707159:mutate(Type = "Heildarþekja") |>
1707905707170:select(Type, Year, Mean, SE)
1707905707197:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707905707208:# Ensure Type is ordered as desired
1707905707222:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707905707248:# Plot
1707905707262:p1 <-
1707905707275:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707905707289:geom_bar(
1707905707303:stat = "identity",
1707905707317:color = "black",
1707905707330:size = .6,
1707905707344:position = position_dodge(width = 0.75)
1707905707359:) +
1707905707373:# geom_errorbar(
1707905707387:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707905707400:#   width = .2,
1707905707413:#   position = position_dodge(width = 0.75)
1707905707427:# ) +
1707905707440:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707905707453:scale_y_continuous(
1707905707468:labels = label_dollar(prefix = "", suffix = " \n%"),
1707905707481:# Example secondary axis (e.g., double the Mean for illustration)
1707905707494:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707905707508:) +
1707905707522:labs(title = "",
1707905707537:y = "Meðalþekja", x = "") +
1707905707552:scale_x_discrete(
1707905707566:"",
1707905707579:labels = c(
1707905707592:"Mosar" = "Mosar",
1707905707607:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707905707621:"Hrúðurfléttur" = "Hrúðurfléttur",
1707905707639:"Heildarþekja" = "Heildarþekja",
1707905707654:"Tegundafjöldi" = "Tegundafjöldi"
1707905707668:)
1707905707682:) +
1707905707698:theme_minimal() +
1707905707713:theme(legend.title = element_blank(),
1707905707726:plot.background = element_rect(fill = "white", color = NA)) +
1707905707741:annotate(
1707905707753:"text",
1707905707769:x = 2,
1707905707784:y = Inf,
1707905707798:label = "Álfholt",
1707905707812:hjust = 1,
1707905707827:vjust = 1,
1707905707841:size = 8,
1707905707857:angle = 0
1707905707871:) +
1707905707887:theme(text = element_text(family = "Arial Unicode MS")) # Ensure the font supports "Á"
1707905707916:p1 <-
1707905707932:p1 + theme(
1707905707946:axis.title = element_text(size = 16),
1707905707960:# Increase axis titles
1707905707973:axis.text = element_text(size = 16),
1707905707988:# Increase axis text
1707905708002:legend.text = element_text(size = 16)
1707905708017:) # Increase legend text
1707905708042:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707905708055:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707905708088:}
1707905792770:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in", family = "Arial Unicode MS")
1707915876075:mynd <- read.table("mynd45.txt", header = TRUE, sep = "\t", fileEncoding = "UTF-8", check.names = F) %>%
1707915876098:pivot_longer(cols = starts_with("19") | starts_with("20"),
1707915876119:names_to = "Year",
1707915876137:values_to = "Value",
1707915876152:names_prefix = "") %>%
1707915876167:mutate(Year = as.numeric(Year))
1707915876203:colnames(mynd)[1] <- "Stadir"
1707915876217:mynd$Stadir <- factor(mynd$Stadir, levels = c("Stekkjarás","Akrafjall","Miðfellsmúli","ofan við Gröf", "viðmiðun"))
1707915876244:p1 <- ggplot(mynd, aes(fill = factor(Year), y = Value, x = Stadir)) +
1707915876257:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707915876271:scale_y_continuous(labels = scales::label_number(decimal.mark = ",", big.mark = ".")) +
1707915876286:labs(x = "Year", y = "Value", fill = "Location", title = "Value by Year and Location") +
1707915876301:scale_fill_manual(values = colors_dark2) +
1707915876316:labs(title = "",  y = "µg F/g þurrefnis", x = "") +
1707915876331:ggtitle("Hraunbreyskja")+
1707915876344:theme_minimal() +
1707915876358:theme(legend.title = element_blank(),
1707915876371:plot.background = element_rect(fill = "white", color = NA)) +
1707915876387:theme(axis.title = element_text(size = 16), # Increase axis titles
1707915876401:axis.text = element_text(size = 16), # Increase axis text
1707915876416:legend.text = element_text(size = 16),
1707915876431:plot.title = element_text(size = 18)) # Increase legend text
1707915876466:Filename <-  glue("./myndir/efnagreiningar/","mynd45",".png")
1707915876480:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916001111:?ggtitle
1707916026020:for (i in unique(joined_data$Stadur)[9]) {
1707916026058:filtered_data <- joined_data %>%
1707916026076:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707916026091:select(where(~ !all(is.na(.))))
1707916026114:# Dynamically identify year columns that exist after filtering
1707916026127:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707916026141:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707916026164:# Pivot longer only with existing year columns
1707916026178:jd_long <- filtered_data %>%
1707916026195:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707916026222:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707916026249:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707916026265:# Fjöldi tegunda í reit á ári
1707916026278:species_counts <- jd_long_Engin_NA %>%
1707916026293:group_by(Reitur, Year) %>%
1707916026309:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707916026322:# Meðalfjöldi tegunda í reit á ári
1707916026338:group_by(Year) %>%
1707916026351:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707916026366:mutate(Type = "Tegundafjöldi")|>
1707916026378:select(Type, Year, Mean, SE)
1707916026409:# Meðalþekja reita eftir Type
1707916026424:df <- jd_long |>
1707916026440:group_by(Type,Year,Reitur) %>%
1707916026455:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707916026470:group_by(Type,Year) %>%
1707916026486:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707916026513:# heildarþekja (öll Type) allra reita innan ára
1707916026529:df_summary <- jd_long |>
1707916026544:group_by(Year,Reitur) %>%
1707916026561:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707916026576:group_by(Year) %>%
1707916026589:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707916026604:mutate(Type = "Heildarþekja") |>
1707916026619:select(Type, Year, Mean, SE)
1707916026659:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707916026673:# Ensure Type is ordered as desired
1707916026688:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707916026717:# Plot
1707916026732:p1 <-
1707916026748:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707916026761:geom_bar(
1707916026776:stat = "identity",
1707916026793:color = "black",
1707916026809:size = .6,
1707916026825:position = position_dodge(width = 0.75)
1707916026843:) +
1707916026859:# geom_errorbar(
1707916026879:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707916026896:#   width = .2,
1707916026912:#   position = position_dodge(width = 0.75)
1707916026925:# ) +
1707916026940:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707916026954:scale_y_continuous(
1707916026968:labels = label_dollar(prefix = "", suffix = " \n%"),
1707916026984:# Example secondary axis (e.g., double the Mean for illustration)
1707916026999:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707916027014:) +
1707916027032:labs(title = "",
1707916027047:y = "Meðalþekja", x = "") +
1707916027060:scale_x_discrete(
1707916027075:"",
1707916027089:labels = c(
1707916027104:"Mosar" = "Mosar",
1707916027118:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707916027131:"Hrúðurfléttur" = "Hrúðurfléttur",
1707916027147:"Heildarþekja" = "Heildarþekja",
1707916027162:"Tegundafjöldi" = "Tegundafjöldi"
1707916027182:)
1707916027195:) +
1707916027208:theme_minimal() +
1707916027224:theme(legend.title = element_blank(),
1707916027238:plot.background = element_rect(fill = "white", color = NA)) +
1707916027251:# annotate(
1707916027268:#   "text",
1707916027282:#   x = 2,
1707916027295:#   y = Inf,
1707916027309:#   label = "Álfholt",
1707916027323:#   hjust = 1,
1707916027336:#   vjust = 1,
1707916027351:#   size = 8,
1707916027367:#   angle = 0
1707916027382:# )
1707916027398:ggtitle("Álfholt")
1707916027413:p1 <-
1707916027429:p1 + theme(
1707916027444:axis.title = element_text(size = 16),
1707916027459:# Increase axis titles
1707916027473:axis.text = element_text(size = 16),
1707916027488:# Increase axis text
1707916027503:legend.text = element_text(size = 16)
1707916027517:) # Increase legend text
1707916027541:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707916027555:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in", family = "Arial Unicode MS")
1707916027590:}
1707916037238:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916045190:Filename
1707916084930:getwd()
1707916161737:for (i in unique(joined_data$Stadur)[9]) {
1707916161772:filtered_data <- joined_data %>%
1707916161790:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707916161805:select(where(~ !all(is.na(.))))
1707916161830:# Dynamically identify year columns that exist after filtering
1707916161844:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707916161857:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707916161882:# Pivot longer only with existing year columns
1707916161897:jd_long <- filtered_data %>%
1707916161912:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707916161933:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707916161954:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707916161968:# Fjöldi tegunda í reit á ári
1707916161982:species_counts <- jd_long_Engin_NA %>%
1707916161996:group_by(Reitur, Year) %>%
1707916162009:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707916162024:# Meðalfjöldi tegunda í reit á ári
1707916162037:group_by(Year) %>%
1707916162051:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707916162066:mutate(Type = "Tegundafjöldi")|>
1707916162081:select(Type, Year, Mean, SE)
1707916162106:# Meðalþekja reita eftir Type
1707916162120:df <- jd_long |>
1707916162134:group_by(Type,Year,Reitur) %>%
1707916162147:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707916162162:group_by(Type,Year) %>%
1707916162174:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707916162200:# heildarþekja (öll Type) allra reita innan ára
1707916162215:df_summary <- jd_long |>
1707916162229:group_by(Year,Reitur) %>%
1707916162243:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707916162260:group_by(Year) %>%
1707916162273:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707916162287:mutate(Type = "Heildarþekja") |>
1707916162300:select(Type, Year, Mean, SE)
1707916162335:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707916162351:# Ensure Type is ordered as desired
1707916162367:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707916162393:# Plot
1707916162410:p1 <-
1707916162424:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707916162441:geom_bar(
1707916162455:stat = "identity",
1707916162472:color = "black",
1707916162487:size = .6,
1707916162501:position = position_dodge(width = 0.75)
1707916162517:) +
1707916162533:# geom_errorbar(
1707916162549:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707916162567:#   width = .2,
1707916162585:#   position = position_dodge(width = 0.75)
1707916162601:# ) +
1707916162616:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707916162632:scale_y_continuous(
1707916162648:labels = label_dollar(prefix = "", suffix = " \n%"),
1707916162665:# Example secondary axis (e.g., double the Mean for illustration)
1707916162681:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707916162697:) +
1707916162714:labs(title = "",
1707916162730:y = "Meðalþekja", x = "") +
1707916162746:scale_x_discrete(
1707916162760:"",
1707916162776:labels = c(
1707916162790:"Mosar" = "Mosar",
1707916162808:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707916162822:"Hrúðurfléttur" = "Hrúðurfléttur",
1707916162836:"Heildarþekja" = "Heildarþekja",
1707916162851:"Tegundafjöldi" = "Tegundafjöldi"
1707916162866:)
1707916162880:) +
1707916162897:theme_minimal() +
1707916162914:theme(legend.title = element_blank(),
1707916162931:plot.background = element_rect(fill = "white", color = NA)) +
1707916162945:# annotate(
1707916162960:#   "text",
1707916162976:#   x = 2,
1707916162994:#   y = Inf,
1707916163008:#   label = "Álfholt",
1707916163023:#   hjust = 1,
1707916163040:#   vjust = 1,
1707916163055:#   size = 8,
1707916163072:#   angle = 0
1707916163086:# )
1707916163100:ggtitle("Álfholt")
1707916163115:p1 <-
1707916163130:p1 + theme(
1707916163145:axis.title = element_text(size = 16),
1707916163159:# Increase axis titles
1707916163175:axis.text = element_text(size = 16),
1707916163190:# Increase axis text
1707916163208:legend.text = element_text(size = 16),
1707916163224:plot.title = element_text(size = 18)
1707916163240:) # Increase legend text
1707916163266:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707916163280:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916163317:}
1707916193712:for (i in unique(joined_data$Stadur)[9]) {
1707916193748:filtered_data <- joined_data %>%
1707916193765:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707916193779:select(where(~ !all(is.na(.))))
1707916193805:# Dynamically identify year columns that exist after filtering
1707916193820:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707916193835:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707916193862:# Pivot longer only with existing year columns
1707916193879:jd_long <- filtered_data %>%
1707916193893:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707916193921:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707916193946:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707916193959:# Fjöldi tegunda í reit á ári
1707916193973:species_counts <- jd_long_Engin_NA %>%
1707916193987:group_by(Reitur, Year) %>%
1707916194002:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707916194015:# Meðalfjöldi tegunda í reit á ári
1707916194029:group_by(Year) %>%
1707916194045:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707916194061:mutate(Type = "Tegundafjöldi")|>
1707916194075:select(Type, Year, Mean, SE)
1707916194100:# Meðalþekja reita eftir Type
1707916194114:df <- jd_long |>
1707916194130:group_by(Type,Year,Reitur) %>%
1707916194145:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707916194160:group_by(Type,Year) %>%
1707916194176:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707916194202:# heildarþekja (öll Type) allra reita innan ára
1707916194218:df_summary <- jd_long |>
1707916194235:group_by(Year,Reitur) %>%
1707916194249:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707916194263:group_by(Year) %>%
1707916194277:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707916194291:mutate(Type = "Heildarþekja") |>
1707916194306:select(Type, Year, Mean, SE)
1707916194342:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707916194358:# Ensure Type is ordered as desired
1707916194371:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707916194396:# Plot
1707916194410:p1 <-
1707916194425:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707916194439:geom_bar(
1707916194450:stat = "identity",
1707916194461:color = "black",
1707916194472:size = .6,
1707916194483:position = position_dodge(width = 0.75)
1707916194494:) +
1707916194506:# geom_errorbar(
1707916194517:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707916194528:#   width = .2,
1707916194541:#   position = position_dodge(width = 0.75)
1707916194561:# ) +
1707916194578:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707916194595:scale_y_continuous(
1707916194609:labels = label_dollar(prefix = "", suffix = " \n%"),
1707916194623:# Example secondary axis (e.g., double the Mean for illustration)
1707916194637:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707916194652:) +
1707916194670:labs(title = "",
1707916194684:y = "Meðalþekja", x = "") +
1707916194698:scale_x_discrete(
1707916194715:"",
1707916194731:labels = c(
1707916194746:"Mosar" = "Mosar",
1707916194761:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707916194778:"Hrúðurfléttur" = "Hrúðurfléttur",
1707916194794:"Heildarþekja" = "Heildarþekja",
1707916194812:"Tegundafjöldi" = "Tegundafjöldi"
1707916194830:)
1707916194847:) +
1707916194865:theme_minimal() +
1707916194883:theme(legend.title = element_blank(),
1707916194899:plot.background = element_rect(fill = "white", color = NA)) +
1707916194918:# annotate(
1707916194935:#   "text",
1707916194954:#   x = 2,
1707916194967:#   y = Inf,
1707916194984:#   label = "   Álfholt",
1707916194999:#   hjust = 1,
1707916195014:#   vjust = 1,
1707916195028:#   size = 8,
1707916195042:#   angle = 0
1707916195056:# )
1707916195070:ggtitle("Álfholt")
1707916195084:p1 <-
1707916195099:p1 + theme(
1707916195114:axis.title = element_text(size = 16),
1707916195129:# Increase axis titles
1707916195143:axis.text = element_text(size = 16),
1707916195158:# Increase axis text
1707916195171:legend.text = element_text(size = 16),
1707916195187:plot.title = element_text(size = 18)
1707916195203:) # Increase legend text
1707916195227:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707916195241:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916195282:}
1707916213952:for (i in unique(joined_data$Stadur)[9]) {
1707916213984:filtered_data <- joined_data %>%
1707916214004:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707916214019:select(where(~ !all(is.na(.))))
1707916214047:# Dynamically identify year columns that exist after filtering
1707916214062:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707916214077:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707916214103:# Pivot longer only with existing year columns
1707916214117:jd_long <- filtered_data %>%
1707916214132:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707916214151:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707916214170:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707916214181:# Fjöldi tegunda í reit á ári
1707916214192:species_counts <- jd_long_Engin_NA %>%
1707916214203:group_by(Reitur, Year) %>%
1707916214214:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707916214225:# Meðalfjöldi tegunda í reit á ári
1707916214236:group_by(Year) %>%
1707916214247:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707916214258:mutate(Type = "Tegundafjöldi")|>
1707916214269:select(Type, Year, Mean, SE)
1707916214293:# Meðalþekja reita eftir Type
1707916214307:df <- jd_long |>
1707916214321:group_by(Type,Year,Reitur) %>%
1707916214335:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707916214349:group_by(Type,Year) %>%
1707916214364:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707916214391:# heildarþekja (öll Type) allra reita innan ára
1707916214408:df_summary <- jd_long |>
1707916214422:group_by(Year,Reitur) %>%
1707916214437:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707916214458:group_by(Year) %>%
1707916214476:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707916214496:mutate(Type = "Heildarþekja") |>
1707916214515:select(Type, Year, Mean, SE)
1707916214570:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707916214591:# Ensure Type is ordered as desired
1707916214605:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707916214633:# Plot
1707916214650:p1 <-
1707916214666:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707916214681:geom_bar(
1707916214695:stat = "identity",
1707916214709:color = "black",
1707916214723:size = .6,
1707916214736:position = position_dodge(width = 0.75)
1707916214752:) +
1707916214789:# geom_errorbar(
1707916214811:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707916214830:#   width = .2,
1707916214848:#   position = position_dodge(width = 0.75)
1707916214864:# ) +
1707916214880:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707916214895:scale_y_continuous(
1707916214910:labels = label_dollar(prefix = "", suffix = " \n%"),
1707916214926:# Example secondary axis (e.g., double the Mean for illustration)
1707916214940:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707916214955:) +
1707916214970:labs(title = "",
1707916214984:y = "Meðalþekja", x = "") +
1707916214997:scale_x_discrete(
1707916215011:"",
1707916215025:labels = c(
1707916215040:"Mosar" = "Mosar",
1707916215053:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707916215067:"Hrúðurfléttur" = "Hrúðurfléttur",
1707916215082:"Heildarþekja" = "Heildarþekja",
1707916215097:"Tegundafjöldi" = "Tegundafjöldi"
1707916215112:)
1707916215127:) +
1707916215143:theme_minimal() +
1707916215159:theme(legend.title = element_blank(),
1707916215175:plot.background = element_rect(fill = "white", color = NA)) +
1707916215190:# annotate(
1707916215206:#   "text",
1707916215227:#   x = 2,
1707916215243:#   y = Inf,
1707916215261:#   label = "   Álfholt",
1707916215276:#   hjust = 1,
1707916215291:#   vjust = 1,
1707916215307:#   size = 8,
1707916215321:#   angle = 0
1707916215336:# )
1707916215350:ggtitle("   Álfholt")
1707916215367:p1 <-
1707916215385:p1 + theme(
1707916215399:axis.title = element_text(size = 16),
1707916215414:# Increase axis titles
1707916215427:axis.text = element_text(size = 16),
1707916215443:# Increase axis text
1707916215457:legend.text = element_text(size = 16),
1707916215472:plot.title = element_text(size = 18)
1707916215485:) # Increase legend text
1707916215508:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707916215521:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916215561:}
1707916227576:for (i in unique(joined_data$Stadur)[9]) {
1707916227605:filtered_data <- joined_data %>%
1707916227621:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707916227636:select(where(~ !all(is.na(.))))
1707916227661:# Dynamically identify year columns that exist after filtering
1707916227674:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707916227689:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707916227715:# Pivot longer only with existing year columns
1707916227731:jd_long <- filtered_data %>%
1707916227744:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707916227767:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707916227791:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707916227804:# Fjöldi tegunda í reit á ári
1707916227818:species_counts <- jd_long_Engin_NA %>%
1707916227831:group_by(Reitur, Year) %>%
1707916227844:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707916227858:# Meðalfjöldi tegunda í reit á ári
1707916227871:group_by(Year) %>%
1707916227885:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707916227898:mutate(Type = "Tegundafjöldi")|>
1707916227911:select(Type, Year, Mean, SE)
1707916227935:# Meðalþekja reita eftir Type
1707916227960:df <- jd_long |>
1707916227977:group_by(Type,Year,Reitur) %>%
1707916227997:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707916228015:group_by(Type,Year) %>%
1707916228034:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707916228076:# heildarþekja (öll Type) allra reita innan ára
1707916228098:df_summary <- jd_long |>
1707916228118:group_by(Year,Reitur) %>%
1707916228131:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707916228144:group_by(Year) %>%
1707916228157:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707916228171:mutate(Type = "Heildarþekja") |>
1707916228186:select(Type, Year, Mean, SE)
1707916228223:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707916228239:# Ensure Type is ordered as desired
1707916228255:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707916228278:# Plot
1707916228293:p1 <-
1707916228309:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707916228323:geom_bar(
1707916228338:stat = "identity",
1707916228354:color = "black",
1707916228368:size = .6,
1707916228383:position = position_dodge(width = 0.75)
1707916228398:) +
1707916228409:# geom_errorbar(
1707916228420:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707916228431:#   width = .2,
1707916228446:#   position = position_dodge(width = 0.75)
1707916228460:# ) +
1707916228475:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707916228490:scale_y_continuous(
1707916228505:labels = label_dollar(prefix = "", suffix = " \n%"),
1707916228523:# Example secondary axis (e.g., double the Mean for illustration)
1707916228542:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707916228558:) +
1707916228574:labs(title = "",
1707916228592:y = "Meðalþekja", x = "") +
1707916228606:scale_x_discrete(
1707916228623:"",
1707916228638:labels = c(
1707916228652:"Mosar" = "Mosar",
1707916228667:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707916228682:"Hrúðurfléttur" = "Hrúðurfléttur",
1707916228696:"Heildarþekja" = "Heildarþekja",
1707916228710:"Tegundafjöldi" = "Tegundafjöldi"
1707916228724:)
1707916228738:) +
1707916228751:theme_minimal() +
1707916228766:theme(legend.title = element_blank(),
1707916228781:plot.background = element_rect(fill = "white", color = NA)) +
1707916228799:# annotate(
1707916228812:#   "text",
1707916228826:#   x = 2,
1707916228842:#   y = Inf,
1707916228857:#   label = "   Álfholt",
1707916228871:#   hjust = 1,
1707916228886:#   vjust = 1,
1707916228902:#   size = 8,
1707916228918:#   angle = 0
1707916228935:# )
1707916228950:ggtitle("      Álfholt")
1707916228966:p1 <-
1707916228982:p1 + theme(
1707916228996:axis.title = element_text(size = 16),
1707916229009:# Increase axis titles
1707916229023:axis.text = element_text(size = 16),
1707916229039:# Increase axis text
1707916229054:legend.text = element_text(size = 16),
1707916229071:plot.title = element_text(size = 18)
1707916229084:) # Increase legend text
1707916229108:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707916229121:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916229159:}
1707916248751:for (i in unique(joined_data$Stadur)[9]) {
1707916248781:filtered_data <- joined_data %>%
1707916248795:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707916248811:select(where(~ !all(is.na(.))))
1707916248838:# Dynamically identify year columns that exist after filtering
1707916248852:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707916248867:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707916248892:# Pivot longer only with existing year columns
1707916248905:jd_long <- filtered_data %>%
1707916248920:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707916248947:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707916248972:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707916248988:# Fjöldi tegunda í reit á ári
1707916249002:species_counts <- jd_long_Engin_NA %>%
1707916249019:group_by(Reitur, Year) %>%
1707916249034:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707916249047:# Meðalfjöldi tegunda í reit á ári
1707916249060:group_by(Year) %>%
1707916249073:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707916249088:mutate(Type = "Tegundafjöldi")|>
1707916249100:select(Type, Year, Mean, SE)
1707916249127:# Meðalþekja reita eftir Type
1707916249143:df <- jd_long |>
1707916249157:group_by(Type,Year,Reitur) %>%
1707916249170:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707916249186:group_by(Type,Year) %>%
1707916249202:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707916249234:# heildarþekja (öll Type) allra reita innan ára
1707916249249:df_summary <- jd_long |>
1707916249264:group_by(Year,Reitur) %>%
1707916249278:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707916249292:group_by(Year) %>%
1707916249305:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707916249320:mutate(Type = "Heildarþekja") |>
1707916249334:select(Type, Year, Mean, SE)
1707916249371:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707916249385:# Ensure Type is ordered as desired
1707916249398:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707916249420:# Plot
1707916249433:p1 <-
1707916249448:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707916249462:geom_bar(
1707916249476:stat = "identity",
1707916249490:color = "black",
1707916249504:size = .6,
1707916249519:position = position_dodge(width = 0.75)
1707916249535:) +
1707916249549:# geom_errorbar(
1707916249565:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707916249579:#   width = .2,
1707916249593:#   position = position_dodge(width = 0.75)
1707916249608:# ) +
1707916249622:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707916249637:scale_y_continuous(
1707916249650:labels = label_dollar(prefix = "", suffix = " \n%"),
1707916249663:# Example secondary axis (e.g., double the Mean for illustration)
1707916249677:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707916249693:) +
1707916249710:labs(title = "",
1707916249726:y = "Meðalþekja", x = "") +
1707916249743:scale_x_discrete(
1707916249766:"",
1707916249782:labels = c(
1707916249802:"Mosar" = "Mosar",
1707916249821:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707916249839:"Hrúðurfléttur" = "Hrúðurfléttur",
1707916249856:"Heildarþekja" = "Heildarþekja",
1707916249874:"Tegundafjöldi" = "Tegundafjöldi"
1707916249891:)
1707916249909:) +
1707916249930:theme_minimal() +
1707916249946:theme(legend.title = element_blank(),
1707916249964:plot.background = element_rect(fill = "white", color = NA)) +
1707916249977:# annotate(
1707916249991:#   "text",
1707916250006:#   x = 2,
1707916250019:#   y = Inf,
1707916250034:#   label = "   Álfholt",
1707916250048:#   hjust = 1,
1707916250061:#   vjust = 1,
1707916250073:#   size = 8,
1707916250089:#   angle = 0
1707916250104:# )
1707916250119:ggtitle("            \n      Álfholt")
1707916250133:p1 <-
1707916250147:p1 + theme(
1707916250164:axis.title = element_text(size = 16),
1707916250179:# Increase axis titles
1707916250195:axis.text = element_text(size = 16),
1707916250209:# Increase axis text
1707916250225:legend.text = element_text(size = 16),
1707916250239:plot.title = element_text(size = 18)
1707916250254:) # Increase legend text
1707916250279:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707916250294:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916250333:}
1707916422975:for (i in unique(joined_data$Stadur)[9]) {
1707916423008:filtered_data <- joined_data %>%
1707916423025:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707916423039:select(where(~ !all(is.na(.))))
1707916423063:# Dynamically identify year columns that exist after filtering
1707916423077:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707916423092:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707916423115:# Pivot longer only with existing year columns
1707916423129:jd_long <- filtered_data %>%
1707916423146:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707916423169:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707916423195:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707916423212:# Fjöldi tegunda í reit á ári
1707916423229:species_counts <- jd_long_Engin_NA %>%
1707916423243:group_by(Reitur, Year) %>%
1707916423257:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707916423272:# Meðalfjöldi tegunda í reit á ári
1707916423287:group_by(Year) %>%
1707916423301:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707916423315:mutate(Type = "Tegundafjöldi")|>
1707916423330:select(Type, Year, Mean, SE)
1707916423354:# Meðalþekja reita eftir Type
1707916423370:df <- jd_long |>
1707916423385:group_by(Type,Year,Reitur) %>%
1707916423400:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707916423414:group_by(Type,Year) %>%
1707916423429:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707916423458:# heildarþekja (öll Type) allra reita innan ára
1707916423472:df_summary <- jd_long |>
1707916423485:group_by(Year,Reitur) %>%
1707916423499:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707916423514:group_by(Year) %>%
1707916423528:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707916423543:mutate(Type = "Heildarþekja") |>
1707916423559:select(Type, Year, Mean, SE)
1707916423594:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707916423608:# Ensure Type is ordered as desired
1707916423622:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707916423648:# Plot
1707916423662:p1 <-
1707916423679:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707916423696:geom_bar(
1707916423710:stat = "identity",
1707916423725:color = "black",
1707916423740:size = .6,
1707916423753:position = position_dodge(width = 0.75)
1707916423770:) +
1707916423785:# geom_errorbar(
1707916423800:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707916423814:#   width = .2,
1707916423829:#   position = position_dodge(width = 0.75)
1707916423844:# ) +
1707916423857:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707916423872:scale_y_continuous(
1707916423886:labels = label_dollar(prefix = "", suffix = " \n%"),
1707916423901:# Example secondary axis (e.g., double the Mean for illustration)
1707916423915:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707916423930:) +
1707916423945:labs(title = "",
1707916423958:y = "Meðalþekja", x = "") +
1707916423972:scale_x_discrete(
1707916423988:"",
1707916424001:labels = c(
1707916424015:"Mosar" = "Mosar",
1707916424030:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707916424044:"Hrúðurfléttur" = "Hrúðurfléttur",
1707916424058:"Heildarþekja" = "Heildarþekja",
1707916424075:"Tegundafjöldi" = "Tegundafjöldi"
1707916424088:)
1707916424103:) +
1707916424117:theme_minimal() +
1707916424132:theme(legend.title = element_blank(),
1707916424148:plot.background = element_rect(fill = "white", color = NA)) +
1707916424163:# annotate(
1707916424181:#   "text",
1707916424198:#   x = 2,
1707916424214:#   y = Inf,
1707916424228:#   label = "   Álfholt",
1707916424242:#   hjust = 1,
1707916424258:#   vjust = 1,
1707916424272:#   size = 8,
1707916424287:#   angle = 0
1707916424300:# )
1707916424315:ggtitle("            \n      Álfholt")
1707916424329:p1 <-
1707916424344:p1 + theme(
1707916424359:axis.title = element_text(size = 16),
1707916424373:# Increase axis titles
1707916424387:axis.text = element_text(size = 16),
1707916424403:# Increase axis text
1707916424416:legend.text = element_text(size = 16),
1707916424430:plot.title = element_text(size = 20)
1707916424445:) # Increase legend text
1707916424473:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707916424488:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707916424526:}
1707922941985:for (i in unique(joined_data$Stadur)[1]) {
1707922942025:filtered_data <- joined_data %>%
1707922942042:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) %>%
1707922942058:select(where(~ !all(is.na(.))))
1707922942082:# Dynamically identify year columns that exist after filtering
1707922942095:year_columns <- c('1976', '1997','1999', '2006', '2011', '2014', '2017', '2020', '2023')
1707922942109:existing_year_columns <- year_columns[year_columns %in% colnames(filtered_data)]
1707922942135:# Pivot longer only with existing year columns
1707922942150:jd_long <- filtered_data %>%
1707922942164:pivot_longer(cols = existing_year_columns, names_to = "Year", values_to = "Coverage")
1707922942192:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707922942218:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707922942234:# Fjöldi tegunda í reit á ári
1707922942249:species_counts <- jd_long_Engin_NA %>%
1707922942263:group_by(Reitur, Year) %>%
1707922942277:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707922942291:# Meðalfjöldi tegunda í reit á ári
1707922942305:group_by(Year) %>%
1707922942319:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707922942336:mutate(Type = "Tegundafjöldi")|>
1707922942351:select(Type, Year, Mean, SE)
1707922942378:# Meðalþekja reita eftir Type
1707922942394:df <- jd_long |>
1707922942411:group_by(Type,Year,Reitur) %>%
1707922942426:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707922942441:group_by(Type,Year) %>%
1707922942455:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707922942483:# heildarþekja (öll Type) allra reita innan ára
1707922942498:df_summary <- jd_long |>
1707922942512:group_by(Year,Reitur) %>%
1707922942526:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707922942542:group_by(Year) %>%
1707922942559:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707922942573:mutate(Type = "Heildarþekja") |>
1707922942586:select(Type, Year, Mean, SE)
1707922942624:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707922942642:# Ensure Type is ordered as desired
1707922942657:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707922942684:# Plot
1707922942699:p1 <-
1707922942713:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707922942729:geom_bar(
1707922942744:stat = "identity",
1707922942759:color = "black",
1707922942772:size = .6,
1707922942787:position = position_dodge(width = 0.75)
1707922942800:) +
1707922942815:# geom_errorbar(
1707922942830:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707922942842:#   width = .2,
1707922942853:#   position = position_dodge(width = 0.75)
1707922942868:# ) +
1707922942882:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707922942896:scale_y_continuous(
1707922942911:labels = label_dollar(prefix = "", suffix = " \n%"),
1707922942925:# Example secondary axis (e.g., double the Mean for illustration)
1707922942939:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707922942955:) +
1707922942970:labs(title = "",
1707922942986:y = "Meðalþekja", x = "") +
1707922943001:scale_x_discrete(
1707922943016:"",
1707922943032:labels = c(
1707922943047:"Mosar" = "Mosar",
1707922943062:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707922943076:"Hrúðurfléttur" = "Hrúðurfléttur",
1707922943091:"Heildarþekja" = "Heildarþekja",
1707922943105:"Tegundafjöldi" = "Tegundafjöldi"
1707922943121:)
1707922943137:) +
1707922943151:theme_minimal() +
1707922943168:theme(legend.title = element_blank(),
1707922943183:plot.background = element_rect(fill = "white", color = NA)) +
1707922943200:# annotate(
1707922943214:#   "text",
1707922943230:#   x = 2,
1707922943247:#   y = Inf,
1707922943262:#   label = "   Álfholt",
1707922943278:#   hjust = 1,
1707922943292:#   vjust = 1,
1707922943305:#   size = 8,
1707922943319:#   angle = 0
1707922943333:# )
1707922943347:ggtitle(i)
1707922943362:p1 <-
1707922943376:p1 + theme(
1707922943392:axis.title = element_text(size = 16),
1707922943413:# Increase axis titles
1707922943431:axis.text = element_text(size = 16),
1707922943450:# Increase axis text
1707922943468:legend.text = element_text(size = 16),
1707922943484:plot.title = element_text(size = 20)
1707922943499:) # Increase legend text
1707922943527:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707922943542:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707922943577:}
1707922947249:Filename
1707923076514:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year), fill = "white") +
1707923076532:geom_bar(stat = "identity", color = "black", linewidth = .6, position = position_dodge(width = 0.75)) +
1707923076553:#geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE), width = .2, position = position_dodge(width = 0.75)) +
1707923076571:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707923076584:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707923076599:# Example secondary axis (e.g., double the Mean for illustration)
1707923076615:sec.axis = sec_axis(~ . , name = "Meðaltegundafjöldi")) +
1707923076630:labs(title = "",
1707923076644:y = "Meðalþekja", x = "") +
1707923076658:scale_x_discrete(
1707923076672:"",
1707923076686:labels = c(
1707923076701:"Mosar" = "Mosar",
1707923076715:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707923076730:"Hrúðurfléttur" = "Hrúðurfléttur",
1707923076744:"Heildarþekja" = "Heildarþekja",
1707923076759:"Tegundafjöldi" = "Tegundafjöldi"
1707923076774:))+
1707923076787:theme_minimal()+
1707923076800:theme(legend.title = element_blank(), plot.background = element_rect(fill = "white", color = NA)) +
1707923076816:annotate("text", x = 3, y = Inf, label = "Allir reitir utan \n15 nýrra frá 2014", hjust = 1, vjust = 1, size = 8, angle = 0)+
1707923076830:theme(axis.title = element_text(size = 16), # Increase axis titles
1707923076843:axis.text = element_text(size = 16), # Increase axis text
1707923076859:legend.text = element_text(size = 16),
1707923076873:plot.title = element_text(size = 20)) # Increase legend text
1707924301354:# Load required libraries
1707924301372:library(tidyverse)  # For data manipulation and visualization
1707924301389:library(glue)       # For string interpolation
1707924301408:library(scales)     # For scaling functions, if needed
1707924301430:# Define color palette
1707924301445:colors_dark2 <- brewer.pal(8, "Accent")
1707924301463:# Define color palette 2
1707924301475:colors <- brewer.pal(9, "Set1")
1707924301499:# Load and preprocess data
1707924301511:# Adjust file paths as necessary
1707924301524:KM <- read.csv("gogn/coverkm.csv", check.names = FALSE)
1707924301573:KM <- KM[, -c(7:9)]  # Assuming columns 7 to 9 are removed in all analyses
1707924301608:data <- read.csv("gogn/hreinsad.csv", check.names = FALSE)
1707924301671:joined_data <- data |>
1707924301689:left_join(KM, by = c("Reitur", "Type", "species")) |>
1707924301707:select(species, Type, Reitur, km, everything()) |>
1707924301723:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707924301738:filter(!species %in% "Ber klöpp")
1707924302476:for (i in unique(joined_data$Stadur)[1]) {
1707924302505:filtered_data <- joined_data  |>
1707924302522:filter(Stadur %in% i & !Type %in% c("Grænþörungar", "Cyanobacteria")) |>
1707924302541:select(where(~ !all(is.na(.))))
1707924302569:# Pivot longer only with existing year columns
1707924302586:jd_long <- filtered_data |>
1707924302601:pivot_longer(cols = starts_with("19") | starts_with("20"), names_to = "Year", values_to = "Coverage")
1707924302627:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707924302653:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707924302668:# Fjöldi tegunda í reit á ári
1707924302684:species_counts <- jd_long_Engin_NA |>
1707924302699:group_by(Reitur, Year) |>
1707924302715:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') |>
1707924302728:# Meðalfjöldi tegunda í reit á ári
1707924302740:group_by(Year) |>
1707924302750:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707924302761:mutate(Type = "Tegundafjöldi")|>
1707924302770:select(Type, Year, Mean, SE)
1707924302789:# Meðalþekja reita eftir Type
1707924302799:df <- jd_long |>
1707924302811:group_by(Type,Year,Reitur) |>
1707924302821:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707924302831:group_by(Type,Year) |>
1707924302842:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm=TRUE), .groups = 'drop')
1707924302858:# heildarþekja (öll Type) allra reita innan ára
1707924302867:df_summary <- jd_long |>
1707924302881:group_by(Year,Reitur) |>
1707924302894:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') |>
1707924302904:group_by(Year) |>
1707924302917:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') |>
1707924302928:mutate(Type = "Heildarþekja") |>
1707924302938:select(Type, Year, Mean, SE)
1707924302963:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707924302974:# Ensure Type is ordered as desired
1707924302984:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707924303001:# Plot
1707924303011:p1 <- ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707924303021:geom_bar(stat = "identity",color = "black",size = .6,position = position_dodge(width = 0.75)) +
1707924303031:# geom_errorbar(aes(ymin = Mean - SE, ymax = Mean + SE),width = .2,position = position_dodge(width = 0.75)) +
1707924303042:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707924303052:scale_y_continuous(labels = label_dollar(prefix = "", suffix = " \n%"),
1707924303064:# Example secondary axis (e.g., double the Mean for illustration)
1707924303075:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")) +
1707924303085:labs(title = "", y = "Meðalþekja", x = "") +
1707924303095:scale_x_discrete("",labels = c(
1707924303105:"Mosar" = "Mosar",
1707924303115:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707924303126:"Hrúðurfléttur" = "Hrúðurfléttur",
1707924303136:"Heildarþekja" = "Heildarþekja",
1707924303146:"Tegundafjöldi" = "Tegundafjöldi"
1707924303157:)) +
1707924303166:theme_minimal() +
1707924303176:theme(legend.title = element_blank(),
1707924303188:plot.background = element_rect(fill = "white", color = NA)) +
1707924303201:# annotate("text", x = 2,y = Inf,label = "   Álfholt",hjust = 1,vjust = 1,size = 8, angle = 0)
1707924303216:ggtitle(i)+
1707924303230:theme(axis.title = element_text(size = 16),
1707924303241:axis.text = element_text(size = 16),
1707924303252:legend.text = element_text(size = 16),
1707924303263:plot.title = element_text(size = 20))
1707924303285:Filename <-  glue("./myndir/",i,"-","{paste(unique(filtered_data$Reitur), collapse='_')}.png")
1707924303297:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707924303325:}
1707924311334:Filename
1707925776246:joined_data <- data %>%
1707925776262:left_join(KM, by = c("Reitur", "Type", "species")) %>% # Ef þessi villa kemur upp þá Error in `left_join()`:  ! Join columns must be present in data.✖ Problem with `Type`, `species`, `2020`, and `2023`.
1707925776280:select(species, Type, Reitur, km, everything()) |>
1707925776297:select(-c(`1999`)) |>
1707925776313:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62")) |>
1707925776328:#mutate(Type = if_else(species == "Ber klöpp", "Ber klöpp", Type)) |>
1707925776345:filter(!species %in% "Ber klöpp")
1707925783428:jd_long <- joined_data |>
1707925783445:filter(Fluor == 1 &
1707925783464:!Type %in% c("Grænþörungar", "Cyanobacteria")) |>
1707925783480:pivot_longer(
1707925783494:cols = c(`2020`, `2023`, `1976`, `1997`, `2006`, `2011`, `2014`, `2017`),
1707925783509:names_to = "Year",
1707925783522:values_to = "Coverage"
1707925783542:)
1707925783585:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707925791574:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707925791598:# Fjöldi tegunda í reit á ári
1707925791618:species_counts <- jd_long_Engin_NA %>%
1707925791634:group_by(Reitur, Year) %>%
1707925791648:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707925791662:# Meðalfjöldi tegunda í reit á ári
1707925791676:group_by(Year) %>%
1707925791691:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707925791705:mutate(Type = "Tegundafjöldi")|>
1707925791720:select(Type, Year, Mean, SE)
1707925802376:# Meðalþekja reita eftir Type
1707925802395:df <- jd_long |>
1707925802416:group_by(Type,Year,Reitur) %>%
1707925802432:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707925802447:group_by(Type,Year) %>%
1707925802461:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop')
1707925803176:# heildarþekja (öll Type) allra reita innan ára
1707925803196:df_summary <- jd_long |>
1707925803211:group_by(Year,Reitur) %>%
1707925803224:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707925803239:group_by(Year) %>%
1707925803254:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707925803269:mutate(Type = "Heildarþekja") |>
1707925803284:select(Type, Year, Mean, SE)
1707925811383:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707925812414:# Ensure Type is ordered as desired
1707925812431:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707925823640:# Plot
1707925823659:p1 <-
1707925823679:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707925823692:geom_bar(
1707925823703:stat = "identity",
1707925823714:color = "black",
1707925823725:size = .6,
1707925823736:position = position_dodge(width = 0.75)
1707925823747:) +
1707925823760:geom_errorbar(
1707925823773:aes(ymin = Mean - SE, ymax = Mean + SE),
1707925823787:width = .2,
1707925823804:position = position_dodge(width = 0.75)
1707925823819:) +
1707925823834:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707925823850:scale_y_continuous(
1707925823864:labels = label_dollar(prefix = "", suffix = " \n%"),
1707925823879:# Example secondary axis (e.g., double the Mean for illustration)
1707925823893:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707925823907:) +
1707925823921:labs(title = "",
1707925823935:y = "Meðalþekja", x = "") +
1707925823949:scale_x_discrete(
1707925823964:"",
1707925823979:labels = c(
1707925823992:"Mosar" = "Mosar",
1707925824006:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707925824019:"Hrúðurfléttur" = "Hrúðurfléttur",
1707925824034:"Heildarþekja" = "Heildarþekja",
1707925824048:"Tegundafjöldi" = "Tegundafjöldi"
1707925824064:)
1707925824081:) +
1707925824097:theme_minimal() +
1707925824114:theme(legend.title = element_blank(),
1707925824132:plot.background = element_rect(fill = "white", color = NA)) +
1707925824146:annotate("text", x = 2, y = Inf, label = "Þynningarsvæði F", hjust = 1, vjust = 1, size = 8, angle = 0)
1707925825253:p1 <-
1707925825274:p1 + theme(
1707925825289:axis.title = element_text(size = 16),
1707925825307:# Increase axis titles
1707925825322:axis.text = element_text(size = 16),
1707925825335:# Increase axis text
1707925825349:legend.text = element_text(size = 16)
1707925825363:) # Increase legend text
1707925827872:Filename <-  glue("ÞynningarsvæðiF","-","{paste(unique(jd_long_Engin_NA$Reitur), collapse='_')}.png")
1707925829397:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707925912418:# Plot
1707925912437:p1 <-
1707925912457:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707925912474:geom_bar(
1707925912487:stat = "identity",
1707925912502:color = "black",
1707925912519:size = .6,
1707925912535:position = position_dodge(width = 0.75)
1707925912550:) +
1707925912566:# geom_errorbar(
1707925912582:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707925912597:#   width = .2,
1707925912614:#   position = position_dodge(width = 0.75)
1707925912628:# ) +
1707925912643:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707925912658:scale_y_continuous(
1707925912675:labels = label_dollar(prefix = "", suffix = " \n%"),
1707925912689:# Example secondary axis (e.g., double the Mean for illustration)
1707925912705:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707925912718:) +
1707925912733:labs(title = "",
1707925912748:y = "Meðalþekja", x = "") +
1707925912764:scale_x_discrete(
1707925912780:"",
1707925912795:labels = c(
1707925912809:"Mosar" = "Mosar",
1707925912823:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707925912838:"Hrúðurfléttur" = "Hrúðurfléttur",
1707925912854:"Heildarþekja" = "Heildarþekja",
1707925912872:"Tegundafjöldi" = "Tegundafjöldi"
1707925912887:)
1707925912904:) +
1707925912918:theme_minimal() +
1707925912933:theme(legend.title = element_blank(),
1707925912949:plot.background = element_rect(fill = "white", color = NA)) +
1707925912964:annotate("text", x = 2, y = Inf, label = "Þynningarsvæði F", hjust = 1, vjust = 1, size = 8, angle = 0)
1707925914637:p1 <-
1707925914659:p1 + theme(
1707925914677:axis.title = element_text(size = 16),
1707925914693:# Increase axis titles
1707925914710:axis.text = element_text(size = 16),
1707925914723:# Increase axis text
1707925914739:legend.text = element_text(size = 16)
1707925914755:) # Increase legend text
1707925916757:Filename <-  glue("ÞynningarsvæðiF","-","{paste(unique(jd_long_Engin_NA$Reitur), collapse='_')}.png")
1707925917038:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707926045711:jd_long <- joined_data |>
1707926045725:filter(Brennisteinn == 1 &
1707926045737:!Type %in% c("Grænþörungar", "Cyanobacteria")) |>
1707926045752:pivot_longer(
1707926045766:cols = c(`2020`, `2023`, `1976`, `1997`, `2006`, `2011`, `2014`, `2017`),
1707926045783:names_to = "Year",
1707926045799:values_to = "Coverage"
1707926045815:)
1707926045872:jd_long_Engin_NA <- jd_long[!is.na(jd_long$Coverage),]
1707926045908:# Heildarfjöldi tegunda á ári í hverjum reit. Passa að hafa ekki plyr pakkann í gangi.
1707926045963:# Fjöldi tegunda í reit á ári
1707926045982:species_counts <- jd_long_Engin_NA %>%
1707926046001:group_by(Reitur, Year) %>%
1707926046017:summarise(SpeciesCount = n_distinct(species), .groups = 'drop') %>%
1707926046032:# Meðalfjöldi tegunda í reit á ári
1707926046047:group_by(Year) %>%
1707926046062:summarise(Mean = mean(SpeciesCount), SE = sd(SpeciesCount)) |>
1707926046077:mutate(Type = "Tegundafjöldi")|>
1707926046090:select(Type, Year, Mean, SE)
1707926046133:# Meðalþekja reita eftir Type
1707926046149:df <- jd_long |>
1707926046163:group_by(Type,Year,Reitur) %>%
1707926046178:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707926046192:group_by(Type,Year) %>%
1707926046206:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop')
1707926046247:# heildarþekja (öll Type) allra reita innan ára
1707926046264:df_summary <- jd_long |>
1707926046281:group_by(Year,Reitur) %>%
1707926046297:summarise( Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop') %>%
1707926046313:group_by(Year) %>%
1707926046327:summarise(Mean=mean(Summa, na.rm=TRUE),SE = sd(Summa, na.rm = TRUE) / sqrt(length(Summa)), .groups = 'drop') %>%
1707926046341:mutate(Type = "Heildarþekja") |>
1707926046357:select(Type, Year, Mean, SE)
1707926046416:df_with_heildarþekja <- bind_rows(df, df_summary, species_counts)
1707926046433:# Ensure Type is ordered as desired
1707926046448:df_with_heildarþekja$Type <- factor(df_with_heildarþekja$Type, levels = c("Mosar","Blað- og runnfléttur", "Hrúðurfléttur","Heildarþekja",  "Tegundafjöldi"))
1707926052948:# Plot
1707926052973:p1 <-
1707926052993:ggplot(df_with_heildarþekja, aes(x = Type, y = Mean, fill = Year)) +
1707926053010:geom_bar(
1707926053024:stat = "identity",
1707926053039:color = "black",
1707926053052:size = .6,
1707926053068:position = position_dodge(width = 0.75)
1707926053082:) +
1707926053098:# geom_errorbar(
1707926053115:#   aes(ymin = Mean - SE, ymax = Mean + SE),
1707926053130:#   width = .2,
1707926053145:#   position = position_dodge(width = 0.75)
1707926053162:# ) +
1707926053177:scale_fill_manual(values = colors_dark2) +  # Use the Dark2 palette
1707926053193:scale_y_continuous(
1707926053207:labels = label_dollar(prefix = "", suffix = " \n%"),
1707926053222:# Example secondary axis (e.g., double the Mean for illustration)
1707926053237:sec.axis = sec_axis( ~ . , name = "Meðaltegundafjöldi")
1707926053250:) +
1707926053262:labs(title = "",
1707926053275:y = "Meðalþekja", x = "") +
1707926053289:scale_x_discrete(
1707926053303:"",
1707926053317:labels = c(
1707926053331:"Mosar" = "Mosar",
1707926053346:"Blað- og runnfléttur" = "Blað- og\nrunnfléttur",
1707926053362:"Hrúðurfléttur" = "Hrúðurfléttur",
1707926053379:"Heildarþekja" = "Heildarþekja",
1707926053397:"Tegundafjöldi" = "Tegundafjöldi"
1707926053412:)
1707926053426:) +
1707926053440:theme_minimal() +
1707926053453:theme(legend.title = element_blank(),
1707926053468:plot.background = element_rect(fill = "white", color = NA)) +
1707926053483:annotate("text", x = 2, y = Inf, label = "Þynningarsvæði S", hjust = 1, vjust = 1, size = 8, angle = 0)
1707926055305:p1 <-
1707926055355:p1 + theme(
1707926055378:axis.title = element_text(size = 16),
1707926055393:# Increase axis titles
1707926055408:axis.text = element_text(size = 16),
1707926055421:# Increase axis text
1707926055435:legend.text = element_text(size = 16)
1707926055450:) # Increase legend text
1707926058102:Filename <-  glue("ÞynningarsvæðiS","-","{paste(unique(jd_long_Engin_NA$Reitur), collapse='_')}.png")
1707926059123:ggsave(filename = Filename, plot = p1, width = 11.7, height = 8.3, dpi = 300, units = "in")
1707986200070:hist(joined_data$species)
1707986226533:hist(table(joined_data))
1707986396659:joined_data |> pivot_longer(cols = starts_with("19") | starts_with("20"), names_to = "Year", values_to = "Coverage") |> group_by(species) |> summarise(Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop')
1707986407813:rass <- joined_data |> pivot_longer(cols = starts_with("19") | starts_with("20"), names_to = "Year", values_to = "Coverage") |> group_by(species) |> summarise(Summa = sum(Coverage, na.rm = TRUE), .groups = 'drop')
1707986419293:install.packages('DT')
1707986433756:DT::datatable(rass)
1707986494542:rass <- joined_data |> pivot_longer(cols = starts_with("19") | starts_with("20"), names_to = "Year", values_to = "Coverage") |> group_by(species) |> summarise(Summa = sum(Coverage, na.rm = TRUE),Meðaltal = mean(Coverage, na.rm = TRUE), .groups = 'drop')
1707986496418:DT::datatable(rass)
1707989175150:rass <- joined_data |> pivot_longer(cols = starts_with("19") | starts_with("20"), names_to = "Year", values_to = "Coverage") |> group_by(species, Type, Year) |> summarise(Summa = sum(Coverage, na.rm = TRUE),Meðaltal = mean(Coverage, na.rm = TRUE), .groups = 'drop')
1707989179286:str(rass)
1707989198072:DT::datatable(rass)
1707989253871:rass <- joined_data |> pivot_longer(cols = starts_with("19") | starts_with("20"), names_to = "Year", values_to = "Coverage") |> group_by(species, Type, Year) |> summarise(Summa = sum(Coverage, na.rm = TRUE),Meðaltal = mean(Coverage, na.rm = TRUE), .groups = 'drop') |> filter(!species %in% "Óaðgreindar tegundir")
1707989256045:DT::datatable(rass)
1710928971777:savehistory(file = "my_history.Rhistory")
1710929045370:?savehistory
1710929286234:savehistory("~/my_history.Rhistory")
1710929386403:savehistory("~/my_history.Rhistory")
1710929569549:plot_data <- data %>%
1710929569567:mutate(CoverageChange = (`2023` - `2020`)/`2020`) %>%
1710929569585:left_join(KM, by = c("Reitur", "Type", "species")) %>%
1710929569605:select(species, Type, Stadur, Reitur, km, Fluor, Brennisteinn, everything()) %>%
1710929569623:filter(!Reitur %in% c("R1", "R2", "R4", "R5", "R6", "R9", "R10", "R15", "R28", "R29", "R53", "R54", "R55", "R57", "R58", "R59", "R61", "R62") &
1710929569644:!is.na(CoverageChange) &
1710929569660:Type %in% "Blað- og runnfléttur") %>%
1710929569675:mutate(PointType = case_when(
1710929569690:Fluor == 1 ~ "Fluor",
1710929569710:Brennisteinn == 1 & Fluor == 0 ~ "Brennisteinn",
1710929569730:TRUE ~ "Other"
1710929569750:)) %>%
1710929569766:select(-c(`1976`, `1997`, `2006`, `2011`, `1999`,`2014`, `2017`))
1710929625204:p202Og2023
1710929725366:jd_wide_filtered
1710929755332:dput(jd_wide_filtered)
1710929792868:jd_wide_filtered
1710929801309:jd_fyrir_plot
1710929951506:jd_filtered
1710930167005:dput(p202Og2023)
